{"version":3,"sources":["../../../../components/modals/ImportCSVModal.tsx","../../../../hooks/useFirestore.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useRef } from 'react';\nimport { Modal } from '@/components/ui/Modal';\nimport { Button } from '@/components/ui/Button';\nimport { useLocations, useSuppliers, useProducts, useInventory } from '@/hooks/useFirestore';\nimport { Product, Supplier, InventoryItem } from '@/types';\nimport { useToast } from '@/components/ui/Toast';\n\ninterface ImportCSVModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\ninterface ParsedRow {\n  [key: string]: string;\n}\n\ninterface ColumnMapping {\n  name: string;\n  sku: string;\n  category: string;\n  cost: string;\n  priceMSRP: string;\n  priceShopify?: string;\n  priceAmazon?: string;\n  priceWholesale?: string;\n  weight?: string;\n  barcode?: string;\n  quantity?: string;\n  binLocation?: string;\n  reorderPoint?: string;\n  supplierSku?: string;\n  supplierName?: string;\n  leadTime?: string;\n  minOrderQty?: string;\n}\n\nconst REQUIRED_FIELDS = ['name', 'sku'];\nconst FIELD_LABELS: Record<string, string> = {\n  name: 'Product Name',\n  sku: 'SKU',\n  category: 'Category',\n  cost: 'Cost',\n  priceMSRP: 'MSRP',\n  priceShopify: 'Shopify Price',\n  priceAmazon: 'Amazon Price',\n  priceWholesale: 'Wholesale Price',\n  weight: 'Weight (oz)',\n  barcode: 'Barcode/UPC',\n  quantity: 'Quantity on Hand',\n  binLocation: 'Bin Location',\n  reorderPoint: 'Reorder Point',\n  supplierSku: 'Supplier SKU',\n  supplierName: 'Supplier Name',\n  leadTime: 'Lead Time (days)',\n  minOrderQty: 'Min Order Qty',\n};\n\nconst FIELD_GROUPS = {\n  basic: ['name', 'sku', 'category', 'barcode'],\n  pricing: ['cost', 'priceMSRP', 'priceShopify', 'priceAmazon', 'priceWholesale'],\n  inventory: ['quantity', 'binLocation', 'reorderPoint', 'weight'],\n  supplier: ['supplierName', 'supplierSku', 'leadTime', 'minOrderQty'],\n};\n\nexport function ImportCSVModal({ isOpen, onClose }: ImportCSVModalProps) {\n  const { locations } = useLocations();\n  const { suppliers: existingSuppliers, service: supplierService, isDemo } = useSuppliers();\n  const { products: existingProducts, service: productService } = useProducts();\n  const { service: inventoryService } = useInventory();\n  const { success, error, warning } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const [step, setStep] = useState<'upload' | 'mapping' | 'preview'>('upload');\n  const [fileName, setFileName] = useState('');\n  const [csvHeaders, setCsvHeaders] = useState<string[]>([]);\n  const [csvData, setCsvData] = useState<ParsedRow[]>([]);\n  const [columnMapping, setColumnMapping] = useState<Partial<ColumnMapping>>({});\n  const [isImporting, setIsImporting] = useState(false);\n  const [isDragging, setIsDragging] = useState(false);\n  const [selectedLocationId, setSelectedLocationId] = useState<string>('');\n  const [createInventoryRecords, setCreateInventoryRecords] = useState(true);\n  const [createSuppliers, setCreateSuppliers] = useState(true);\n\n  // Set default location when locations load\n  const defaultLocation = locations.find(l => l.type === 'warehouse') || locations[0];\n  if (!selectedLocationId && defaultLocation) {\n    setSelectedLocationId(defaultLocation.id);\n  }\n\n  const downloadTemplate = (type: 'basic' | 'full' | 'inflow') => {\n    let headers: string[] = [];\n    let sampleData: string[][] = [];\n\n    if (type === 'basic') {\n      headers = ['Product Name', 'SKU', 'Category', 'Cost', 'MSRP', 'Quantity'];\n      sampleData = [\n        ['Example Product 1', 'SKU-001', 'nutrient', '10.00', '24.99', '100'],\n        ['Example Product 2', 'SKU-002', 'supply', '15.00', '34.99', '50'],\n      ];\n    } else if (type === 'full') {\n      headers = [\n        'Product Name', 'SKU', 'Category', 'Barcode',\n        'Cost', 'MSRP', 'Shopify Price', 'Amazon Price', 'Wholesale Price',\n        'Quantity', 'Bin Location', 'Reorder Point', 'Weight (oz)',\n        'Supplier Name', 'Supplier SKU', 'Lead Time (days)', 'Min Order Qty'\n      ];\n      sampleData = [\n        ['Example Product 1', 'SKU-001', 'nutrient', '123456789012',\n         '10.00', '24.99', '22.99', '24.99', '14.99',\n         '100', 'A1-01', '25', '32',\n         'Supplier Inc', 'SUP-001', '14', '50'],\n        ['Example Product 2', 'SKU-002', 'supply', '234567890123',\n         '15.00', '34.99', '32.99', '34.99', '20.99',\n         '50', 'B2-03', '20', '16',\n         'Vendor Co', 'VND-002', '7', '25'],\n      ];\n    } else if (type === 'inflow') {\n      headers = [\n        'Name', 'Barcode', 'Category', 'Description',\n        'Sale Price', 'Purchase Cost', 'Quantity on Hand',\n        'Location', 'Reorder Point', 'Vendor', 'Vendor SKU'\n      ];\n      sampleData = [\n        ['Product Name Here', '123456789012', 'nutrient', 'Description text',\n         '24.99', '10.00', '100',\n         'Main Warehouse', '25', 'Supplier Name', 'VENDOR-SKU-001'],\n      ];\n    }\n\n    const csvContent = [\n      headers.join(','),\n      ...sampleData.map(row => row.map(cell => `\"${cell}\"`).join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', `cronk-wms-import-template-${type}.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const resetState = () => {\n    setStep('upload');\n    setFileName('');\n    setCsvHeaders([]);\n    setCsvData([]);\n    setColumnMapping({});\n    setIsImporting(false);\n    const defaultLoc = locations.find(l => l.type === 'warehouse') || locations[0];\n    setSelectedLocationId(defaultLoc?.id || '');\n    setCreateInventoryRecords(true);\n    setCreateSuppliers(true);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const parseCSV = (text: string): { headers: string[]; data: ParsedRow[] } => {\n    // Remove BOM if present (handles UTF-8 BOM from Excel/inFlow)\n    const cleanText = text.replace(/^\\uFEFF/, '').replace(/^\\xEF\\xBB\\xBF/, '');\n\n    const lines = cleanText.split(/\\r?\\n/).filter(line => line.trim());\n    if (lines.length === 0) return { headers: [], data: [] };\n\n    // Parse header row and strip quotes from header names\n    const headers = lines[0].split(',').map(h => h.trim().replace(/^[\"']|[\"']$/g, '').trim());\n\n    const data: ParsedRow[] = [];\n    for (let i = 1; i < lines.length; i++) {\n      const values: string[] = [];\n      let current = '';\n      let inQuotes = false;\n\n      for (const char of lines[i]) {\n        if (char === '\"' || char === \"'\") {\n          inQuotes = !inQuotes;\n        } else if (char === ',' && !inQuotes) {\n          values.push(current.trim().replace(/^[\"']|[\"']$/g, ''));\n          current = '';\n        } else {\n          current += char;\n        }\n      }\n      values.push(current.trim().replace(/^[\"']|[\"']$/g, ''));\n\n      const row: ParsedRow = {};\n      headers.forEach((header, index) => {\n        // Strip quotes from values too\n        const value = (values[index] || '').replace(/^[\"']|[\"']$/g, '').trim();\n        row[header] = value;\n      });\n      data.push(row);\n    }\n\n    return { headers, data };\n  };\n\n  const autoMapColumns = (headers: string[]) => {\n    const mapping: Partial<ColumnMapping> = {};\n    const lowerHeaders = headers.map(h => h.toLowerCase());\n\n    const mappings: Record<keyof ColumnMapping, string[]> = {\n      name: ['name', 'product name', 'product', 'title', 'item name', 'description'],\n      sku: ['sku', 'product sku', 'item number', 'item #', 'item code', 'product code'],\n      category: ['category', 'type', 'product type', 'group', 'product category'],\n      cost: ['cost', 'cogs', 'unit cost', 'price cost', 'purchase price', 'buy price', 'purchase cost'],\n      priceMSRP: ['msrp', 'price', 'retail price', 'price msrp', 'sell price', 'sale price'],\n      priceShopify: ['shopify price', 'shopify', 'web price', 'online price'],\n      priceAmazon: ['amazon price', 'amazon', 'marketplace price'],\n      priceWholesale: ['wholesale', 'wholesale price', 'dealer price', 'trade price'],\n      weight: ['weight', 'weight (oz)', 'oz', 'weight oz', 'item weight', 'weight (lbs)', 'lbs'],\n      barcode: ['barcode', 'upc', 'ean', 'gtin', 'isbn'],\n      quantity: ['quantity', 'qty', 'stock', 'on hand', 'quantity on hand', 'stock qty', 'available', 'inventory'],\n      binLocation: ['bin', 'bin location', 'location', 'shelf', 'rack', 'position', 'warehouse location'],\n      reorderPoint: ['reorder point', 'reorder', 'min qty', 'minimum', 'low stock', 'reorder level'],\n      supplierName: ['supplier', 'vendor', 'supplier name', 'vendor name', 'manufacturer'],\n      supplierSku: ['supplier sku', 'vendor sku', 'manufacturer sku', 'vendor code', 'supplier code', 'mfg part #'],\n      leadTime: ['lead time', 'leadtime', 'lead time days', 'delivery time'],\n      minOrderQty: ['min order', 'moq', 'minimum order', 'min order qty'],\n    };\n\n    Object.entries(mappings).forEach(([field, possibleNames]) => {\n      const matchIndex = lowerHeaders.findIndex(h =>\n        possibleNames.some(name => h.includes(name))\n      );\n      if (matchIndex !== -1) {\n        mapping[field as keyof ColumnMapping] = headers[matchIndex];\n      }\n    });\n\n    return mapping;\n  };\n\n  const handleFileSelect = (file: File) => {\n    if (!file.name.endsWith('.csv')) {\n      error('Please select a CSV file');\n      return;\n    }\n\n    setFileName(file.name);\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const text = e.target?.result as string;\n      const { headers, data } = parseCSV(text);\n\n      if (headers.length === 0) {\n        error('Could not parse CSV file');\n        return;\n      }\n\n      setCsvHeaders(headers);\n      setCsvData(data);\n      setColumnMapping(autoMapColumns(headers));\n      setStep('mapping');\n    };\n    reader.readAsText(file);\n  };\n\n  const handleDrop = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(false);\n\n    const file = e.dataTransfer.files[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    setIsDragging(true);\n  }, []);\n\n  const handleDragLeave = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      handleFileSelect(file);\n    }\n  };\n\n  const isValidMapping = () => {\n    return REQUIRED_FIELDS.every(field => columnMapping[field as keyof ColumnMapping]);\n  };\n\n  const getPreviewData = () => {\n    return csvData.slice(0, 5).map(row => {\n      const mapped: Record<string, string> = {};\n      Object.entries(columnMapping).forEach(([field, column]) => {\n        if (column) {\n          mapped[field] = row[column] || '';\n        }\n      });\n      return mapped;\n    });\n  };\n\n  const getValidationIssues = () => {\n    const issues: string[] = [];\n    const existingSkus = new Set(existingProducts.map(p => p.sku.toLowerCase()));\n    const newSkus = new Set<string>();\n\n    csvData.forEach((row, index) => {\n      const sku = columnMapping.sku ? row[columnMapping.sku] : '';\n      const name = columnMapping.name ? row[columnMapping.name] : '';\n\n      if (!sku) {\n        issues.push(`Row ${index + 2}: Missing SKU`);\n      } else if (existingSkus.has(sku.toLowerCase())) {\n        issues.push(`Row ${index + 2}: SKU \"${sku}\" already exists`);\n      } else if (newSkus.has(sku.toLowerCase())) {\n        issues.push(`Row ${index + 2}: Duplicate SKU \"${sku}\" in file`);\n      } else {\n        newSkus.add(sku.toLowerCase());\n      }\n\n      if (!name) {\n        issues.push(`Row ${index + 2}: Missing product name`);\n      }\n    });\n\n    return issues.slice(0, 10);\n  };\n\n  const handleImport = async () => {\n    if (!isValidMapping() || !productService) return;\n\n    if (isDemo) {\n      error('Import is not available in demo mode');\n      return;\n    }\n\n    setIsImporting(true);\n\n    try {\n      const existingSkus = new Set(existingProducts.map(p => p.sku.toLowerCase()));\n      const supplierMap = new Map(existingSuppliers.map(s => [s.name.toLowerCase(), s]));\n\n      let imported = 0;\n      let skipped = 0;\n      let inventoryCreated = 0;\n      let suppliersCreated = 0;\n      const newSupplierIds = new Map<string, string>();\n\n      // Prepare batch data\n      const productsToCreate: Omit<Product, 'id' | 'createdAt' | 'updatedAt'>[] = [];\n      const inventoryToCreate: Omit<InventoryItem, 'id'>[] = [];\n      const suppliersToCreate: Omit<Supplier, 'id'>[] = [];\n      const productInventoryMap: { productIndex: number; quantity: number; binLocation?: string }[] = [];\n\n      for (const row of csvData) {\n        const sku = columnMapping.sku ? row[columnMapping.sku] : '';\n        const name = columnMapping.name ? row[columnMapping.name] : '';\n\n        if (!sku || !name || existingSkus.has(sku.toLowerCase())) {\n          skipped++;\n          continue;\n        }\n\n        const msrp = parseFloat(columnMapping.priceMSRP ? row[columnMapping.priceMSRP] : '0') || 0;\n        const shopifyPrice = parseFloat(columnMapping.priceShopify ? row[columnMapping.priceShopify] : '0') || msrp;\n        const amazonPrice = parseFloat(columnMapping.priceAmazon ? row[columnMapping.priceAmazon] : '0') || msrp;\n        const wholesalePrice = parseFloat(columnMapping.priceWholesale ? row[columnMapping.priceWholesale] : '0') || msrp * 0.6;\n        const distributorPrice = wholesalePrice * 0.75;\n        const costValue = parseFloat(columnMapping.cost ? row[columnMapping.cost] : '0') || 0;\n        const weightValue = parseFloat(columnMapping.weight ? row[columnMapping.weight] : '0') || 0;\n        const reorderPoint = parseInt(columnMapping.reorderPoint ? row[columnMapping.reorderPoint] : '50') || 50;\n        const quantity = parseInt(columnMapping.quantity ? row[columnMapping.quantity] : '0') || 0;\n        const binLocation = columnMapping.binLocation ? row[columnMapping.binLocation]?.trim() : undefined;\n        const supplierName = columnMapping.supplierName ? row[columnMapping.supplierName]?.trim() : '';\n        const categoryRaw = columnMapping.category ? row[columnMapping.category]?.trim().toLowerCase() : 'supply';\n\n        // Map category to valid type\n        let category: 'nutrient' | 'supply' | 'packaging' | 'label' = 'supply';\n        if (categoryRaw.includes('nutrient') || categoryRaw.includes('supplement')) {\n          category = 'nutrient';\n        } else if (categoryRaw.includes('packaging') || categoryRaw.includes('box') || categoryRaw.includes('bottle')) {\n          category = 'packaging';\n        } else if (categoryRaw.includes('label')) {\n          category = 'label';\n        }\n\n        const newProduct: Omit<Product, 'id' | 'createdAt' | 'updatedAt'> = {\n          name: name.trim(),\n          sku: sku.trim().toUpperCase(),\n          barcode: columnMapping.barcode ? row[columnMapping.barcode]?.trim() : undefined,\n          category,\n          weight: weightValue,\n          prices: {\n            msrp,\n            shopify: shopifyPrice,\n            amazon: amazonPrice,\n            wholesale: wholesalePrice,\n            distributor: distributorPrice,\n          },\n          costs: {\n            base: costValue,\n            amazonPrep: 0,\n            shopify: 0,\n          },\n          reorderPoint,\n          isActive: true,\n        };\n\n        productsToCreate.push(newProduct);\n        existingSkus.add(sku.toLowerCase());\n        imported++;\n\n        // Track inventory for this product\n        if (createInventoryRecords && selectedLocationId && (quantity > 0 || binLocation)) {\n          productInventoryMap.push({\n            productIndex: productsToCreate.length - 1,\n            quantity,\n            binLocation,\n          });\n          inventoryCreated++;\n        }\n\n        // Handle supplier\n        if (createSuppliers && supplierName && supplierService) {\n          const existingSupplier = supplierMap.get(supplierName.toLowerCase());\n\n          if (!existingSupplier && !newSupplierIds.has(supplierName.toLowerCase())) {\n            suppliersToCreate.push({\n              name: supplierName,\n              currency: 'USD',\n            });\n            newSupplierIds.set(supplierName.toLowerCase(), `pending-${suppliersToCreate.length - 1}`);\n            suppliersCreated++;\n          }\n        }\n      }\n\n      // Batch create suppliers first\n      if (suppliersToCreate.length > 0 && supplierService) {\n        await supplierService.batchCreate(suppliersToCreate);\n      }\n\n      // Batch create products\n      const productIds = await productService.batchCreate(productsToCreate);\n\n      // Create inventory records with actual product IDs\n      if (productInventoryMap.length > 0 && inventoryService) {\n        for (const item of productInventoryMap) {\n          const productId = productIds[item.productIndex];\n          inventoryToCreate.push({\n            productId,\n            locationId: selectedLocationId,\n            quantity: item.quantity,\n            binLocation: item.binLocation || '',\n          });\n        }\n        await inventoryService.batchCreate(inventoryToCreate);\n      }\n\n      // Build success message\n      const messages: string[] = [];\n      if (imported > 0) messages.push(`${imported} products`);\n      if (inventoryCreated > 0) messages.push(`${inventoryCreated} inventory records`);\n      if (suppliersCreated > 0) messages.push(`${suppliersCreated} new suppliers`);\n\n      if (messages.length > 0) {\n        success(`Successfully imported ${messages.join(', ')}`);\n      }\n      if (skipped > 0) {\n        warning(`Skipped ${skipped} rows (missing data or duplicate SKUs)`);\n      }\n\n      resetState();\n      onClose();\n    } catch (err) {\n      console.error('Import error:', err);\n      error('Failed to import products');\n    } finally {\n      setIsImporting(false);\n    }\n  };\n\n  const handleClose = () => {\n    resetState();\n    onClose();\n  };\n\n  const renderUploadStep = () => (\n    <div className=\"space-y-4\">\n      <div\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onClick={() => fileInputRef.current?.click()}\n        className={`border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-colors ${\n          isDragging\n            ? 'border-emerald-500 bg-emerald-500/10'\n            : 'border-slate-700 hover:border-slate-600'\n        }`}\n      >\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\".csv\"\n          onChange={handleFileInputChange}\n          className=\"hidden\"\n        />\n        <i className=\"fas fa-cloud-upload-alt text-4xl text-slate-500 mb-4\"></i>\n        <p className=\"text-white font-medium mb-1\">\n          Drag & drop CSV file here\n        </p>\n        <p className=\"text-sm text-slate-400\">\n          or click to browse\n        </p>\n      </div>\n\n      <div className=\"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4\">\n        <h4 className=\"text-sm font-medium text-white mb-2\">CSV Format Requirements</h4>\n        <ul className=\"text-sm text-slate-400 space-y-1\">\n          <li><i className=\"fas fa-check text-emerald-400 mr-2\"></i>First row must contain column headers</li>\n          <li><i className=\"fas fa-check text-emerald-400 mr-2\"></i>Required columns: <span className=\"text-white\">Name, SKU</span></li>\n          <li><i className=\"fas fa-check text-emerald-400 mr-2\"></i>Pricing: Cost, MSRP, Shopify Price, Amazon Price, Wholesale</li>\n          <li><i className=\"fas fa-check text-emerald-400 mr-2\"></i>Inventory: Quantity, Bin Location, Reorder Point, Weight</li>\n          <li><i className=\"fas fa-check text-emerald-400 mr-2\"></i>Supplier: Supplier Name, Supplier SKU, Lead Time, Min Order Qty</li>\n        </ul>\n      </div>\n\n      <div className=\"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4\">\n        <h4 className=\"text-sm font-medium text-white mb-2\">Download Templates</h4>\n        <div className=\"flex flex-wrap gap-2\">\n          <button\n            onClick={() => downloadTemplate('basic')}\n            className=\"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors\"\n          >\n            <i className=\"fas fa-download mr-1.5\"></i>\n            Basic Template\n          </button>\n          <button\n            onClick={() => downloadTemplate('full')}\n            className=\"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors\"\n          >\n            <i className=\"fas fa-download mr-1.5\"></i>\n            Full Template\n          </button>\n          <button\n            onClick={() => downloadTemplate('inflow')}\n            className=\"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors\"\n          >\n            <i className=\"fas fa-download mr-1.5\"></i>\n            inFlow Format\n          </button>\n        </div>\n      </div>\n\n      {isDemo && (\n        <div className=\"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3\">\n          <div className=\"flex items-center gap-2 text-amber-400 text-sm\">\n            <i className=\"fas fa-info-circle\"></i>\n            <span>Import is disabled in demo mode. Sign in to import products.</span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  const renderFieldGroup = (groupName: string, fields: string[], icon: string, color: string) => (\n    <div className=\"bg-slate-800/30 border border-slate-700/50 rounded-lg p-4\">\n      <h5 className={`text-sm font-medium ${color} mb-3 flex items-center gap-2`}>\n        <i className={`fas ${icon}`}></i>\n        {groupName}\n      </h5>\n      <div className=\"grid grid-cols-2 gap-3\">\n        {fields.map(field => (\n          <div key={field}>\n            <label className=\"block text-xs text-slate-400 mb-1\">\n              {FIELD_LABELS[field]}\n              {REQUIRED_FIELDS.includes(field) && (\n                <span className=\"text-red-400 ml-1\">*</span>\n              )}\n            </label>\n            <select\n              value={columnMapping[field as keyof ColumnMapping] || ''}\n              onChange={e =>\n                setColumnMapping(prev => ({ ...prev, [field]: e.target.value }))\n              }\n              className={`w-full bg-slate-800 border ${\n                REQUIRED_FIELDS.includes(field) && !columnMapping[field as keyof ColumnMapping]\n                  ? 'border-amber-500/50'\n                  : 'border-slate-700'\n              } rounded-lg px-2 py-1.5 text-white text-sm focus:outline-none focus:border-emerald-500/50`}\n            >\n              <option value=\"\">-- Select --</option>\n              {csvHeaders.map(header => (\n                <option key={header} value={header}>\n                  {header}\n                </option>\n              ))}\n            </select>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n\n  const renderMappingStep = () => (\n    <div className=\"space-y-4 max-h-[60vh] overflow-y-auto pr-2\">\n      <div className=\"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <i className=\"fas fa-file-csv text-emerald-400\"></i>\n            <span className=\"text-white font-medium\">{fileName}</span>\n            <span className=\"text-slate-400 text-sm\">({csvData.length} rows)</span>\n          </div>\n          <button\n            onClick={resetState}\n            className=\"text-sm text-slate-400 hover:text-white\"\n          >\n            <i className=\"fas fa-times mr-1\"></i>\n            Change file\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-3\">\n        {renderFieldGroup('Basic Info', FIELD_GROUPS.basic, 'fa-box', 'text-blue-400')}\n        {renderFieldGroup('Pricing', FIELD_GROUPS.pricing, 'fa-dollar-sign', 'text-emerald-400')}\n        {renderFieldGroup('Inventory', FIELD_GROUPS.inventory, 'fa-warehouse', 'text-amber-400')}\n        {renderFieldGroup('Supplier', FIELD_GROUPS.supplier, 'fa-truck-loading', 'text-purple-400')}\n      </div>\n\n      <div className=\"bg-slate-800/30 border border-slate-700/50 rounded-lg p-4\">\n        <h5 className=\"text-sm font-medium text-white mb-3 flex items-center gap-2\">\n          <i className=\"fas fa-cog\"></i>\n          Import Options\n        </h5>\n\n        <div className=\"space-y-3\">\n          <div>\n            <label className=\"block text-xs text-slate-400 mb-1\">Import Inventory To Location</label>\n            <select\n              value={selectedLocationId}\n              onChange={e => setSelectedLocationId(e.target.value)}\n              className=\"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-emerald-500/50\"\n            >\n              <option value=\"\">-- No inventory records --</option>\n              {locations.map(loc => (\n                <option key={loc.id} value={loc.id}>\n                  {loc.name} ({loc.type})\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={createInventoryRecords}\n                onChange={e => setCreateInventoryRecords(e.target.checked)}\n                className=\"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500\"\n              />\n              <span className=\"text-sm text-slate-300\">Create inventory records</span>\n            </label>\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={createSuppliers}\n                onChange={e => setCreateSuppliers(e.target.checked)}\n                className=\"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500\"\n              />\n              <span className=\"text-sm text-slate-300\">Auto-create suppliers</span>\n            </label>\n          </div>\n        </div>\n      </div>\n\n      {isValidMapping() && (\n        <Button onClick={() => setStep('preview')} className=\"w-full\">\n          Preview Import\n          <i className=\"fas fa-arrow-right ml-2\"></i>\n        </Button>\n      )}\n    </div>\n  );\n\n  const renderPreviewStep = () => {\n    const previewData = getPreviewData();\n    const issues = getValidationIssues();\n\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <button\n            onClick={() => setStep('mapping')}\n            className=\"text-sm text-slate-400 hover:text-white\"\n          >\n            <i className=\"fas fa-arrow-left mr-1\"></i>\n            Back to mapping\n          </button>\n          <span className=\"text-sm text-slate-400\">\n            Ready to import <span className=\"text-white font-medium\">{csvData.length}</span> products\n          </span>\n        </div>\n\n        <div className=\"border border-slate-700 rounded-lg overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead className=\"bg-slate-800\">\n                <tr>\n                  {Object.entries(columnMapping)\n                    .filter(([, col]) => col)\n                    .map(([field]) => (\n                      <th key={field} className=\"px-3 py-2 text-left text-slate-400 font-medium\">\n                        {FIELD_LABELS[field] || field}\n                      </th>\n                    ))}\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-slate-700/50\">\n                {previewData.map((row, index) => (\n                  <tr key={index} className=\"bg-slate-800/30\">\n                    {Object.entries(columnMapping)\n                      .filter(([, col]) => col)\n                      .map(([field]) => (\n                        <td key={field} className=\"px-3 py-2 text-white\">\n                          {row[field] || '-'}\n                        </td>\n                      ))}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          {csvData.length > 5 && (\n            <div className=\"px-3 py-2 bg-slate-800/50 text-center text-sm text-slate-400\">\n              ... and {csvData.length - 5} more rows\n            </div>\n          )}\n        </div>\n\n        {issues.length > 0 && (\n          <div className=\"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4\">\n            <h4 className=\"text-amber-400 font-medium mb-2 flex items-center gap-2\">\n              <i className=\"fas fa-exclamation-triangle\"></i>\n              Validation Warnings\n            </h4>\n            <ul className=\"text-sm text-amber-300/80 space-y-1\">\n              {issues.map((issue, index) => (\n                <li key={index}>{issue}</li>\n              ))}\n              {issues.length === 10 && (\n                <li className=\"text-slate-400\">... and more</li>\n              )}\n            </ul>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={handleClose}\n      title=\"Import Products from CSV\"\n      subtitle={\n        step === 'upload' ? 'Upload a CSV file to import products' :\n        step === 'mapping' ? 'Map CSV columns to product fields' :\n        'Review and confirm import'\n      }\n      size=\"lg\"\n      footer={\n        step === 'preview' ? (\n          <>\n            <Button variant=\"secondary\" onClick={handleClose}>\n              Cancel\n            </Button>\n            <Button onClick={handleImport} disabled={isImporting || isDemo}>\n              {isImporting ? (\n                <>\n                  <i className=\"fas fa-spinner fa-spin mr-2\"></i>\n                  Importing...\n                </>\n              ) : (\n                <>\n                  <i className=\"fas fa-file-import mr-2\"></i>\n                  Import {csvData.length} Products\n                </>\n              )}\n            </Button>\n          </>\n        ) : undefined\n      }\n    >\n      {step === 'upload' && renderUploadStep()}\n      {step === 'mapping' && renderMappingStep()}\n      {step === 'preview' && renderPreviewStep()}\n    </Modal>\n  );\n}\n\nexport default ImportCSVModal;\n","'use client'\n\nimport { useState, useEffect, useCallback, useMemo } from 'react'\nimport { QueryConstraint, orderBy, where, limit } from 'firebase/firestore'\nimport { useAuth } from '@/context/AuthContext'\nimport { useOrganization } from '@/context/OrganizationContext'\nimport { FirestoreService, isDemoOrganization } from '@/lib/firestore'\nimport {\n  Product,\n  Order,\n  PurchaseOrder,\n  WorkOrder,\n  Supplier,\n  Location,\n  Return,\n  StockTransfer,\n  Bundle,\n  InventoryLevel,\n  InventoryItem,\n} from '@/types'\n\n// Generic hook for Firestore collections\nfunction useFirestoreCollection<T extends { id: string }>(\n  collectionName: string,\n  queryConstraints: QueryConstraint[] = [],\n  enabled: boolean = true\n) {\n  const { organization } = useOrganization()\n  const [data, setData] = useState<T[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<Error | null>(null)\n\n  const orgId = organization?.id\n\n  const service = useMemo(() => {\n    if (!orgId) return null\n    // Skip Firestore for demo org\n    if (isDemoOrganization(orgId)) return null\n    return new FirestoreService<T>(orgId, collectionName)\n  }, [orgId, collectionName])\n\n  useEffect(() => {\n    // For demo mode, don't fetch from Firestore\n    if (!orgId || isDemoOrganization(orgId)) {\n      setLoading(false)\n      return\n    }\n\n    if (!service || !enabled) {\n      setLoading(false)\n      return\n    }\n\n    setLoading(true)\n\n    const unsubscribe = service.subscribe(\n      (newData) => {\n        setData(newData)\n        setLoading(false)\n        setError(null)\n      },\n      (err) => {\n        console.error(`Error fetching ${collectionName}:`, err)\n        setError(err)\n        setLoading(false)\n      },\n      ...queryConstraints\n    )\n\n    return () => unsubscribe()\n  }, [service, enabled, orgId, collectionName, JSON.stringify(queryConstraints)])\n\n  const create = useCallback(\n    async (item: Omit<T, 'id' | 'createdAt' | 'updatedAt'>) => {\n      if (!service) throw new Error('No organization or in demo mode')\n      return service.create(item)\n    },\n    [service]\n  )\n\n  const update = useCallback(\n    async (id: string, updates: Partial<T>) => {\n      if (!service) throw new Error('No organization or in demo mode')\n      return service.update(id, updates)\n    },\n    [service]\n  )\n\n  const remove = useCallback(\n    async (id: string) => {\n      if (!service) throw new Error('No organization or in demo mode')\n      return service.delete(id)\n    },\n    [service]\n  )\n\n  const getById = useCallback(\n    async (id: string) => {\n      if (!service) throw new Error('No organization or in demo mode')\n      return service.get(id)\n    },\n    [service]\n  )\n\n  return {\n    data,\n    loading,\n    error,\n    create,\n    update,\n    remove,\n    getById,\n    service,\n    isDemo: orgId ? isDemoOrganization(orgId) : false,\n  }\n}\n\n// Products hook\nexport function useProducts() {\n  const result = useFirestoreCollection<Product>('products', [orderBy('name')])\n\n  return {\n    products: result.data,\n    ...result,\n  }\n}\n\n// Single product hook\nexport function useProduct(productId: string | null) {\n  const { organization } = useOrganization()\n  const [product, setProduct] = useState<Product | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<Error | null>(null)\n\n  const orgId = organization?.id\n\n  useEffect(() => {\n    if (!orgId || !productId || isDemoOrganization(orgId)) {\n      setLoading(false)\n      return\n    }\n\n    const service = new FirestoreService<Product>(orgId, 'products')\n\n    const unsubscribe = service.subscribeToDoc(\n      productId,\n      (data) => {\n        setProduct(data)\n        setLoading(false)\n      },\n      (err) => {\n        setError(err)\n        setLoading(false)\n      }\n    )\n\n    return () => unsubscribe()\n  }, [orgId, productId])\n\n  return { product, loading, error }\n}\n\n// Orders hook\nexport function useOrders(status?: string) {\n  const constraints: QueryConstraint[] = [orderBy('createdAt', 'desc')]\n\n  if (status && status !== 'all') {\n    constraints.unshift(where('status', '==', status))\n  }\n\n  const result = useFirestoreCollection<Order>('orders', constraints)\n\n  return {\n    orders: result.data,\n    ...result,\n  }\n}\n\n// Recent orders hook (for dashboard)\nexport function useRecentOrders(count: number = 10) {\n  const result = useFirestoreCollection<Order>('orders', [\n    orderBy('createdAt', 'desc'),\n    limit(count),\n  ])\n\n  return {\n    orders: result.data,\n    ...result,\n  }\n}\n\n// Purchase Orders hook\nexport function usePurchaseOrders(status?: string) {\n  const constraints: QueryConstraint[] = [orderBy('createdAt', 'desc')]\n\n  if (status && status !== 'all') {\n    constraints.unshift(where('status', '==', status))\n  }\n\n  const result = useFirestoreCollection<PurchaseOrder>('purchaseOrders', constraints)\n\n  return {\n    purchaseOrders: result.data,\n    ...result,\n  }\n}\n\n// Work Orders hook\nexport function useWorkOrders(status?: string) {\n  const constraints: QueryConstraint[] = [orderBy('createdAt', 'desc')]\n\n  if (status && status !== 'all') {\n    constraints.unshift(where('status', '==', status))\n  }\n\n  const result = useFirestoreCollection<WorkOrder>('workOrders', constraints)\n\n  return {\n    workOrders: result.data,\n    ...result,\n  }\n}\n\n// Suppliers hook\nexport function useSuppliers() {\n  const result = useFirestoreCollection<Supplier>('suppliers', [orderBy('name')])\n\n  return {\n    suppliers: result.data,\n    ...result,\n  }\n}\n\n// Locations hook\nexport function useLocations() {\n  const result = useFirestoreCollection<Location>('locations', [orderBy('name')])\n\n  return {\n    locations: result.data,\n    ...result,\n  }\n}\n\n// Returns hook\nexport function useReturns(status?: string) {\n  const constraints: QueryConstraint[] = [orderBy('createdAt', 'desc')]\n\n  if (status && status !== 'all') {\n    constraints.unshift(where('status', '==', status))\n  }\n\n  const result = useFirestoreCollection<Return>('returns', constraints)\n\n  return {\n    returns: result.data,\n    ...result,\n  }\n}\n\n// Stock Transfers hook\nexport function useStockTransfers(status?: string) {\n  const constraints: QueryConstraint[] = [orderBy('createdAt', 'desc')]\n\n  if (status && status !== 'all') {\n    constraints.unshift(where('status', '==', status))\n  }\n\n  const result = useFirestoreCollection<StockTransfer>('transfers', constraints)\n\n  return {\n    transfers: result.data,\n    ...result,\n  }\n}\n\n// Bundles hook\nexport function useBundles() {\n  const result = useFirestoreCollection<Bundle>('bundles', [orderBy('name')])\n\n  return {\n    bundles: result.data,\n    ...result,\n  }\n}\n\n// Inventory levels hook\nexport function useInventory(locationId?: string) {\n  const constraints: QueryConstraint[] = []\n\n  if (locationId) {\n    constraints.push(where('locationId', '==', locationId))\n  }\n\n  const result = useFirestoreCollection<InventoryItem>('inventory', constraints)\n\n  return {\n    inventory: result.data,\n    ...result,\n  }\n}\n\n// Low stock products hook\nexport function useLowStockProducts() {\n  const { products } = useProducts()\n\n  const lowStock = useMemo(() => {\n    return products.filter(p => {\n      // Check using reorderPoint as threshold\n      const threshold = p.reorderPoint || 10\n      // We need inventory data to check actual stock levels\n      // For now, just return empty as we need to join with inventory\n      return false\n    })\n  }, [products])\n\n  const outOfStock = useMemo(() => {\n    // Need inventory data to determine out of stock\n    return []\n  }, [products])\n\n  return { lowStock, outOfStock }\n}\n\n// Dashboard stats hook - combines real Firestore data with demo fallback\nexport function useDashboardStats() {\n  const { orders, loading: ordersLoading, isDemo } = useOrders()\n  const { products, loading: productsLoading } = useProducts()\n\n  const stats = useMemo(() => {\n    const today = new Date()\n    today.setHours(0, 0, 0, 0)\n\n    const todayOrders = orders.filter(o => {\n      const createdAt = o.createdAt as string | Date\n      const orderDate = typeof createdAt === 'string'\n        ? new Date(createdAt)\n        : createdAt instanceof Date\n          ? createdAt\n          : new Date()\n      return orderDate >= today\n    })\n\n    const pendingOrders = orders.filter(o =>\n      ['pending', 'to_pick', 'to_pack'].includes(o.status)\n    )\n\n    const shippedToday = orders.filter(o => {\n      if (o.status !== 'shipped' && o.status !== 'delivered') return false\n      // Check shipments for shipped date\n      const shippedDate = o.shipments?.[0]?.shippedAt\n      if (!shippedDate) return false\n      const shipped = typeof shippedDate === 'string' ? new Date(shippedDate) : new Date()\n      return shipped >= today\n    })\n\n    return {\n      todayOrders: todayOrders.length,\n      todayRevenue: todayOrders.reduce((sum, o) => sum + (o.total || 0), 0),\n      pendingOrders: pendingOrders.length,\n      shippedToday: shippedToday.length,\n      totalProducts: products.length,\n      lowStockCount: 0, // Would need inventory join\n      outOfStockCount: 0, // Would need inventory join\n    }\n  }, [orders, products])\n\n  return {\n    ...stats,\n    loading: ordersLoading || productsLoading,\n    isDemo,\n  }\n}\n\n// Hook for combined product + inventory data\nexport function useProductsWithInventory() {\n  const { products, loading: productsLoading, ...productMethods } = useProducts()\n  const { inventory, loading: inventoryLoading } = useInventory()\n\n  const productsWithStock = useMemo(() => {\n    return products.map(product => {\n      const stockItems = inventory.filter(i => i.productId === product.id)\n      const totalStock = stockItems.reduce((sum, i) => sum + i.quantity, 0)\n\n      return {\n        ...product,\n        totalStock,\n        stockByLocation: stockItems,\n      }\n    })\n  }, [products, inventory])\n\n  return {\n    products: productsWithStock,\n    loading: productsLoading || inventoryLoading,\n    ...productMethods,\n  }\n}\n"],"names":[],"mappings":"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"}