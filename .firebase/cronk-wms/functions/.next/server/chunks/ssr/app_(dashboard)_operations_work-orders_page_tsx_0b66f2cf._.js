module.exports=[8060,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(4720),e=a.i(96221),f=a.i(33441),g=a.i(83497),h=a.i(21161),i=a.i(15618),j=a.i(25015),k=a.i(77156),l=a.i(84505),m=a.i(24569),n=a.i(98263),o=a.i(89697),p=a.i(57581);a.i(94660);var q=a.i(31887),r=a.i(65631),s=a.i(88860),t=a.i(91828);a.i(39142);var u=a.i(94126),v=a.i(76186),w=a.i(23492),x=a.i(25196);function y(){let{state:a,dispatch:y}=(0,n.useApp)(),{success:z,error:A}=(0,o.useToast)(),B=(0,p.useConfirm)(),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),Q=b=>a.inventory.filter(a=>a.productId===b).reduce((a,b)=>a+b.quantity,0),R=(0,c.useMemo)(()=>a.workOrders.filter(a=>{if(C&&a.status!==C||E&&a.priority!==E)return!1;if(G){let b=G.toLowerCase();return a.woNumber.toLowerCase().includes(b)||a.outputProductName.toLowerCase().includes(b)}return!0}),[a.workOrders,C,E,G]),S=(0,c.useMemo)(()=>{let b=new Date(new Date().getTime()-6048e5);return{pending:a.workOrders.filter(a=>"pending"===a.status).length,inProgress:a.workOrders.filter(a=>"in_progress"===a.status).length,completedThisWeek:a.workOrders.filter(a=>"completed"===a.status&&!!a.completedAt&&new Date(a.completedAt)>=b).length,unitsProducedThisWeek:a.workOrders.filter(a=>"completed"===a.status&&a.completedAt&&new Date(a.completedAt)>=b).reduce((a,b)=>a+b.quantityProduced,0),unitsInProduction:a.workOrders.filter(a=>"in_progress"===a.status).reduce((a,b)=>a+b.quantityToProduce,0),bomCount:a.bundles.length}},[a.workOrders,a.bundles]),T=(0,c.useMemo)(()=>a.workOrders.filter(a=>"in_progress"===a.status),[a.workOrders]),U=a=>{N(a),L(!0)},V=a=>{"pending"!==a.status?A("Only pending work orders can be edited"):(P(a),L(!1),J(!0))},W=async b=>{b.components.every(a=>Q(a.productId)>=a.quantityRequired)?await B({title:"Start Production",message:`Start production on ${b.woNumber}? This will deduct components from inventory.`,confirmText:"Start Production"})&&(b.components.forEach(b=>{let c=a.locations.find(a=>a.isDefault),d=c?.id||a.locations[0]?.id||"loc-1";y({type:"ADJUST_STOCK",payload:{productId:b.productId,locationId:d,adjustment:-b.quantityRequired}})}),y({type:"UPDATE_WORK_ORDER",payload:{...b,status:"in_progress",startedAt:new Date,components:b.components.map(a=>({...a,quantityUsed:a.quantityRequired}))}}),z(`Started production on ${b.woNumber}`)):A("Insufficient stock to start production")},X=async b=>{if(await B({title:"Complete Work Order",message:`Complete ${b.woNumber}? This will add ${b.quantityToProduce} ${b.outputProductName} to inventory.`,confirmText:"Complete"})){let c=a.locations.find(a=>a.isDefault),d=c?.id||a.locations[0]?.id||"loc-1";y({type:"ADJUST_STOCK",payload:{productId:b.outputProductId,locationId:d,adjustment:b.quantityToProduce}}),y({type:"UPDATE_WORK_ORDER",payload:{...b,status:"completed",quantityProduced:b.quantityToProduce,completedAt:new Date}}),z(`${b.woNumber} completed! ${(0,s.formatNumber)(b.quantityToProduce)} ${b.outputProductName} added to inventory`)}},Y=!!(C||E||G);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(t.Breadcrumb,{items:[{label:"Operations"},{label:"Work Orders"}]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Work Orders"}),(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"Manage production, labeling, and assembly tasks"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("button",{onClick:()=>{let a=new Blob([["WO Number,Output Product,Quantity,Status,Priority,Due Date,Created",...R.map(a=>[a.woNumber,a.outputProductName,a.quantityToProduce.toString(),a.status,a.priority,a.dueDate?(0,s.formatDate)(a.dueDate):"",(0,s.formatDate)(a.createdAt)]).map(a=>a.join(","))].join("\n")],{type:"text/csv"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`work-orders-${new Date().toISOString().split("T")[0]}.csv`,c.click(),URL.revokeObjectURL(b),z("Exported work orders to CSV")},className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg transition-colors flex items-center gap-2",children:[(0,b.jsx)(l.Download,{className:"w-4 h-4"}),"Export"]}),(0,b.jsxs)("button",{onClick:()=>{P(null),J(!0)},className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4"}),"New Work Order"]})]})]}),(0,b.jsxs)(v.OperationsStatsGrid,{children:[(0,b.jsx)(v.OperationsStatCard,{icon:d.FileText,iconColor:"slate",value:S.pending,label:"Pending",onClick:()=>D("pending"),isActive:"pending"===C}),(0,b.jsx)(v.OperationsStatCard,{icon:e.Loader2,iconColor:"blue",value:S.inProgress,label:"In Progress",onClick:()=>D("in_progress"),isActive:"in_progress"===C,accentBorder:!0}),(0,b.jsx)(v.OperationsStatCard,{icon:f.Check,iconColor:"emerald",value:S.completedThisWeek,label:"Completed (7d)",onClick:()=>D("completed"),isActive:"completed"===C,accentBorder:!0}),(0,b.jsx)(v.OperationsStatCard,{icon:g.Package,iconColor:"slate",value:(0,s.formatNumber)(S.unitsInProduction),label:"Units in Production"}),(0,b.jsx)(v.OperationsStatCard,{icon:g.Package,iconColor:"amber",value:(0,s.formatNumber)(S.unitsProducedThisWeek),label:"Produced (7d)",accentBorder:!0}),(0,b.jsx)(v.OperationsStatCard,{icon:h.Settings,iconColor:"purple",value:S.bomCount,label:"Active BOMs",accentBorder:!0})]}),T.length>0&&(0,b.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur border border-blue-500/30 rounded-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-5 py-4 border-b border-slate-700/50",children:[(0,b.jsx)("h2",{className:"font-semibold text-white",children:"Active Work Orders"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Work orders currently in progress"})]}),(0,b.jsx)("div",{className:"p-5 grid grid-cols-2 gap-4",children:T.map(a=>(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-blue-500/30 rounded-xl p-4 cursor-pointer hover:border-blue-500/50 transition-colors",onClick:()=>U(a),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-mono text-sm font-medium text-white",children:a.woNumber}),(0,b.jsx)(u.WOStatusBadge,{status:a.status})]}),(0,b.jsx)(u.PriorityBadge,{priority:a.priority})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-emerald-500/20 rounded-lg flex items-center justify-center",children:(0,b.jsx)(g.Package,{className:"w-6 h-6 text-emerald-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white font-medium",children:a.outputProductName}),(0,b.jsxs)("div",{className:"text-xs text-slate-400",children:[(0,s.formatNumber)(a.quantityToProduce)," units"]})]})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Progress"}),(0,b.jsx)("span",{className:"text-blue-400",children:"50%"})]}),(0,b.jsx)("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-blue-500 rounded-full",style:{width:"50%"}})})]}),(0,b.jsxs)("div",{className:"flex gap-2",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("button",{onClick:()=>X(a),className:"flex-1 px-3 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-sm flex items-center justify-center gap-2",children:[(0,b.jsx)(f.Check,{className:"w-4 h-4"}),"Complete"]}),(0,b.jsx)("button",{onClick:()=>U(a),className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm",children:(0,b.jsx)(k.Eye,{className:"w-4 h-4"})})]})]},a.id))})]}),(0,b.jsxs)(w.FilterBar,{onClear:()=>{D(""),F(""),H("")},showClear:Y,children:[(0,b.jsx)(w.SearchInput,{value:G,onChange:H,placeholder:"Search by WO number or product..."}),(0,b.jsx)(w.FilterSelect,{value:C,onChange:D,placeholder:"All Statuses",options:[{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}]}),(0,b.jsx)(w.FilterSelect,{value:E,onChange:F,placeholder:"All Priorities",options:[{value:"normal",label:"Normal"},{value:"high",label:"High"},{value:"urgent",label:"Urgent"}]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur border border-slate-700/50 rounded-xl overflow-hidden",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50 border-b border-slate-700/50",children:(0,b.jsxs)("tr",{className:"text-left text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"WO Number"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"Output Product"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"Quantity"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"Priority"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"Due Date"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Status"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:0===R.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:7,className:"px-4 py-12 text-center text-slate-400",children:0===a.workOrders.length?"No work orders yet. Create your first work order!":"No work orders match your filters."})}):R.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-700/30 transition-colors cursor-pointer",onClick:()=>U(a),children:[(0,b.jsxs)("td",{className:"px-4 py-4",children:[(0,b.jsx)("div",{className:"font-mono text-sm font-medium text-white",children:a.woNumber}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:(0,s.formatDate)(a.createdAt)})]}),(0,b.jsx)("td",{className:"px-4 py-4",children:(0,b.jsx)("div",{className:"text-sm text-white",children:a.outputProductName})}),(0,b.jsx)("td",{className:"px-4 py-4",children:(0,b.jsxs)("div",{className:"text-sm text-white",children:["completed"===a.status?`${(0,s.formatNumber)(a.quantityProduced)} / ${(0,s.formatNumber)(a.quantityToProduce)}`:(0,s.formatNumber)(a.quantityToProduce)," units"]})}),(0,b.jsxs)("td",{className:"px-4 py-4",children:[(0,b.jsx)(u.PriorityBadge,{priority:a.priority}),"normal"===a.priority&&(0,b.jsx)("span",{className:"text-sm text-slate-400",children:"Normal"})]}),(0,b.jsx)("td",{className:"px-4 py-4 text-sm text-white",children:a.dueDate?(0,s.formatDate)(a.dueDate):"-"}),(0,b.jsx)("td",{className:"px-4 py-4 text-center",children:(0,b.jsx)(u.WOStatusBadge,{status:a.status})}),(0,b.jsx)("td",{className:"px-4 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-center gap-1",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("button",{onClick:()=>U(a),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",title:"View",children:(0,b.jsx)(k.Eye,{className:"w-4 h-4"})}),"pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>V(a),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",title:"Edit",children:(0,b.jsx)(m.Edit,{className:"w-4 h-4"})}),(0,b.jsxs)("button",{onClick:()=>W(a),className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 text-white text-xs rounded-lg flex items-center gap-1",children:[(0,b.jsx)(j.Play,{className:"w-3 h-3"}),"Start"]})]}),"in_progress"===a.status&&(0,b.jsxs)("button",{onClick:()=>X(a),className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 text-white text-xs rounded-lg flex items-center gap-1",children:[(0,b.jsx)(f.Check,{className:"w-3 h-3"}),"Complete"]})]})})]},a.id))})]})}),(0,b.jsx)(x.PaginationFooter,{showing:R.length,total:a.workOrders.length,label:"work orders"})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur border border-slate-700/50 rounded-xl overflow-hidden",children:[(0,b.jsx)("div",{className:"px-5 py-4 border-b border-slate-700/50 flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"font-semibold text-white",children:"Available BOMs (Bundles)"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Bundles can be used as Bill of Materials for work orders"})]})}),(0,b.jsx)("div",{className:"p-4 grid grid-cols-4 gap-4",children:a.bundles.slice(0,8).map(a=>{let c=1/0;return a.components.forEach(a=>{let b=Q(a.productId);c=Math.min(c,Math.floor(b/a.quantity))}),c===1/0&&(c=0),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4 hover:border-emerald-500/30 transition-colors cursor-pointer",onClick:()=>{P(null),J(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-purple-500/20 rounded flex items-center justify-center",children:(0,b.jsx)(g.Package,{className:"w-4 h-4 text-purple-400"})}),(0,b.jsx)("span",{className:"font-medium text-white truncate",children:a.name})]}),(0,b.jsxs)("div",{className:"text-xs text-slate-400 mb-2",children:[a.components.length," components"]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Can build:"}),(0,b.jsxs)("span",{className:c>0?"text-emerald-400":"text-red-400",children:[(0,s.formatNumber)(c)," units"]})]})]},a.id)})})]}),(0,b.jsx)(q.CreateWorkOrderModal,{isOpen:I,onClose:()=>{J(!1),P(null)},editWO:O}),(0,b.jsx)(r.WorkOrderDetailModal,{isOpen:K,onClose:()=>{L(!1),N(null)},workOrder:M,onEdit:V})]})}a.s(["default",()=>y])}];

//# sourceMappingURL=app_%28dashboard%29_operations_work-orders_page_tsx_0b66f2cf._.js.map