module.exports=[9,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(98263),f=a.i(34904),g=a.i(12466),h=a.i(89697),i=a.i(88860),j=a.i(91828),k=a.i(63820);a.i(42390);var l=a.i(77877),m=a.i(4019),n=a.i(5948),o=a.i(8838),p=a.i(83497),q=a.i(80032),r=a.i(10227),s=a.i(33441),t=a.i(33508),u=a.i(87532),v=a.i(71931),w=a.i(33350),x=a.i(18398),y=a.i(3544);let z=(0,a.i(70106).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var A=a.i(8406),B=a.i(24987),C=a.i(92e3);function D(){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-8 w-64 bg-slate-700/50 rounded animate-pulse"}),(0,b.jsx)("div",{className:"h-32 bg-slate-800/50 rounded-xl animate-pulse"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"col-span-2 h-96 bg-slate-800/50 rounded-xl animate-pulse"}),(0,b.jsx)("div",{className:"h-96 bg-slate-800/50 rounded-xl animate-pulse"})]})]})}function E(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(D,{}),children:(0,b.jsx)(G,{})})}let F=[{value:"all",label:"All"},{value:"to_pack",label:"To Pack"},{value:"packing",label:"Packing"}];function G(){let{state:a,dispatch:D}=(0,e.useApp)(),{success:E,error:G,warning:H,info:I}=(0,h.useToast)(),J=(0,d.useSearchParams)(),K=(0,d.useRouter)(),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)({}),[X,Y]=(0,c.useState)("all"),[Z,$]=(0,c.useState)(!1),_=(0,c.useRef)(null),aa=(0,c.useMemo)(()=>{let b=a.orders.filter(a=>"to_pack"===a.status||"packing"===a.status);return"all"===X?b:b.filter(a=>a.status===X)},[a.orders,X]);(0,c.useEffect)(()=>{if(!Z){let b=J.get("order"),c=J.get("status");if(("to_pack"===c||"packing"===c)&&Y(c),b){let c=a.orders.find(a=>a.orderNumber===b||a.id===b);c&&("to_pack"===c.status||"packing"===c.status)&&ai(c)}$(!0)}},[J,Z,a.orders]);let ab=(0,c.useCallback)(a=>{let b=new URLSearchParams;"all"!==a&&b.set("status",a);let c=b.toString()?`/fulfillment/pack?${b.toString()}`:"/fulfillment/pack";K.replace(c,{scroll:!1})},[K]),ac=(0,c.useMemo)(()=>{let a=[];return"all"!==X&&a.push({key:"status",label:"Status",value:"to_pack"===X?"To Pack":"Packing"}),a},[X]),ad=b=>b?b.items.reduce((b,c)=>{let d=a.products.find(a=>a.id===c.productId);return d?.dimensions?b+d.dimensions.length*d.dimensions.width*d.dimensions.height*c.quantity:b+50*c.quantity},0):0,ae=b=>b?b.items.reduce((b,c)=>{let d=a.products.find(a=>a.id===c.productId);return b+(d?.weight.value||1)*c.quantity*16},0):0,af=(0,c.useMemo)(()=>{if(!N||!a.settings.smartBoxEnabled)return null;let b=ad(N),c=ae(N);return a.boxes.filter(a=>a.smartBoxEligible).filter(a=>a.innerLength*a.innerWidth*a.innerHeight>=1.1*b&&a.maxWeight>=c).sort((a,b)=>a.innerLength*a.innerWidth*a.innerHeight-b.innerLength*b.innerWidth*b.innerHeight)[0]||null},[N,a.boxes,a.settings.smartBoxEnabled,a.products]),ag=(0,c.useMemo)(()=>N?N.items.reduce((a,b)=>a+b.quantity,0):0,[N]);(0,c.useEffect)(()=>{let a=a=>{if(/^[a-zA-Z0-9]$/.test(a.key)&&!a.ctrlKey&&!a.metaKey){let a=document.activeElement;a?.tagName!=="INPUT"&&a?.tagName!=="TEXTAREA"&&a?.tagName!=="SELECT"&&_.current?.focus()}"Escape"===a.key&&ak()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]);let ah=b=>{if("Enter"===b.key&&L.trim()){let b=L.toLowerCase().trim();if(N){let a=N.items.find(a=>a.sku.toLowerCase()===b);if(a){aj(a.sku),M("");return}}let c=a.orders.find(a=>a.orderNumber.toLowerCase()===b||a.id===b||a.orderNumber.toLowerCase().includes(b));if(c){if("to_pack"!==c.status&&"packing"!==c.status){H(`Order ${c.orderNumber} is not ready for packing (status: ${c.status})`),M("");return}ai(c),M("")}else G("Order not found")}},ai=a=>{O(a),W({}),af&&Q(af),"to_pack"===a.status&&D({type:"UPDATE_ORDER_STATUS",payload:{orderId:a.id,status:"packing"}})},aj=a=>{let b=N?.items.find(b=>b.sku===a);if(!b)return void G(`Item ${a} not in this order!`);let c=V[a]||0;c>=b.quantity?H(`Already verified all ${b.quantity} of ${a}`):(W(b=>({...b,[a]:(b[a]||0)+1})),E(`Verified ${a} (${c+1}/${b.quantity})`))},ak=()=>{N&&"packing"===N.status&&D({type:"UPDATE_ORDER_STATUS",payload:{orderId:N.id,status:"to_pack"}}),O(null),Q(null),S(""),U(""),W({})},al=ad(N),am=ae(N);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(j.Breadcrumb,{items:[{label:"Fulfillment",href:"/fulfillment"},{label:"Pack Station"}]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Pack Station"}),(0,b.jsxs)("p",{className:"text-slate-400",children:[aa.length," orders ready to pack"]})]}),(0,b.jsx)(m.StatusFilterTabs,{options:F,value:X,onChange:a=>{Y(a),ab(a)},accentColor:"purple"})]}),ac.length>0&&(0,b.jsx)(k.ActiveFilters,{filters:ac,onRemove:a=>{"status"===a&&(Y("all"),ab("all"))},onClearAll:()=>{Y("all"),K.replace("/fulfillment/pack",{scroll:!1})}}),(0,b.jsx)(f.Card,{children:(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-purple-500/20",children:(0,b.jsx)(o.ScanLine,{className:"h-6 w-6 text-purple-400"})}),(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(u.Search,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),(0,b.jsx)("input",{ref:_,type:"text",value:L,onChange:a=>M(a.target.value),onKeyDown:ah,placeholder:N?"Scan SKU to verify item...":"Scan order barcode or enter order number...",className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-lg pl-12 pr-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50",autoFocus:!0})]}),(0,b.jsx)(g.Button,{onClick:()=>L.trim()&&ah({key:"Enter"}),children:N?"Verify":"Load Order"})]})})}),N?(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Order #",N.orderNumber]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)("span",{className:"text-sm text-slate-400",children:N.customer.name}),(0,b.jsx)(l.ChannelBadge,{channel:N.channel})]})]}),(0,b.jsx)("button",{onClick:ak,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:(0,b.jsx)(t.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"space-y-2",children:N.items.map((a,c)=>{let d=V[a.sku]||0,e=d>=a.quantity;return(0,b.jsxs)("div",{className:`flex items-center justify-between rounded-lg p-3 ${e?"bg-emerald-500/10 border border-emerald-500/30":"bg-slate-700/30 border border-slate-600/30"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg ${e?"bg-emerald-500/20":"bg-slate-700/50"}`,children:e?(0,b.jsx)(s.Check,{className:"h-5 w-5 text-emerald-400"}):(0,b.jsx)(p.Package,{className:"h-5 w-5 text-slate-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-white",children:a.productName}),(0,b.jsxs)("p",{className:"text-xs text-slate-400",children:["SKU: ",a.sku]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-white",children:[d," / ",a.quantity]}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"verified"})]})]},c)})}),a.settings.gripperStickerEnabled&&(0,b.jsx)("div",{className:"mt-4 rounded-lg bg-amber-500/10 border border-amber-500/30 p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(w.Tag,{className:"h-4 w-4 text-amber-400"}),(0,b.jsxs)("span",{className:"text-sm text-amber-300",children:[ag," gripper sticker",1!==ag?"s":""," will be auto-deducted"]})]})})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("h3",{className:"text-md font-semibold text-white mb-3 flex items-center gap-2",children:[(0,b.jsx)(B.MapPin,{className:"w-4 h-4 text-slate-400"}),"Ship To"]}),(0,b.jsxs)("div",{className:"text-sm text-slate-300",children:[(0,b.jsx)("p",{className:"font-medium",children:N.customer.name}),(0,b.jsx)("p",{children:N.customer.address.street}),(0,b.jsxs)("p",{children:[N.customer.address.city,", ",N.customer.address.state," ",N.customer.address.zip]}),(0,b.jsx)("p",{children:N.customer.address.country})]})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("h3",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[(0,b.jsx)(z,{className:"w-4 h-4 text-slate-400"}),"Pack Photo"]}),(0,b.jsxs)("button",{onClick:()=>I("Photo capture coming in a future update"),className:"w-full p-8 border-2 border-dashed border-slate-600 rounded-lg text-slate-400 hover:border-slate-500 hover:text-slate-300 transition-colors",children:[(0,b.jsx)(z,{className:"w-8 h-8 mx-auto mb-2"}),(0,b.jsx)("div",{children:"Capture Photo"}),(0,b.jsx)("div",{className:"text-xs mt-1",children:"Coming in a future update"})]})]})})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("h3",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[(0,b.jsx)(q.Box,{className:"w-4 h-4 text-slate-400"}),"Select Box"]}),(0,b.jsxs)("div",{className:"mb-4 rounded-lg bg-slate-700/30 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,b.jsx)(y.Ruler,{className:"w-3 h-3"}),"Volume:"]}),(0,b.jsxs)("span",{className:"text-white",children:[(0,i.formatNumber)(al)," cu in"]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mt-1",children:[(0,b.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,b.jsx)(x.Scale,{className:"w-3 h-3"}),"Weight:"]}),(0,b.jsxs)("span",{className:"text-white",children:[(am/16).toFixed(1)," lbs"]})]}),af&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2 pt-2 border-t border-slate-600/30",children:[(0,b.jsx)(A.Sparkles,{className:"h-4 w-4 text-emerald-400"}),(0,b.jsxs)("span",{className:"text-xs text-emerald-400",children:["Suggested: ",af.name]})]})]}),0===a.boxes.length?(0,b.jsxs)("div",{className:"text-center py-4",children:[(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"No boxes configured"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Add boxes in Settings"})]}):(0,b.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.boxes.map(a=>{let c=a.innerLength*a.innerWidth*a.innerHeight>=1.1*al,d=a.maxWeight>=am,e=c&&d,f=a.id===af?.id;return(0,b.jsxs)("button",{onClick:()=>e&&Q(a),disabled:!e,className:`w-full flex items-center justify-between rounded-lg p-3 text-left transition-colors ${P?.id===a.id?"bg-emerald-500/20 border border-emerald-500/50":e?"bg-slate-700/30 border border-slate-600/30 hover:bg-slate-700/50":"bg-slate-700/20 border border-slate-700/30 opacity-50 cursor-not-allowed"}`,children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-white",children:a.name}),f&&(0,b.jsx)("span",{className:"rounded bg-emerald-500/20 px-1.5 py-0.5 text-xs text-emerald-400",children:"Best Fit"})]}),(0,b.jsxs)("p",{className:"text-xs text-slate-400",children:[a.innerLength,'" x ',a.innerWidth,'" x ',a.innerHeight,'"']})]}),(0,b.jsxs)("div",{className:"text-right",children:[a.cost&&(0,b.jsx)("p",{className:"text-sm text-slate-300",children:(0,i.formatCurrency)(a.cost)}),!e&&(0,b.jsx)("p",{className:"text-xs text-red-400",children:c?"Too heavy":"Too small"})]})]},a.id)})})]})}),(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("h3",{className:"text-md font-semibold text-white mb-4 flex items-center gap-2",children:[(0,b.jsx)(r.Truck,{className:"w-4 h-4 text-slate-400"}),"Shipping"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Carrier"}),(0,b.jsxs)("select",{value:R,onChange:a=>{S(a.target.value),U("")},className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select carrier..."}),n.CARRIERS.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Service"}),(0,b.jsxs)("select",{value:T,onChange:a=>U(a.target.value),disabled:!R,className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50 disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Select service..."}),n.CARRIERS.find(a=>a.id===R)?.services.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),R&&T&&(0,b.jsxs)("div",{className:"rounded-lg bg-slate-700/30 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Estimated Cost:"}),(0,b.jsx)("span",{className:"text-white font-medium",children:(0,i.formatCurrency)((0,n.estimateShippingCost)(R,T))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mt-1",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Customer Paid:"}),(0,b.jsx)("span",{className:"text-white",children:(0,i.formatCurrency)(N.shipping)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mt-1 pt-1 border-t border-slate-600/30",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Profit:"}),(0,b.jsx)("span",{className:`font-medium ${N.shipping-(0,n.estimateShippingCost)(R,T)>=0?"text-emerald-400":"text-red-400"}`,children:(0,i.formatCurrency)(N.shipping-(0,n.estimateShippingCost)(R,T))})]})]})]})]})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(g.Button,{variant:"secondary",onClick:()=>I("Print preview coming soon"),disabled:!P||!R||!T,className:"w-full",children:[(0,b.jsx)(v.Printer,{className:"w-4 h-4"}),"Print Label"]}),(0,b.jsxs)(g.Button,{onClick:()=>{if(!N)return;if(!P)return void G("Please select a box");if(!R||!T)return void G("Please select carrier and service");let b=(0,n.generateTrackingNumber)(R),c=(0,n.estimateShippingCost)(R,T);if(D({type:"ADD_SHIPMENT",payload:{id:crypto.randomUUID(),orderId:N.id,orderNumber:N.orderNumber,carrier:R,service:T,trackingNumber:b,customerPaid:N.shipping,actualCost:c,profit:N.shipping-c,weight:ae(N),status:"in_transit",customerName:N.customer.name,customerCity:N.customer.address.city,customerState:N.customer.address.state,shippedAt:new Date}}),D({type:"UPDATE_ORDER",payload:{...N,status:"shipped",trackingNumber:b,carrier:R,service:T,shippedAt:new Date,updatedAt:new Date}}),a.settings.gripperStickerEnabled&&a.settings.gripperStickerSku){var d;let b,c=(d=a.settings.gripperStickerSku,b=a.products.find(a=>a.sku===d),b?.id||"");if(c){let b=a.locations.find(a=>a.isDefault);D({type:"ADJUST_STOCK",payload:{productId:c,locationId:b?.id||a.locations[0]?.id||"loc-1",adjustment:-ag}})}}E(`Order ${N.orderNumber} shipped! Tracking: ${b}`),ak()},disabled:!P||!R||!T,className:"w-full",children:[(0,b.jsx)(r.Truck,{className:"w-4 h-4"}),"Print & Ship"]})]}),(!P||!R||!T)&&(0,b.jsx)("div",{className:"rounded-lg bg-amber-500/10 border border-amber-500/30 p-3",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(C.AlertCircle,{className:"h-4 w-4 text-amber-400 mt-0.5"}),(0,b.jsxs)("div",{className:"text-xs text-amber-300",children:[!P&&(0,b.jsx)("p",{children:"Please select a box"}),!R&&(0,b.jsx)("p",{children:"Please select a carrier"}),R&&!T&&(0,b.jsx)("p",{children:"Please select a service"})]})]})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsxs)("div",{className:"p-12 text-center",children:[(0,b.jsx)(p.Package,{className:"mx-auto h-16 w-16 text-slate-600"}),(0,b.jsx)("h3",{className:"mt-4 text-lg font-medium text-white",children:"No Order Selected"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-slate-400",children:"Scan an order barcode or select an order to begin packing"}),aa.length>0&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-400 mb-3",children:"Orders ready to pack:"}),(0,b.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:aa.slice(0,8).map(a=>(0,b.jsxs)("button",{onClick:()=>ai(a),className:"rounded-lg bg-slate-700/50 px-4 py-2 text-sm text-white hover:bg-slate-700 transition-colors",children:["#",a.orderNumber]},a.id))})]})]})})]})}a.s(["default",()=>E],9)}];

//# sourceMappingURL=app_%28dashboard%29_fulfillment_pack_page_tsx_ab468a7b._.js.map