module.exports=[82840,79497,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(88736),e=a.i(12466);a.i(69387);var f=a.i(60574),g=a.i(90761),h=a.i(19337);function i(a,b=[],d=!0){let{organization:e}=(0,g.useOrganization)(),[f,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(null),o=e?.id,p=(0,c.useMemo)(()=>!o||(0,h.isDemoOrganization)(o)?null:new h.FirestoreService(o,a),[o,a]);(0,c.useEffect)(()=>{if(!o||(0,h.isDemoOrganization)(o)||!p||!d)return void l(!1);l(!0);let c=p.subscribe(a=>{j(a),l(!1),n(null)},b=>{console.error(`Error fetching ${a}:`,b),n(b),l(!1)},...b);return()=>c()},[p,d,o,a,JSON.stringify(b)]);let q=(0,c.useCallback)(async a=>{if(!p)throw Error("No organization or in demo mode");return p.create(a)},[p]),r=(0,c.useCallback)(async(a,b)=>{if(!p)throw Error("No organization or in demo mode");return p.update(a,b)},[p]);return{data:f,loading:k,error:m,create:q,update:r,remove:(0,c.useCallback)(async a=>{if(!p)throw Error("No organization or in demo mode");return p.delete(a)},[p]),getById:(0,c.useCallback)(async a=>{if(!p)throw Error("No organization or in demo mode");return p.get(a)},[p]),service:p,isDemo:!!o&&(0,h.isDemoOrganization)(o)}}function j(){let a=i("products",[(0,f.orderBy)("name")]);return{products:a.data,...a}}function k(){let a=i("suppliers",[(0,f.orderBy)("name")]);return{suppliers:a.data,...a}}function l(){let a=i("locations",[(0,f.orderBy)("name")]);return{locations:a.data,...a}}function m(a){let b=[];a&&b.push((0,f.where)("locationId","==",a));let c=i("inventory",b);return{inventory:c.data,...c}}a.s(["useInventory",()=>m,"useLocations",()=>l,"useProducts",()=>j,"useSuppliers",()=>k],79497);var n=a.i(89697);let o=["name","sku"],p={name:"Product Name",sku:"SKU",category:"Category",cost:"Cost",priceMSRP:"MSRP",priceShopify:"Shopify Price",priceAmazon:"Amazon Price",priceWholesale:"Wholesale Price",weight:"Weight (oz)",barcode:"Barcode/UPC",quantity:"Quantity on Hand",binLocation:"Bin Location",reorderPoint:"Reorder Point",supplierSku:"Supplier SKU",supplierName:"Supplier Name",leadTime:"Lead Time (days)",minOrderQty:"Min Order Qty"},q=["name","sku","category","barcode"],r=["cost","priceMSRP","priceShopify","priceAmazon","priceWholesale"],s=["quantity","binLocation","reorderPoint","weight"],t=["supplierName","supplierSku","leadTime","minOrderQty"];function u({isOpen:a,onClose:f}){let g,h,i,u,v,{locations:w}=l(),{suppliers:x,service:y,isDemo:z}=k(),{products:A,service:B}=j(),{service:C}=m(),{success:D,error:E,warning:F}=(0,n.useToast)(),G=(0,c.useRef)(null),[H,I]=(0,c.useState)("upload"),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)({}),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(""),[X,Y]=(0,c.useState)(!0),[Z,$]=(0,c.useState)(!0),_=w.find(a=>"warehouse"===a.type)||w[0];!V&&_&&W(_.id);let aa=a=>{let b=[],c=[];"basic"===a?(b=["Product Name","SKU","Category","Cost","MSRP","Quantity"],c=[["Example Product 1","SKU-001","nutrient","10.00","24.99","100"],["Example Product 2","SKU-002","supply","15.00","34.99","50"]]):"full"===a?(b=["Product Name","SKU","Category","Barcode","Cost","MSRP","Shopify Price","Amazon Price","Wholesale Price","Quantity","Bin Location","Reorder Point","Weight (oz)","Supplier Name","Supplier SKU","Lead Time (days)","Min Order Qty"],c=[["Example Product 1","SKU-001","nutrient","123456789012","10.00","24.99","22.99","24.99","14.99","100","A1-01","25","32","Supplier Inc","SUP-001","14","50"],["Example Product 2","SKU-002","supply","234567890123","15.00","34.99","32.99","34.99","20.99","50","B2-03","20","16","Vendor Co","VND-002","7","25"]]):"inflow"===a&&(b=["Name","Barcode","Category","Description","Sale Price","Purchase Cost","Quantity on Hand","Location","Reorder Point","Vendor","Vendor SKU"],c=[["Product Name Here","123456789012","nutrient","Description text","24.99","10.00","100","Main Warehouse","25","Supplier Name","VENDOR-SKU-001"]]);let d=new Blob([[b.join(","),...c.map(a=>a.map(a=>`"${a}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a"),f=URL.createObjectURL(d);e.setAttribute("href",f),e.setAttribute("download",`cronk-wms-import-template-${a}.csv`),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)},ab=()=>{I("upload"),K(""),M([]),O([]),Q({}),S(!1);let a=w.find(a=>"warehouse"===a.type)||w[0];W(a?.id||""),Y(!0),$(!0),G.current&&(G.current.value="")},ac=a=>{if(!a.name.endsWith(".csv"))return void E("Please select a CSV file");K(a.name);let b=new FileReader;b.onload=a=>{let b,c,{headers:d,data:e}=(a=>{let b=a.replace(/^\uFEFF/,"").replace(/^\xEF\xBB\xBF/,"").split(/\r?\n/).filter(a=>a.trim());if(0===b.length)return{headers:[],data:[]};let c=b[0].split(",").map(a=>a.trim().replace(/^["']|["']$/g,"").trim()),d=[];for(let a=1;a<b.length;a++){let e=[],f="",g=!1;for(let c of b[a])'"'===c||"'"===c?g=!g:","!==c||g?f+=c:(e.push(f.trim().replace(/^["']|["']$/g,"")),f="");e.push(f.trim().replace(/^["']|["']$/g,""));let h={};c.forEach((a,b)=>{let c=(e[b]||"").replace(/^["']|["']$/g,"").trim();h[a]=c}),d.push(h)}return{headers:c,data:d}})(a.target?.result);0===d.length?E("Could not parse CSV file"):(M(d),O(e),Q((b={},c=d.map(a=>a.toLowerCase()),Object.entries({name:["name","product name","product","title","item name","description"],sku:["sku","product sku","item number","item #","item code","product code"],category:["category","type","product type","group","product category"],cost:["cost","cogs","unit cost","price cost","purchase price","buy price","purchase cost"],priceMSRP:["msrp","price","retail price","price msrp","sell price","sale price"],priceShopify:["shopify price","shopify","web price","online price"],priceAmazon:["amazon price","amazon","marketplace price"],priceWholesale:["wholesale","wholesale price","dealer price","trade price"],weight:["weight","weight (oz)","oz","weight oz","item weight","weight (lbs)","lbs"],barcode:["barcode","upc","ean","gtin","isbn"],quantity:["quantity","qty","stock","on hand","quantity on hand","stock qty","available","inventory"],binLocation:["bin","bin location","location","shelf","rack","position","warehouse location"],reorderPoint:["reorder point","reorder","min qty","minimum","low stock","reorder level"],supplierName:["supplier","vendor","supplier name","vendor name","manufacturer"],supplierSku:["supplier sku","vendor sku","manufacturer sku","vendor code","supplier code","mfg part #"],leadTime:["lead time","leadtime","lead time days","delivery time"],minOrderQty:["min order","moq","minimum order","min order qty"]}).forEach(([a,e])=>{let f=c.findIndex(a=>e.some(b=>a.includes(b)));-1!==f&&(b[a]=d[f])}),b)),I("mapping"))},b.readAsText(a)},ad=(0,c.useCallback)(a=>{a.preventDefault(),U(!1);let b=a.dataTransfer.files[0];b&&ac(b)},[]),ae=(0,c.useCallback)(a=>{a.preventDefault(),U(!0)},[]),af=(0,c.useCallback)(()=>{U(!1)},[]),ag=()=>o.every(a=>P[a]),ah=async()=>{if(ag()&&B){if(z)return void E("Import is not available in demo mode");S(!0);try{let a=new Set(A.map(a=>a.sku.toLowerCase())),b=new Map(x.map(a=>[a.name.toLowerCase(),a])),c=0,d=0,e=0,g=0,h=new Map,i=[],j=[],k=[],l=[];for(let f of N){let j=P.sku?f[P.sku]:"",m=P.name?f[P.name]:"";if(!j||!m||a.has(j.toLowerCase())){d++;continue}let n=parseFloat(P.priceMSRP?f[P.priceMSRP]:"0")||0,o=parseFloat(P.priceShopify?f[P.priceShopify]:"0")||n,p=parseFloat(P.priceAmazon?f[P.priceAmazon]:"0")||n,q=parseFloat(P.priceWholesale?f[P.priceWholesale]:"0")||.6*n,r=.75*q,s=parseFloat(P.cost?f[P.cost]:"0")||0,t=parseFloat(P.weight?f[P.weight]:"0")||0,u=parseInt(P.reorderPoint?f[P.reorderPoint]:"50")||50,v=parseInt(P.quantity?f[P.quantity]:"0")||0,w=P.binLocation?f[P.binLocation]?.trim():void 0,x=P.supplierName?f[P.supplierName]?.trim():"",z=P.category?f[P.category]?.trim().toLowerCase():"supply",A="supply";z.includes("nutrient")||z.includes("supplement")?A="nutrient":z.includes("packaging")||z.includes("box")||z.includes("bottle")?A="packaging":z.includes("label")&&(A="label");let B={name:m.trim(),sku:j.trim().toUpperCase(),barcode:P.barcode?f[P.barcode]?.trim():void 0,category:A,weight:t,prices:{msrp:n,shopify:o,amazon:p,wholesale:q,distributor:r},costs:{base:s,amazonPrep:0,shopify:0},reorderPoint:u,isActive:!0};i.push(B),a.add(j.toLowerCase()),c++,X&&V&&(v>0||w)&&(l.push({productIndex:i.length-1,quantity:v,binLocation:w}),e++),Z&&x&&y&&!b.get(x.toLowerCase())&&!h.has(x.toLowerCase())&&(k.push({name:x,currency:"USD"}),h.set(x.toLowerCase(),`pending-${k.length-1}`),g++)}k.length>0&&y&&await y.batchCreate(k);let m=await B.batchCreate(i);if(l.length>0&&C){for(let a of l){let b=m[a.productIndex];j.push({productId:b,locationId:V,quantity:a.quantity,binLocation:a.binLocation||""})}await C.batchCreate(j)}let n=[];c>0&&n.push(`${c} products`),e>0&&n.push(`${e} inventory records`),g>0&&n.push(`${g} new suppliers`),n.length>0&&D(`Successfully imported ${n.join(", ")}`),d>0&&F(`Skipped ${d} rows (missing data or duplicate SKUs)`),ab(),f()}catch(a){console.error("Import error:",a),E("Failed to import products")}finally{S(!1)}}},ai=()=>{ab(),f()},aj=(a,c,d,e)=>(0,b.jsxs)("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsxs)("h5",{className:`text-sm font-medium ${e} mb-3 flex items-center gap-2`,children:[(0,b.jsx)("i",{className:`fas ${d}`}),a]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:c.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-xs text-slate-400 mb-1",children:[p[a],o.includes(a)&&(0,b.jsx)("span",{className:"text-red-400 ml-1",children:"*"})]}),(0,b.jsxs)("select",{value:P[a]||"",onChange:b=>Q(c=>({...c,[a]:b.target.value})),className:`w-full bg-slate-800 border ${o.includes(a)&&!P[a]?"border-amber-500/50":"border-slate-700"} rounded-lg px-2 py-1.5 text-white text-sm focus:outline-none focus:border-emerald-500/50`,children:[(0,b.jsx)("option",{value:"",children:"-- Select --"}),L.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]},a))})]});return(0,b.jsxs)(d.Modal,{open:a,onClose:ai,title:"Import Products from CSV",subtitle:"upload"===H?"Upload a CSV file to import products":"mapping"===H?"Map CSV columns to product fields":"Review and confirm import",size:"lg",footer:"preview"===H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:ai,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:ah,disabled:R||z,children:R?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Importing..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-file-import mr-2"}),"Import ",N.length," Products"]})})]}):void 0,children:["upload"===H&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{onDrop:ad,onDragOver:ae,onDragLeave:af,onClick:()=>G.current?.click(),className:`border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-colors ${T?"border-emerald-500 bg-emerald-500/10":"border-slate-700 hover:border-slate-600"}`,children:[(0,b.jsx)("input",{ref:G,type:"file",accept:".csv",onChange:a=>{let b=a.target.files?.[0];b&&ac(b)},className:"hidden"}),(0,b.jsx)("i",{className:"fas fa-cloud-upload-alt text-4xl text-slate-500 mb-4"}),(0,b.jsx)("p",{className:"text-white font-medium mb-1",children:"Drag & drop CSV file here"}),(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"or click to browse"})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"CSV Format Requirements"}),(0,b.jsxs)("ul",{className:"text-sm text-slate-400 space-y-1",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("i",{className:"fas fa-check text-emerald-400 mr-2"}),"First row must contain column headers"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("i",{className:"fas fa-check text-emerald-400 mr-2"}),"Required columns: ",(0,b.jsx)("span",{className:"text-white",children:"Name, SKU"})]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("i",{className:"fas fa-check text-emerald-400 mr-2"}),"Pricing: Cost, MSRP, Shopify Price, Amazon Price, Wholesale"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("i",{className:"fas fa-check text-emerald-400 mr-2"}),"Inventory: Quantity, Bin Location, Reorder Point, Weight"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("i",{className:"fas fa-check text-emerald-400 mr-2"}),"Supplier: Supplier Name, Supplier SKU, Lead Time, Min Order Qty"]})]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"Download Templates"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)("button",{onClick:()=>aa("basic"),className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors",children:[(0,b.jsx)("i",{className:"fas fa-download mr-1.5"}),"Basic Template"]}),(0,b.jsxs)("button",{onClick:()=>aa("full"),className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors",children:[(0,b.jsx)("i",{className:"fas fa-download mr-1.5"}),"Full Template"]}),(0,b.jsxs)("button",{onClick:()=>aa("inflow"),className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-xs rounded-lg transition-colors",children:[(0,b.jsx)("i",{className:"fas fa-download mr-1.5"}),"inFlow Format"]})]})]}),z&&(0,b.jsx)("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-400 text-sm",children:[(0,b.jsx)("i",{className:"fas fa-info-circle"}),(0,b.jsx)("span",{children:"Import is disabled in demo mode. Sign in to import products."})]})})]}),"mapping"===H&&(0,b.jsxs)("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-file-csv text-emerald-400"}),(0,b.jsx)("span",{className:"text-white font-medium",children:J}),(0,b.jsxs)("span",{className:"text-slate-400 text-sm",children:["(",N.length," rows)"]})]}),(0,b.jsxs)("button",{onClick:ab,className:"text-sm text-slate-400 hover:text-white",children:[(0,b.jsx)("i",{className:"fas fa-times mr-1"}),"Change file"]})]})}),(0,b.jsxs)("div",{className:"space-y-3",children:[aj("Basic Info",q,"fa-box","text-blue-400"),aj("Pricing",r,"fa-dollar-sign","text-emerald-400"),aj("Inventory",s,"fa-warehouse","text-amber-400"),aj("Supplier",t,"fa-truck-loading","text-purple-400")]}),(0,b.jsxs)("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsxs)("h5",{className:"text-sm font-medium text-white mb-3 flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-cog"}),"Import Options"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-slate-400 mb-1",children:"Import Inventory To Location"}),(0,b.jsxs)("select",{value:V,onChange:a=>W(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"-- No inventory records --"}),w.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.type,")"]},a.id))]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:X,onChange:a=>Y(a.target.checked),className:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500"}),(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Create inventory records"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:Z,onChange:a=>$(a.target.checked),className:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500"}),(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Auto-create suppliers"})]})]})]})]}),ag()&&(0,b.jsxs)(e.Button,{onClick:()=>I("preview"),className:"w-full",children:["Preview Import",(0,b.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]}),"preview"===H&&(g=N.slice(0,5).map(a=>{let b={};return Object.entries(P).forEach(([c,d])=>{d&&(b[c]=a[d]||"")}),b}),h=[],i=new Set(A.map(a=>a.sku.toLowerCase())),u=new Set,N.forEach((a,b)=>{let c=P.sku?a[P.sku]:"",d=P.name?a[P.name]:"";c?i.has(c.toLowerCase())?h.push(`Row ${b+2}: SKU "${c}" already exists`):u.has(c.toLowerCase())?h.push(`Row ${b+2}: Duplicate SKU "${c}" in file`):u.add(c.toLowerCase()):h.push(`Row ${b+2}: Missing SKU`),d||h.push(`Row ${b+2}: Missing product name`)}),v=h.slice(0,10),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("button",{onClick:()=>I("mapping"),className:"text-sm text-slate-400 hover:text-white",children:[(0,b.jsx)("i",{className:"fas fa-arrow-left mr-1"}),"Back to mapping"]}),(0,b.jsxs)("span",{className:"text-sm text-slate-400",children:["Ready to import ",(0,b.jsx)("span",{className:"text-white font-medium",children:N.length})," products"]})]}),(0,b.jsxs)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-slate-800",children:(0,b.jsx)("tr",{children:Object.entries(P).filter(([,a])=>a).map(([a])=>(0,b.jsx)("th",{className:"px-3 py-2 text-left text-slate-400 font-medium",children:p[a]||a},a))})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:g.map((a,c)=>(0,b.jsx)("tr",{className:"bg-slate-800/30",children:Object.entries(P).filter(([,a])=>a).map(([c])=>(0,b.jsx)("td",{className:"px-3 py-2 text-white",children:a[c]||"-"},c))},c))})]})}),N.length>5&&(0,b.jsxs)("div",{className:"px-3 py-2 bg-slate-800/50 text-center text-sm text-slate-400",children:["... and ",N.length-5," more rows"]})]}),v.length>0&&(0,b.jsxs)("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4",children:[(0,b.jsxs)("h4",{className:"text-amber-400 font-medium mb-2 flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-exclamation-triangle"}),"Validation Warnings"]}),(0,b.jsxs)("ul",{className:"text-sm text-amber-300/80 space-y-1",children:[v.map((a,c)=>(0,b.jsx)("li",{children:a},c)),10===v.length&&(0,b.jsx)("li",{className:"text-slate-400",children:"... and more"})]})]})]}))]})}a.s(["ImportCSVModal",()=>u],82840)}];

//# sourceMappingURL=components_modals_ImportCSVModal_tsx_9c8ad75e._.js.map