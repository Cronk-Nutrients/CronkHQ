module.exports=[94660,58660,9095,49512,59210,5248,31887,65631,1027,35940,2087,5379,93847,19256,62143,69012,67668,a=>{"use strict";a.i(68726),a.i(49611),a.i(82840);var b=a.i(87924),c=a.i(72131),d=a.i(88736),e=a.i(12466),f=a.i(98263),g=a.i(89697),h=a.i(88860);function i({isOpen:a,onClose:i,editBundle:j}){let{state:k,dispatch:l}=(0,f.useApp)(),{success:m,error:n,warning:o}=(0,g.useToast)(),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("virtual"),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)("discount"),[L,M]=(0,c.useState)("10"),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)("15"),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)("1"),Z=!!j;(0,c.useEffect)(()=>{a&&(j?(q(j.name),s(j.sku),u(j.type),w(j.description||""),y(j.prices.msrp.toString()),A(j.prices.shopify.toString()),C(j.prices.amazon.toString()),E(j.assemblyInstructions||""),G([...j.components]),O(j.compareAtPrices?.shopify?.toString()||""),Q(j.compareAtPrices?.amazon?.toString()||""),K("manual"),M("10"),S("15")):(q(""),s(""),u("virtual"),w(""),y(""),A(""),C(""),O(""),Q(""),S("15"),E(""),G([]),K("discount"),M("10")),U(""),Y("1"))},[a,j]);let $=a=>k.inventory.filter(b=>b.productId===a).reduce((a,b)=>a+b.quantity,0),_=a=>Math.round(100*a)/100,aa=(0,c.useMemo)(()=>{let a=_(F.reduce((a,b)=>{let c=k.products.find(a=>a.id===b.productId);return a+(c?.cost.rolling||0)*b.quantity},0)),b=_(F.reduce((a,b)=>{let c=k.products.find(a=>a.id===b.productId);return a+(c?.prices.msrp||0)*b.quantity},0)),c=_(F.reduce((a,b)=>{let c=k.products.find(a=>a.id===b.productId);return a+(c?.prices.shopify||c?.prices.msrp||0)*b.quantity},0)),d=_(F.reduce((a,b)=>{let c=k.products.find(a=>a.id===b.productId);return a+(c?.prices.amazon||c?.prices.msrp||0)*b.quantity},0)),e=parseFloat(x)||0,f=e>0?_((e-a)/e*100):0,g=_(c-e),h=c>0?_(g/c*100):0,i=F.length>0?Math.min(...F.map(a=>Math.floor($(a.productId)/a.quantity))):0,j="";if(F.length>0){let a=1/0;F.forEach(b=>{let c=Math.floor($(b.productId)/b.quantity);c<a&&(a=c,j=b.productName)})}return{cost:a,margin:f,availableQty:i,limitingComponent:j,compareAtMSRP:b,calcCompareAtShopify:c,calcCompareAtAmazon:d,savings:g,savingsPercent:h}},[F,x,k.products,k.inventory]);(0,c.useEffect)(()=>{if("discount"===J&&aa.calcCompareAtShopify>0){let a=parseFloat(L)||0;y(_(aa.calcCompareAtShopify*(1-a/100)).toFixed(2))}},[J,L,aa.calcCompareAtShopify]),(0,c.useEffect)(()=>{if(aa.calcCompareAtShopify>0&&O(aa.calcCompareAtShopify.toFixed(2)),"discount"===J&&aa.calcCompareAtShopify>0){let a=parseFloat(L)||0;A(_(aa.calcCompareAtShopify*(1-a/100)).toFixed(2))}},[aa.calcCompareAtShopify,J,L]),(0,c.useEffect)(()=>{let a=parseFloat(R)||0;if(aa.calcCompareAtAmazon>0&&Q(_(aa.calcCompareAtAmazon*(1+a/100)).toFixed(2)),"discount"===J&&aa.calcCompareAtAmazon>0){let b=parseFloat(L)||0;C(_(aa.calcCompareAtAmazon*(1-b/100)*(1+a/100)).toFixed(2))}},[aa.calcCompareAtAmazon,J,L,R]);let ab=(0,c.useMemo)(()=>{if(!T.trim())return[];let a=T.toLowerCase();return k.products.filter(b=>(b.name.toLowerCase().includes(a)||b.sku.toLowerCase().includes(a))&&!F.some(a=>a.productId===b.id)).slice(0,8)},[T,k.products,F]),ac=(a,b)=>{b<1||G(c=>c.map(c=>c.productId===a?{...c,quantity:b}:c))},ad=(0,c.useMemo)(()=>!(!p.trim()||!r.trim()||!t||!x||0>=parseFloat(x)||0===F.length||k.bundles.find(a=>a.sku.toLowerCase()===r.toLowerCase()&&a.id!==j?.id)),[p,r,t,x,F,k.bundles,j]);return(0,b.jsx)(d.Modal,{open:a,onClose:i,title:Z?"Edit Bundle":"Create Bundle",subtitle:Z?`Editing ${j?.name}`:"Define a new product bundle",size:"lg",footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>{if(ad){I(!0);try{let a=parseFloat(x)||0,b={id:j?.id||crypto.randomUUID(),name:p.trim(),sku:r.trim().toUpperCase(),type:t,description:v.trim()||void 0,prices:{msrp:a,shopify:parseFloat(z)||a,amazon:parseFloat(B)||a,wholesale:.6*a},compareAtPrices:{msrp:aa.compareAtMSRP,shopify:parseFloat(N)||aa.calcCompareAtShopify,amazon:parseFloat(P)||aa.calcCompareAtAmazon},components:F,assemblyInstructions:"virtual"!==t&&D.trim()||void 0,createdAt:j?.createdAt||new Date,updatedAt:new Date};Z?(l({type:"UPDATE_BUNDLE",payload:b}),m(`Bundle "${p}" updated successfully!`)):(l({type:"ADD_BUNDLE",payload:b}),m(`Bundle "${p}" created successfully!`)),i()}catch(a){n("Failed to save bundle. Please try again.")}finally{I(!1)}}},disabled:H||!ad,children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Saving..."]}):Z?"Save Changes":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-plus mr-2"}),"Create Bundle"]})})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Basic Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Bundle Name *"}),(0,b.jsx)("input",{type:"text",value:p,onChange:a=>q(a.target.value),placeholder:"e.g., Starter Kit",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Bundle SKU *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"text",value:r,onChange:a=>s(a.target.value),placeholder:"e.g., BND-VIR-001",className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),(0,b.jsxs)("button",{type:"button",onClick:()=>{let a="virtual"===t?"VIR":"physical"===t?"PHY":"FBA",b=Math.floor(900*Math.random())+100;s(`BND-${a}-${b}`)},className:"px-3 py-2.5 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg text-sm whitespace-nowrap",children:[(0,b.jsx)("i",{className:"fas fa-magic mr-1"}),"Generate"]})]})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Bundle Type *"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>u("virtual"),className:`p-3 rounded-lg border transition-colors text-left ${"virtual"===t?"bg-blue-500/20 border-blue-500/30 text-blue-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("i",{className:"fas fa-cloud"}),(0,b.jsx)("span",{className:"font-medium",children:"Virtual"})]}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Components deducted on sale"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>u("physical"),className:`p-3 rounded-lg border transition-colors text-left ${"physical"===t?"bg-emerald-500/20 border-emerald-500/30 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("i",{className:"fas fa-box"}),(0,b.jsx)("span",{className:"font-medium",children:"Physical"})]}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Pre-assembled, tracked as unit"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>u("fba_kit"),className:`p-3 rounded-lg border transition-colors text-left ${"fba_kit"===t?"bg-orange-500/20 border-orange-500/30 text-orange-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("i",{className:"fab fa-amazon"}),(0,b.jsx)("span",{className:"font-medium",children:"FBA Kit"})]}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:"Pre-assembled for Amazon FBA"})]})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Description (Optional)"}),(0,b.jsx)("textarea",{value:v,onChange:a=>w(a.target.value),rows:2,placeholder:"Brief description of the bundle...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Pricing"}),F.length>0&&aa.calcCompareAtShopify>0&&(0,b.jsxs)("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-tags text-blue-400"}),(0,b.jsx)("span",{className:"text-sm text-slate-300",children:"Compare At Price:"})]}),(0,b.jsx)("span",{className:"text-lg font-bold text-blue-400",children:(0,h.formatCurrency)(aa.calcCompareAtShopify)})]}),(0,b.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:"Total if items purchased separately. Updates Shopify's compare_at_price field."}),parseFloat(x)>0&&aa.savings>0&&(0,b.jsxs)("div",{className:"mt-2 flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Customer saves:"}),(0,b.jsxs)("span",{className:"text-emerald-400 font-medium",children:[(0,h.formatCurrency)(aa.savings)," (",aa.savingsPercent.toFixed(0),"% off)"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>K("discount"),className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${"discount"===J?"bg-emerald-500/20 border border-emerald-500/30 text-emerald-400":"bg-slate-800 border border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsx)("i",{className:"fas fa-percent mr-2"}),"Set by Discount %"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>K("manual"),className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${"manual"===J?"bg-emerald-500/20 border border-emerald-500/30 text-emerald-400":"bg-slate-800 border border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsx)("i",{className:"fas fa-pen mr-2"}),"Set Manually"]})]}),"discount"===J&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Bundle Discount"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("input",{type:"range",min:"0",max:"50",step:"5",value:L,onChange:a=>M(a.target.value),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-slate-500 mt-1",children:[(0,b.jsx)("span",{children:"0%"}),(0,b.jsx)("span",{children:"10%"}),(0,b.jsx)("span",{children:"20%"}),(0,b.jsx)("span",{children:"30%"}),(0,b.jsx)("span",{children:"40%"}),(0,b.jsx)("span",{children:"50%"})]})]}),(0,b.jsxs)("div",{className:"relative w-24",children:[(0,b.jsx)("input",{type:"number",min:"0",max:"100",step:"1",value:L,onChange:a=>M(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg pl-3 pr-8 py-2 text-white text-center focus:outline-none focus:border-emerald-500/50"}),(0,b.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:"%"})]})]}),F.length>0&&aa.calcCompareAtShopify>0&&(0,b.jsxs)("div",{className:"mt-2 text-sm text-slate-400",children:["Current Price: ",(0,b.jsx)("span",{className:"text-white font-medium",children:(0,h.formatCurrency)(parseFloat(x)||0)})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-sm text-slate-400 mb-1.5",children:["Current Price (MSRP) *","discount"===J&&(0,b.jsx)("span",{className:"text-xs text-emerald-400 ml-1",children:"(auto-calculated)"})]}),(0,b.jsxs)("div",{className:"relative max-w-xs",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:x,onChange:a=>{y(a.target.value),"discount"===J&&K("manual")},placeholder:"0.00",className:`w-full bg-slate-800 border rounded-lg pl-8 pr-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 ${"discount"===J?"border-emerald-500/30":"border-slate-700"}`})]}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"The actual selling price. Updates Shopify's price field."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-slate-800/50 border border-slate-700/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)("i",{className:"fab fa-shopify text-green-400"}),(0,b.jsx)("span",{className:"text-sm font-medium text-white",children:"Shopify"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-slate-400 mb-1",children:"Compare At Price"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:N,onChange:a=>O(a.target.value),placeholder:aa.calcCompareAtShopify.toFixed(2),className:"w-full bg-slate-700 border border-slate-600 rounded-lg pl-7 pr-3 py-2 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-green-500/50"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs text-slate-400 mb-1",children:"Current Price"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:z,onChange:a=>A(a.target.value),placeholder:"Same as MSRP",className:"w-full bg-slate-700 border border-slate-600 rounded-lg pl-7 pr-3 py-2 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-green-500/50"})]})]})]})]}),(0,b.jsxs)("div",{className:"p-4 bg-slate-800/50 border border-slate-700/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fab fa-amazon text-orange-400"}),(0,b.jsx)("span",{className:"text-sm font-medium text-white",children:"Amazon"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs text-slate-400",children:"Markup:"}),(0,b.jsxs)("div",{className:"relative w-20",children:[(0,b.jsx)("input",{type:"number",min:"0",max:"100",step:"1",value:R,onChange:a=>S(a.target.value),className:"w-full bg-slate-700 border border-orange-500/30 rounded pl-2 pr-6 py-1 text-white text-sm text-center focus:outline-none focus:border-orange-500/50"}),(0,b.jsx)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-orange-400 text-xs",children:"%"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-xs text-slate-400 mb-1",children:["Compare At Price",(0,b.jsxs)("span",{className:"text-orange-400 ml-1",children:["(+",R,"%)"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:P,onChange:a=>Q(a.target.value),placeholder:aa.calcCompareAtAmazon.toFixed(2),className:"w-full bg-slate-700 border border-slate-600 rounded-lg pl-7 pr-3 py-2 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-orange-500/50"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-xs text-slate-400 mb-1",children:["Current Price",(0,b.jsxs)("span",{className:"text-orange-400 ml-1",children:["(+",R,"%)"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:B,onChange:a=>C(a.target.value),placeholder:"Same as MSRP",className:"w-full bg-slate-700 border border-slate-600 rounded-lg pl-7 pr-3 py-2 text-white placeholder-slate-500 text-sm focus:outline-none focus:border-orange-500/50"})]})]})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Components *"}),(0,b.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),(0,b.jsx)("input",{type:"text",value:T,onChange:a=>{U(a.target.value),W(!0)},onFocus:()=>W(!0),placeholder:"Search products by name or SKU...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg pl-10 pr-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),V&&ab.length>0&&(0,b.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-lg max-h-48 overflow-auto",children:ab.map(a=>{let c=$(a.id);return(0,b.jsxs)("button",{type:"button",onClick:()=>(a=>{let b=k.products.find(b=>b.id===a);if(!b)return;let c=parseInt(X)||1;G(a=>[...a,{productId:b.id,productName:b.name,quantity:c}]),U(""),Y("1"),W(!1)})(a.id),className:"w-full px-4 py-2.5 flex items-center justify-between hover:bg-slate-700/50 text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-slate-400",children:["SKU: ",a.sku]})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsxs)("div",{className:`text-sm ${c>0?"text-emerald-400":"text-red-400"}`,children:[(0,h.formatNumber)(c)," available"]})})]},a.id)})})]}),(0,b.jsx)("input",{type:"number",min:"1",value:X,onChange:a=>Y(a.target.value),className:"w-20 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2.5 text-white text-center focus:outline-none focus:border-emerald-500/50",placeholder:"Qty"})]}),F.length>0?(0,b.jsx)("div",{className:"space-y-2 mb-4",children:F.map(a=>{let c=k.products.find(b=>b.id===a.productId),d=$(a.productId),e=d<a.quantity,f=(c?.prices.msrp||0)*a.quantity;return(0,b.jsxs)("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${e?"bg-red-500/10 border-red-500/30":"bg-slate-800/50 border-slate-700/50"}`,children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center",children:(0,b.jsx)("i",{className:"fas fa-flask text-emerald-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm text-white truncate",children:a.productName}),(0,b.jsxs)("div",{className:"text-xs text-slate-400",children:[(0,h.formatNumber)(d)," available â€¢ MSRP: ",(0,h.formatCurrency)(c?.prices.msrp||0)," each",e&&(0,b.jsxs)("span",{className:"text-red-400 ml-2",children:[(0,b.jsx)("i",{className:"fas fa-exclamation-triangle mr-1"}),"Insufficient stock"]})]})]}),(0,b.jsxs)("div",{className:"text-right mr-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-blue-400",children:(0,h.formatCurrency)(f)}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"subtotal"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>ac(a.productId,a.quantity-1),className:"w-8 h-8 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded",children:"-"}),(0,b.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:b=>ac(a.productId,parseInt(b.target.value)||1),className:"w-16 bg-slate-700 border border-slate-600 rounded-lg px-2 py-1.5 text-white text-center text-sm"}),(0,b.jsx)("button",{type:"button",onClick:()=>ac(a.productId,a.quantity+1),className:"w-8 h-8 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded",children:"+"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.productId,void G(a=>a.filter(a=>a.productId!==b))},className:"p-2 text-slate-500 hover:text-red-400",children:(0,b.jsx)("i",{className:"fas fa-trash"})})]},a.productId)})}):(0,b.jsxs)("div",{className:"p-6 border-2 border-dashed border-slate-700 rounded-lg text-center text-slate-400 mb-4",children:[(0,b.jsx)("i",{className:"fas fa-cubes text-2xl mb-2"}),(0,b.jsx)("p",{children:"No components added yet"}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Search for products above to add them"})]}),F.length>0&&(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Bundle Cost"}),(0,b.jsx)("div",{className:"text-lg font-bold text-white",children:(0,h.formatCurrency)(aa.cost)})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Margin"}),(0,b.jsxs)("div",{className:`text-lg font-bold ${aa.margin>=50?"text-emerald-400":aa.margin>=30?"text-amber-400":"text-red-400"}`,children:[aa.margin.toFixed(1),"%"]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Can Build"}),(0,b.jsx)("div",{className:`text-lg font-bold ${aa.availableQty>10?"text-emerald-400":aa.availableQty>0?"text-amber-400":"text-red-400"}`,children:(0,h.formatNumber)(aa.availableQty)}),aa.limitingComponent&&aa.availableQty<10&&(0,b.jsxs)("div",{className:"text-xs text-slate-500 truncate",children:["Limited by: ",aa.limitingComponent]})]})]})]}),"virtual"!==t&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Assembly Instructions"}),(0,b.jsx)("textarea",{value:D,onChange:a=>E(a.target.value),rows:3,placeholder:"Instructions for assembling this bundle...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]})]})})}a.s(["BundleModal",()=>i],58660);var j=a.i(57581);function k({isOpen:a,onClose:i,bundle:k,onEdit:l}){let{state:m,dispatch:n}=(0,f.useApp)(),{success:o}=(0,g.useToast)(),p=(0,j.useConfirm)(),q=a=>m.inventory.filter(b=>b.productId===a).reduce((a,b)=>a+b.quantity,0),r=(0,c.useMemo)(()=>{if(!k)return{cost:0,margin:0,availableQty:0,limitingComponent:""};let a=k.components.reduce((a,b)=>{let c=m.products.find(a=>a.id===b.productId);return a+(c?.cost.rolling||0)*b.quantity},0),b=k.prices.msrp>0?(k.prices.msrp-a)/k.prices.msrp*100:0,c=k.components.length>0?Math.min(...k.components.map(a=>Math.floor(q(a.productId)/a.quantity))):0,d="";if(k.components.length>0){let a=1/0;k.components.forEach(b=>{let c=Math.floor(q(b.productId)/b.quantity);c<a&&(a=c,d=b.productName)})}return{cost:a,margin:b,availableQty:c,limitingComponent:d}},[k,m.products,m.inventory]),s=async()=>{!k||await p({title:"Delete Bundle",message:`Are you sure you want to delete "${k.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",destructive:!0})&&(n({type:"DELETE_BUNDLE",payload:k.id}),o(`Bundle "${k.name}" deleted`),i())};return k?(0,b.jsx)(d.Modal,{open:a,onClose:i,title:k.name,subtitle:`SKU: ${k.sku}`,size:"lg",footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Button,{variant:"secondary",onClick:s,children:[(0,b.jsx)("i",{className:"fas fa-trash mr-2"}),"Delete"]}),(0,b.jsxs)(e.Button,{onClick:l,children:[(0,b.jsx)("i",{className:"fas fa-edit mr-2"}),"Edit Bundle"]})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(a=>{switch(a){case"virtual":return(0,b.jsxs)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full border border-blue-500/20",children:[(0,b.jsx)("i",{className:"fas fa-cloud mr-1"}),"Virtual"]});case"physical":return(0,b.jsxs)("span",{className:"px-2 py-1 bg-emerald-500/20 text-emerald-400 text-xs rounded-full border border-emerald-500/20",children:[(0,b.jsx)("i",{className:"fas fa-box mr-1"}),"Physical"]});case"fba_kit":return(0,b.jsxs)("span",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs rounded-full border border-orange-500/20",children:[(0,b.jsx)("i",{className:"fab fa-amazon mr-1"}),"FBA Kit"]})}})(k.type),(0,b.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${r.availableQty>10?"bg-emerald-500/10 text-emerald-400":r.availableQty>0?"bg-amber-500/10 text-amber-400":"bg-red-500/10 text-red-400"}`,children:r.availableQty>10?"In Stock":r.availableQty>0?"Limited":"Out of Stock"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400",children:"Can Build"}),(0,b.jsx)("div",{className:`text-2xl font-bold ${r.availableQty>10?"text-emerald-400":r.availableQty>0?"text-amber-400":"text-red-400"}`,children:(0,h.formatNumber)(r.availableQty)})]})]}),k.description&&(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-slate-300 text-sm",children:k.description})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Pricing"}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"MSRP"}),(0,b.jsx)("div",{className:"text-lg font-bold text-white",children:(0,h.formatCurrency)(k.prices.msrp)})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Shopify"}),(0,b.jsx)("div",{className:"text-lg font-bold text-white",children:(0,h.formatCurrency)(k.prices.shopify)})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Amazon"}),(0,b.jsx)("div",{className:"text-lg font-bold text-white",children:(0,h.formatCurrency)(k.prices.amazon)})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Wholesale"}),(0,b.jsx)("div",{className:"text-lg font-bold text-white",children:(0,h.formatCurrency)(k.prices.wholesale)})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Cost & Margin"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Component Cost"}),(0,b.jsx)("div",{className:"text-xl font-bold text-white",children:(0,h.formatCurrency)(r.cost)})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Profit per Bundle"}),(0,b.jsx)("div",{className:"text-xl font-bold text-emerald-400",children:(0,h.formatCurrency)(k.prices.msrp-r.cost)})]}),(0,b.jsxs)("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-lg p-4 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:"Margin"}),(0,b.jsxs)("div",{className:"text-xl font-bold text-emerald-400",children:[r.margin.toFixed(1),"%"]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-white mb-3",children:["Components (",k.components.length,")"]}),(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-left text-xs text-slate-400 uppercase",children:[(0,b.jsx)("th",{className:"px-4 py-3 font-medium",children:"Product"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Qty per Bundle"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-right",children:"Available Stock"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-right",children:"Unit Cost"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-right",children:"Line Total"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:k.components.map(a=>{let c=m.products.find(b=>b.id===a.productId),d=q(a.productId),e=c?.cost.rolling||0,f=e*a.quantity,g=d<a.quantity;return(0,b.jsxs)("tr",{className:"hover:bg-slate-700/30",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${g?"bg-red-400":"bg-emerald-400"}`}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.productName}),(0,b.jsx)("div",{className:"text-xs text-slate-400",children:c?.sku||"Unknown SKU"})]})]})}),(0,b.jsxs)("td",{className:"px-4 py-3 text-center text-white",children:["x ",a.quantity]}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsxs)("span",{className:g?"text-red-400":"text-slate-300",children:[(0,h.formatNumber)(d),g&&(0,b.jsx)("i",{className:"fas fa-exclamation-triangle ml-1 text-xs"})]})}),(0,b.jsx)("td",{className:"px-4 py-3 text-right text-slate-400",children:(0,h.formatCurrency)(e)}),(0,b.jsx)("td",{className:"px-4 py-3 text-right text-white",children:(0,h.formatCurrency)(f)})]},a.productId)})}),(0,b.jsx)("tfoot",{className:"bg-slate-800/30 border-t border-slate-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{colSpan:4,className:"px-4 py-3 text-right text-sm font-medium text-slate-400",children:"Total Component Cost:"}),(0,b.jsx)("td",{className:"px-4 py-3 text-right text-lg font-bold text-white",children:(0,h.formatCurrency)(r.cost)})]})})]})}),r.availableQty<10&&r.limitingComponent&&(0,b.jsx)("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-400 text-sm",children:[(0,b.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,b.jsxs)("span",{children:["Limiting component: ",(0,b.jsx)("strong",{children:r.limitingComponent})]})]})})]}),"virtual"!==k.type&&k.assemblyInstructions&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Assembly Instructions"}),(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-slate-300 text-sm whitespace-pre-wrap",children:k.assemblyInstructions})})]})]})}):null}a.s(["BundleDetailModal",()=>k],9095),a.i(57236);let l=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],m=["US","CA","MX","UK","AU"];function n({isOpen:a,onClose:i,order:j}){let{state:k,dispatch:n}=(0,f.useApp)(),{success:o,error:p}=(0,g.useToast)(),[q,r]=(0,c.useState)("customer"),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)("US"),[I,J]=(0,c.useState)(!0),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)("US"),[U,V]=(0,c.useState)([]),[W,X]=(0,c.useState)("0"),[Y,Z]=(0,c.useState)("0"),[$,_]=(0,c.useState)("0"),[aa,ab]=(0,c.useState)("");(0,c.useEffect)(()=>{a&&j&&(t(j.customer.name),v(j.customer.email),x(j.customer.phone||""),z(j.customer.address.street),B(j.customer.address.city),D(j.customer.address.state),F(j.customer.address.zip),H(j.customer.address.country),j.billingAddress?(J(!1),L(j.billingAddress.street),N(j.billingAddress.city),P(j.billingAddress.state),R(j.billingAddress.zip),T(j.billingAddress.country)):J(!0),V(j.items.map(a=>({productId:a.productId,productName:a.productName,sku:a.sku,quantity:a.quantity,price:a.price,cost:a.cost}))),X(j.shipping.toString()),Z(j.tax.toString()),_(j.discount.toString()),ab(j.notes||""))},[a,j]);let ac=(0,c.useMemo)(()=>U.reduce((a,b)=>a+b.price*b.quantity,0),[U]),ad=(0,c.useMemo)(()=>U.reduce((a,b)=>a+b.cost*b.quantity,0),[U]),ae=(0,c.useMemo)(()=>ac+parseFloat(W||"0")+parseFloat(Y||"0")-parseFloat($||"0"),[ac,W,Y,$]),af=ae-ad,ag=ae>0?af/ae*100:0,ah=(a,b)=>{V(c=>c.map((c,d)=>d===a?{...c,quantity:Math.max(1,b)}:c))};return(0,b.jsx)(d.Modal,{open:a,onClose:i,title:`Edit Order #${j.orderNumber}`,size:"xl",children:(0,b.jsxs)("div",{className:"flex flex-col h-[600px]",children:[(0,b.jsx)("div",{className:"flex border-b border-slate-700 mb-4",children:[{id:"customer",label:"Customer",icon:"fa-user"},{id:"shipping",label:"Shipping",icon:"fa-truck"},{id:"billing",label:"Billing",icon:"fa-credit-card"},{id:"items",label:"Items",icon:"fa-box"},{id:"notes",label:"Notes",icon:"fa-sticky-note"}].map(a=>(0,b.jsxs)("button",{onClick:()=>r(a.id),className:`px-4 py-2 text-sm font-medium transition-colors flex items-center gap-2 ${q===a.id?"text-emerald-400 border-b-2 border-emerald-400":"text-slate-400 hover:text-white"}`,children:[(0,b.jsx)("i",{className:`fas ${a.icon}`}),a.label]},a.id))}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["customer"===q&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Customer Name *"}),(0,b.jsx)("input",{type:"text",value:s,onChange:a=>t(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"John Doe"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Email *"}),(0,b.jsx)("input",{type:"email",value:u,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"john@example.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Phone"}),(0,b.jsx)("input",{type:"tel",value:w,onChange:a=>x(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"+1 555-0123"})]})]})]}),"shipping"===q&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Street Address *"}),(0,b.jsx)("input",{type:"text",value:y,onChange:a=>z(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"123 Main St"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"City *"}),(0,b.jsx)("input",{type:"text",value:A,onChange:a=>B(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"Houston"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"State *"}),(0,b.jsxs)("select",{value:C,onChange:a=>D(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"Select state"}),l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"ZIP Code *"}),(0,b.jsx)("input",{type:"text",value:E,onChange:a=>F(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",placeholder:"77001"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Country"}),(0,b.jsx)("select",{value:G,onChange:a=>H(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",children:m.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-slate-700",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Shipping Cost"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-2 text-slate-400",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:W,onChange:a=>X(a.target.value),className:"w-full pl-7 pr-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500"})]})]})})]}),"billing"===q&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:I,onChange:a=>J(a.target.checked),className:"rounded bg-slate-700 border-slate-600 text-emerald-500 focus:ring-emerald-500"}),(0,b.jsx)("span",{className:"text-slate-300",children:"Same as shipping address"})]}),!I&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Street Address"}),(0,b.jsx)("input",{type:"text",value:K,onChange:a=>L(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"City"}),(0,b.jsx)("input",{type:"text",value:M,onChange:a=>N(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"State"}),(0,b.jsxs)("select",{value:O,onChange:a=>P(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"Select state"}),l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"ZIP Code"}),(0,b.jsx)("input",{type:"text",value:Q,onChange:a=>R(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Country"}),(0,b.jsx)("select",{value:S,onChange:a=>T(a.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",children:m.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]})]})]})]}),"items"===q&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Add Product"}),(0,b.jsxs)("select",{onChange:a=>{a.target.value&&((a=>{let b=k.products.find(b=>b.id===a);if(!b)return;let c=U.findIndex(b=>b.productId===a);c>=0?ah(c,U[c].quantity+1):V(a=>[...a,{productId:b.id,productName:b.name,sku:b.sku,quantity:1,price:b.prices.shopify,cost:b.cost.rolling}])})(a.target.value),a.target.value="")},className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"Select product to add..."}),k.products.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.sku,")"]},a.id))]})]}),(0,b.jsx)("div",{className:"space-y-2",children:U.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-800/50 border border-slate-700 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-white",children:a.productName}),(0,b.jsx)("div",{className:"text-xs text-slate-400",children:a.sku})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-xs text-slate-400",children:"Qty:"}),(0,b.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:a=>ah(c,parseInt(a.target.value)||1),className:"w-16 px-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm text-center"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-xs text-slate-400",children:"Price:"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-2 top-1 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:a.price,onChange:a=>{var b;return b=parseFloat(a.target.value)||0,void V(a=>a.map((a,d)=>d===c?{...a,price:Math.max(0,b)}:a))},className:"w-20 pl-5 pr-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm text-right"})]})]}),(0,b.jsx)("div",{className:"text-sm font-medium text-white w-20 text-right",children:(0,h.formatCurrency)(a.price*a.quantity)}),(0,b.jsx)("button",{onClick:()=>{U.length<=1?p("Order must have at least one item"):V(a=>a.filter((a,b)=>b!==c))},className:"p-1 text-slate-400 hover:text-red-400",children:(0,b.jsx)("i",{className:"fas fa-trash text-sm"})})]},c))}),(0,b.jsxs)("div",{className:"pt-4 border-t border-slate-700 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Subtotal"}),(0,b.jsx)("span",{className:"text-white",children:(0,h.formatCurrency)(ac)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm items-center",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Tax"}),(0,b.jsxs)("div",{className:"relative w-24",children:[(0,b.jsx)("span",{className:"absolute left-2 top-1 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:Y,onChange:a=>Z(a.target.value),className:"w-full pl-5 pr-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm text-right"})]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm items-center",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Discount"}),(0,b.jsxs)("div",{className:"relative w-24",children:[(0,b.jsx)("span",{className:"absolute left-2 top-1 text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:$,onChange:a=>_(a.target.value),className:"w-full pl-5 pr-2 py-1 bg-slate-700 border border-slate-600 rounded text-white text-sm text-right"})]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-lg font-bold pt-2 border-t border-slate-600",children:[(0,b.jsx)("span",{className:"text-white",children:"Total"}),(0,b.jsx)("span",{className:"text-white",children:(0,h.formatCurrency)(ae)})]})]})]}),"notes"===q&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Order Notes"}),(0,b.jsx)("textarea",{value:aa,onChange:a=>ab(a.target.value),rows:6,className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-emerald-500 resize-none",placeholder:"Internal notes about this order..."})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700 mt-4",children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:()=>{if(!s.trim())return void p("Customer name is required");if(!u.trim())return void p("Customer email is required");if(0===U.length)return void p("Order must have at least one item");let a={...j,customer:{name:s,email:u,phone:w||void 0,address:{street:y,city:A,state:C,zip:E,country:G}},billingAddress:I?void 0:{street:K,city:M,state:O,zip:Q,country:S},items:U.map(a=>({...a,picked:j.items.find(b=>b.productId===a.productId)?.picked||!1})),subtotal:ac,shipping:parseFloat(W||"0"),tax:parseFloat(Y||"0"),discount:parseFloat($||"0"),total:ae,cogs:ad,profit:af,margin:ag,notes:aa||void 0,updatedAt:new Date};n({type:"UPDATE_ORDER",payload:a}),o("Order updated successfully"),i()},children:[(0,b.jsx)("i",{className:"fas fa-save mr-2"}),"Save Changes"]})]})]})})}a.s(["EditOrderModal",()=>n],49512);var o=a.i(87532),p=a.i(81560),q=a.i(83497);function r({isOpen:a,onClose:i,editPO:j,initialItems:k}){let{state:l,dispatch:m}=(0,f.useApp)(),{success:n,error:r}=(0,g.useToast)(),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("USD"),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)("0"),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1),Q=!!j,R=(0,c.useMemo)(()=>{let a=new Set;return l.purchaseOrders.forEach(b=>{b.supplier&&a.add(b.supplier)}),l.products.forEach(b=>{b.supplier&&a.add(b.supplier)}),Array.from(a).sort()},[l.purchaseOrders,l.products]),S=(0,c.useMemo)(()=>{if(!M.trim())return R.slice(0,5);let a=M.toLowerCase();return R.filter(b=>b.toLowerCase().includes(a)).slice(0,5)},[M,R]);(0,c.useEffect)(()=>{if(a){if(j)t(j.poNumber),v(j.supplier),x(j.currency),z(j.expectedDate?new Date(j.expectedDate).toISOString().split("T")[0]:""),B(j.notes||""),D(j.shipping.toString()),F([...j.items]);else{let a;t((a=l.purchaseOrders.length+1,`PO-${new Date().getFullYear()}-${a.toString().padStart(4,"0")}`)),v(""),x("USD"),z(""),B(""),D("0"),F(k||[])}J(""),N("")}},[a,j,k]);let T=(0,c.useMemo)(()=>{if(!I.trim())return[];let a=I.toLowerCase();return l.products.filter(b=>(b.name.toLowerCase().includes(a)||b.sku.toLowerCase().includes(a))&&!E.some(a=>a.productId===b.id)).slice(0,8)},[I,l.products,E]),U=(0,c.useMemo)(()=>{let a=E.reduce((a,b)=>a+b.quantity*b.unitCost,0),b=parseFloat(C)||0;return{subtotal:a,shipping:b,total:a+b,itemCount:E.length,unitCount:E.reduce((a,b)=>a+b.quantity,0)}},[E,C]),V=(a,b,c)=>{c<0||F(d=>d.map(d=>d.productId===a?{...d,[b]:c}:d))},W=(0,c.useMemo)(()=>!(!s.trim()||!u.trim()||0===E.length||E.some(a=>a.quantity<=0||a.unitCost<0)),[s,u,E]);return(0,b.jsx)(d.Modal,{open:a,onClose:i,title:Q?"Edit Purchase Order":"Create Purchase Order",subtitle:Q?`Editing ${j?.poNumber}`:"Order inventory from suppliers",size:"xl",footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Cancel"}),(0,b.jsx)(e.Button,{variant:"secondary",onClick:()=>{if(W){H(!0);try{let a={id:j?.id||crypto.randomUUID(),poNumber:s.trim(),supplier:u.trim(),status:"draft",currency:w,expectedDate:y?new Date(y):void 0,items:E,subtotal:U.subtotal,shipping:U.shipping,total:U.total,notes:A.trim()||void 0,createdAt:j?.createdAt||new Date,updatedAt:new Date};Q?(m({type:"UPDATE_PURCHASE_ORDER",payload:a}),n(`PO ${s} updated successfully`)):(m({type:"ADD_PURCHASE_ORDER",payload:a}),n(`PO ${s} saved as draft`)),i()}catch(a){r("Failed to save purchase order")}finally{H(!1)}}},disabled:G||!W,children:"Save as Draft"}),(0,b.jsx)(e.Button,{onClick:()=>{if(W){H(!0);try{let a={id:j?.id||crypto.randomUUID(),poNumber:s.trim(),supplier:u.trim(),status:"sent",currency:w,expectedDate:y?new Date(y):void 0,items:E,subtotal:U.subtotal,shipping:U.shipping,total:U.total,notes:A.trim()||void 0,createdAt:j?.createdAt||new Date,updatedAt:new Date};Q?m({type:"UPDATE_PURCHASE_ORDER",payload:a}):m({type:"ADD_PURCHASE_ORDER",payload:a}),n(`PO ${s} created and marked as sent`),i()}catch(a){r("Failed to create purchase order")}finally{H(!1)}}},disabled:G||!W,children:G?"Saving...":Q?"Save Changes":"Create & Send"})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"PO Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"PO Number *"}),(0,b.jsx)("input",{type:"text",value:s,onChange:a=>t(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white font-mono focus:outline-none focus:border-emerald-500/50"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Supplier *"}),(0,b.jsx)("input",{type:"text",value:u,onChange:a=>{v(a.target.value),N(a.target.value),P(!0)},onFocus:()=>P(!0),onBlur:()=>setTimeout(()=>P(!1),200),placeholder:"Enter supplier name",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),O&&S.length>0&&(0,b.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-lg max-h-40 overflow-auto",children:S.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{v(a),P(!1)},className:"w-full px-4 py-2 text-left text-sm text-white hover:bg-slate-700/50",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Currency"}),(0,b.jsxs)("select",{value:w,onChange:a=>x(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"USD",children:"USD ($)"}),(0,b.jsx)("option",{value:"CAD",children:"CAD (C$)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Expected Date"}),(0,b.jsx)("input",{type:"date",value:y,onChange:a=>z(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Line Items *"}),(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,b.jsx)("input",{type:"text",value:I,onChange:a=>{J(a.target.value),L(!0)},onFocus:()=>L(!0),placeholder:"Search products by name or SKU...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg pl-10 pr-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),K&&T.length>0&&(0,b.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-lg max-h-48 overflow-auto",children:T.map(a=>{let c,d=(c=a.id,l.inventory.filter(a=>a.productId===c).reduce((a,b)=>a+b.quantity,0));return(0,b.jsxs)("button",{type:"button",onClick:()=>{var b;let c;return b=a.id,void((c=l.products.find(a=>a.id===b))&&(F(a=>[...a,{productId:c.id,productName:c.name,sku:c.sku,quantity:1,receivedQty:0,unitCost:c.cost.rolling}]),J(""),L(!1)))},className:"w-full px-4 py-2.5 flex items-center justify-between hover:bg-slate-700/50 text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-slate-400",children:["SKU: ",a.sku]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm text-slate-300",children:(0,h.formatCurrencyPrecise)(a.cost.rolling)}),(0,b.jsxs)("div",{className:`text-xs ${d<=a.reorderPoint?"text-amber-400":"text-slate-400"}`,children:[(0,h.formatNumber)(d)," in stock"]})]})]},a.id)})})]}),E.length>0?(0,b.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Product"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"SKU"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Qty"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:"Unit Cost"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:"Line Total"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center w-12"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:E.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-slate-800/30",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white",children:a.productName}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-slate-400 font-mono",children:a.sku}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("input",{type:"number",min:"1",value:a.quantity,onChange:b=>V(a.productId,"quantity",parseInt(b.target.value)||0),className:"w-20 mx-auto block bg-slate-700 border border-slate-600 rounded px-2 py-1 text-white text-center text-sm"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)("span",{className:"text-slate-400 text-sm",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:a.unitCost,onChange:b=>V(a.productId,"unitCost",parseFloat(b.target.value)||0),className:"w-24 bg-slate-700 border border-slate-600 rounded px-2 py-1 text-white text-right text-sm"})]})}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white text-right font-medium",children:(0,h.formatCurrencyPrecise)(a.quantity*a.unitCost)}),(0,b.jsx)("td",{className:"px-4 py-3 text-center",children:(0,b.jsx)("button",{onClick:()=>{var b;return b=a.productId,void F(a=>a.filter(a=>a.productId!==b))},className:"p-1.5 text-slate-400 hover:text-red-400 hover:bg-slate-700 rounded",children:(0,b.jsx)(p.Trash2,{className:"w-4 h-4"})})})]},a.productId))})]})}):(0,b.jsxs)("div",{className:"p-8 border-2 border-dashed border-slate-700 rounded-lg text-center text-slate-400",children:[(0,b.jsx)(q.Package,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No items added yet"}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Search for products above to add them"})]})]}),E.length>0&&(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"w-72 space-y-2 bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Items:"}),(0,b.jsxs)("span",{className:"text-white",children:[U.itemCount," (",(0,h.formatNumber)(U.unitCount)," units)"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Subtotal:"}),(0,b.jsx)("span",{className:"text-white",children:(0,h.formatCurrencyPrecise)(U.subtotal)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Shipping:"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"text-slate-400",children:"$"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:C,onChange:a=>D(a.target.value),className:"w-24 bg-slate-700 border border-slate-600 rounded px-2 py-1 text-white text-right text-sm"})]})]}),(0,b.jsxs)("div",{className:"pt-2 border-t border-slate-700 flex justify-between",children:[(0,b.jsx)("span",{className:"text-white font-medium",children:"Total:"}),(0,b.jsx)("span",{className:"text-white font-bold text-lg",children:(0,h.formatCurrencyPrecise)(U.total)})]}),"CAD"===w&&(0,b.jsx)("div",{className:"text-xs text-slate-500 text-right",children:"CAD values will be converted at current exchange rate"})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:A,onChange:a=>B(a.target.value),rows:2,placeholder:"Optional notes for this PO...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]})]})})}a.s(["CreatePOModal",()=>r],59210);var s=a.i(33441),t=a.i(73570),u=a.i(2835),v=a.i(70106);let w=(0,v.default)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var x=a.i(33508),y=a.i(17545),z=a.i(41675);function A({isOpen:a,onClose:i,po:j}){let{state:k,dispatch:l}=(0,f.useApp)(),{success:m,error:n,warning:o}=(0,g.useToast)(),[p,q]=(0,c.useState)([]),[r,v]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)({}),[G,H]=(0,c.useState)({}),[I,J]=(0,c.useState)({}),[K,L]=(0,c.useState)({}),[M,N]=(0,c.useState)({lotNumber:"",quantity:0});(0,c.useEffect)(()=>{if(a&&j){q(j.items.map(a=>({productId:a.productId,productName:a.productName,sku:a.sku,ordered:a.quantity,previouslyReceived:a.receivedQty,receivingNow:a.quantity-a.receivedQty,condition:"good"}))),v(""),F({}),H({}),J({}),L({}),N({lotNumber:"",quantity:0});let a=k.locations.find(a=>a.isDefault);B(a?.id||k.locations[0]?.id||"")}},[a,j,k.locations]);let O=a=>k.products.find(b=>b.id===a),P=a=>{let b=O(a);return b?.trackSerials===!0},Q=(a,b)=>{b.trim()&&((E[a]||[]).includes(b.trim())?o("Serial number already entered"):(F(c=>({...c,[a]:[...c[a]||[],b.trim()]})),H(b=>({...b,[a]:""}))))},R=a=>{let b=O(a);return b?.trackLots===!0},S=a=>(I[a]||[]).reduce((a,b)=>a+b.quantity,0),T=(0,c.useMemo)(()=>{let a=p.reduce((a,b)=>a+b.ordered,0),b=p.reduce((a,b)=>a+b.previouslyReceived,0),c=p.reduce((a,b)=>a+b.receivingNow,0),d=b+c;return{totalOrdered:a,totalPreviouslyReceived:b,totalReceivingNow:c,totalAfter:d,percentComplete:a>0?d/a*100:0,willBeFullyReceived:d>=a}},[p]),U=(0,c.useMemo)(()=>p.some(a=>"good"!==a.condition&&a.receivingNow>0),[p]);return j?(0,b.jsx)(d.Modal,{open:a,onClose:i,title:"Receive Items",subtitle:`${j.poNumber} from ${j.supplier}`,size:"xl",footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>{if(j&&!(T.totalReceivingNow<=0)){D(!0);try{let a=j.items.map(a=>{let b=p.find(b=>b.productId===a.productId);return{...a,receivedQty:a.receivedQty+(b?.receivingNow||0)}}),b=a.every(a=>a.receivedQty>=a.quantity),c=j.status;b?c="received":a.some(a=>a.receivedQty>0)&&(c="partial");let d={...j,items:a,status:c,updatedAt:new Date};l({type:"UPDATE_PURCHASE_ORDER",payload:d});let e=k.locations.find(a=>a.id===A)?.name||"";p.forEach(a=>{if(a.receivingNow>0&&"good"===a.condition){if(l({type:"ADJUST_STOCK",payload:{productId:a.productId,locationId:A,adjustment:a.receivingNow}}),P(a.productId)){let b=(E[a.productId]||[]).map(b=>({id:crypto.randomUUID(),serial:b,productId:a.productId,productName:a.productName,sku:a.sku,status:"in_stock",locationId:A,locationName:e,purchaseOrderId:j.id,receivedAt:new Date}));b.length>0&&l({type:"ADD_SERIAL_NUMBERS",payload:b})}if(R(a.productId)){let b=(I[a.productId]||[]).map(b=>({id:crypto.randomUUID(),lotNumber:b.lotNumber,productId:a.productId,productName:a.productName,sku:a.sku,quantity:b.quantity,reservedQty:0,expirationDate:b.expirationDate?new Date(b.expirationDate):void 0,manufacturedDate:b.manufacturedDate?new Date(b.manufacturedDate):void 0,receivedDate:new Date,status:"active",locationId:A,locationName:e,purchaseOrderId:j.id,supplierLotNumber:b.supplierLotNumber,notes:b.notes}));b.length>0&&l({type:"ADD_LOTS",payload:b})}}}),U?o(`Received ${(0,h.formatNumber)(T.totalReceivingNow)} units with some issues noted`):b?m(`PO ${j.poNumber} fully received! ${(0,h.formatNumber)(T.totalReceivingNow)} units added to inventory`):m(`Received ${(0,h.formatNumber)(T.totalReceivingNow)} units on PO ${j.poNumber}`),i()}catch(a){n("Failed to receive items")}finally{D(!1)}}},disabled:C||T.totalReceivingNow<=0,children:C?"Processing...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Check,{className:"w-4 h-4"}),"Receive ",(0,h.formatNumber)(T.totalReceivingNow)," Units"]})})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-400",children:"PO Number:"}),(0,b.jsx)("span",{className:"ml-2 text-white font-mono",children:j.poNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Supplier:"}),(0,b.jsx)("span",{className:"ml-2 text-white",children:j.supplier})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Expected:"}),(0,b.jsx)("span",{className:"ml-2 text-white",children:j.expectedDate?(0,h.formatDate)(j.expectedDate):"Not set"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-400",children:"Total Value:"}),(0,b.jsx)("span",{className:"ml-2 text-white font-medium",children:(0,h.formatCurrencyPrecise)(j.total)})]})]})}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-400",children:"Receiving Progress"}),(0,b.jsxs)("span",{className:"text-sm text-white",children:[(0,h.formatNumber)(T.totalAfter)," / ",(0,h.formatNumber)(T.totalOrdered)," units (",T.percentComplete.toFixed(0),"%)"]})]}),(0,b.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,b.jsx)("div",{className:`h-2 rounded-full transition-all ${T.willBeFullyReceived?"bg-emerald-500":"bg-blue-500"}`,style:{width:`${Math.min(T.percentComplete,100)}%`}})}),T.willBeFullyReceived&&(0,b.jsxs)("p",{className:"text-xs text-emerald-400 mt-2",children:[(0,b.jsx)(s.Check,{className:"w-3 h-3 inline mr-1"}),"This will complete the PO"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Receive to Location"}),(0,b.jsx)("select",{value:A,onChange:a=>B(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:k.locations.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white",children:"Items to Receive"}),(0,b.jsx)("button",{onClick:()=>{q(a=>a.map(a=>({...a,receivingNow:a.ordered-a.previouslyReceived,condition:"good"})))},className:"text-sm text-emerald-400 hover:text-emerald-300",children:"Receive All Remaining"})]}),(0,b.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Product"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Ordered"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Previously Received"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Receiving Now"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Condition"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:p.map(a=>{let c,d=a.ordered-a.previouslyReceived,e=d<=0,f=P(a.productId),g=R(a.productId),i=E[a.productId]||[],j=G[a.productId]||"";return(0,b.jsxs)("tr",{className:`${e?"bg-emerald-500/5":"hover:bg-slate-800/30"}`,children:[(0,b.jsxs)("td",{className:"px-4 py-3",colSpan:f&&!e&&a.receivingNow>0?1:void 0,children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.productName}),(0,b.jsxs)("div",{className:"text-xs text-slate-400 font-mono",children:[a.sku,f&&(0,b.jsxs)("span",{className:"ml-2 text-purple-400",children:[(0,b.jsx)(u.Hash,{className:"w-3 h-3 inline"})," Serial Tracked"]}),g&&(0,b.jsxs)("span",{className:"ml-2 text-purple-400",children:[(0,b.jsx)(y.Layers,{className:"w-3 h-3 inline"})," Lot Tracked"]})]}),f&&!e&&a.receivingNow>0&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-slate-800/50 rounded-lg border border-slate-700/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-xs text-slate-400",children:["Serial Numbers (",i.length," / ",a.receivingNow,")"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>((a,b)=>{let c=O(a);if(!c)return;let d=[],e=c.serialNextNumber||1;for(let a=0;a<b;a++){let a=`${c.serialPrefix||""}${String(e).padStart(4,"0")}${c.serialSuffix||""}`;d.push(a),e++}F(b=>({...b,[a]:d})),l({type:"UPDATE_PRODUCT",payload:{...c,serialNextNumber:e,updatedAt:new Date}})})(a.productId,a.receivingNow),className:"text-xs text-emerald-400 hover:text-emerald-300 flex items-center gap-1",children:[(0,b.jsx)(w,{className:"w-3 h-3"}),"Auto-Generate"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",value:j,onChange:b=>H(c=>({...c,[a.productId]:b.target.value})),onKeyDown:b=>{"Enter"===b.key&&(b.preventDefault(),Q(a.productId,j))},placeholder:"Enter or scan serial...",className:"flex-1 bg-slate-700 border border-slate-600 rounded px-3 py-1.5 text-sm text-white placeholder-slate-500 font-mono"}),(0,b.jsx)("button",{type:"button",onClick:()=>Q(a.productId,j),className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm rounded transition-colors",children:"Add"})]}),i.length>0&&(0,b.jsx)("div",{className:"max-h-24 overflow-y-auto space-y-1",children:i.map((c,d)=>(0,b.jsxs)("div",{className:"flex items-center justify-between px-2 py-1 bg-slate-700/50 rounded text-xs",children:[(0,b.jsx)("span",{className:"font-mono text-white",children:c}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.productId,void F(a=>({...a,[b]:(a[b]||[]).filter((a,b)=>b!==d)}))},className:"text-red-400 hover:text-red-300",children:(0,b.jsx)(x.X,{className:"w-3 h-3"})})]},d))}),i.length!==a.receivingNow&&(0,b.jsxs)("div",{className:"mt-2 text-xs text-amber-400 flex items-center gap-1",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-3 h-3"}),i.length<a.receivingNow?`Need ${a.receivingNow-i.length} more serial(s)`:`${i.length-a.receivingNow} extra serial(s)`]})]}),g&&!e&&a.receivingNow>0&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-purple-900/20 rounded-lg border border-purple-500/30",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[(0,b.jsx)(y.Layers,{className:"w-3 h-3 text-purple-400"}),"Lot Numbers (",S(a.productId)," / ",a.receivingNow," units)"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>{N({lotNumber:(a=>{let b=O(a);if(!b)return"";let c=b.lotPrefix||"LOT-",d=new Date().toISOString().slice(0,10).replace(/-/g,""),e=b.lotNextNumber||1;return`${c}${d}-${String(e).padStart(3,"0")}`})(a.productId),quantity:a.receivingNow-S(a.productId)}),L(b=>({...b,[a.productId]:!0}))},className:"text-xs text-purple-400 hover:text-purple-300 flex items-center gap-1",children:[(0,b.jsx)(w,{className:"w-3 h-3"}),"Add Lot"]})]}),(I[a.productId]||[]).map((c,d)=>(0,b.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-700/50 rounded mb-1 text-xs",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-mono text-white",children:c.lotNumber}),(0,b.jsxs)("span",{className:"text-slate-400 ml-2",children:["x",c.quantity]}),c.expirationDate&&(0,b.jsxs)("span",{className:"text-amber-400 ml-2 flex items-center gap-1 inline-flex",children:[(0,b.jsx)(z.Calendar,{className:"w-3 h-3"}),"Exp: ",c.expirationDate]})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.productId,void J(a=>({...a,[b]:(a[b]||[]).filter((a,b)=>b!==d)}))},className:"text-red-400 hover:text-red-300",children:(0,b.jsx)(x.X,{className:"w-3 h-3"})})]},d)),K[a.productId]&&(0,b.jsxs)("div",{className:"mt-2 p-3 bg-slate-800/50 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-400 block mb-1",children:"Lot Number"}),(0,b.jsx)("input",{type:"text",value:M.lotNumber,onChange:a=>N(b=>({...b,lotNumber:a.target.value})),className:"w-full bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-sm text-white font-mono"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-400 block mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",value:M.quantity,onChange:a=>N(b=>({...b,quantity:parseInt(a.target.value)||0})),className:"w-full bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-sm text-white"})]})]}),(c=O(a.productId),c?.expirationTracking===!0&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-400 block mb-1",children:"Expiration Date"}),(0,b.jsx)("input",{type:"date",value:M.expirationDate||"",onChange:a=>N(b=>({...b,expirationDate:a.target.value})),className:"w-full bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-sm text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-400 block mb-1",children:"Manufactured Date"}),(0,b.jsx)("input",{type:"date",value:M.manufacturedDate||"",onChange:a=>N(b=>({...b,manufacturedDate:a.target.value})),className:"w-full bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-sm text-white"})]})]})),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-slate-400 block mb-1",children:"Supplier Lot # (Optional)"}),(0,b.jsx)("input",{type:"text",value:M.supplierLotNumber||"",onChange:a=>N(b=>({...b,supplierLotNumber:a.target.value})),placeholder:"Manufacturer's lot number",className:"w-full bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-sm text-white placeholder-slate-500"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>L(b=>({...b,[a.productId]:!1})),className:"px-3 py-1.5 text-sm text-slate-400 hover:text-white",children:"Cancel"}),(0,b.jsx)("button",{type:"button",onClick:()=>((a,b)=>{if(!b.lotNumber.trim()||b.quantity<=0)return;if((I[a]||[]).some(a=>a.lotNumber===b.lotNumber))return void o("Lot number already exists");J(c=>({...c,[a]:[...c[a]||[],{...b}]}));let c=O(a);c&&l({type:"UPDATE_PRODUCT",payload:{...c,lotNextNumber:(c.lotNextNumber||1)+1,updatedAt:new Date}}),N({lotNumber:"",quantity:0}),L(b=>({...b,[a]:!1}))})(a.productId,M),className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded transition-colors",children:"Add Lot"})]})]}),S(a.productId)!==a.receivingNow&&!K[a.productId]&&(0,b.jsxs)("div",{className:"mt-2 text-xs text-amber-400 flex items-center gap-1",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-3 h-3"}),S(a.productId)<a.receivingNow?`Need ${a.receivingNow-S(a.productId)} more units assigned to lots`:`${S(a.productId)-a.receivingNow} extra units assigned`]})]})]}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-sm text-white align-top",children:(0,h.formatNumber)(a.ordered)}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-sm align-top",children:(0,b.jsx)("span",{className:a.previouslyReceived>0?"text-emerald-400":"text-slate-400",children:(0,h.formatNumber)(a.previouslyReceived)})}),(0,b.jsx)("td",{className:"px-4 py-3 align-top",children:e?(0,b.jsxs)("div",{className:"text-center text-sm text-emerald-400",children:[(0,b.jsx)(s.Check,{className:"w-4 h-4 inline mr-1"}),"Complete"]}):(0,b.jsx)("input",{type:"number",min:"0",max:d,value:a.receivingNow,onChange:b=>{var c,d;return c=a.productId,d=parseInt(b.target.value)||0,void q(a=>a.map(a=>{if(a.productId===c){let b=Math.max(0,Math.min(d,a.ordered-a.previouslyReceived));return{...a,receivingNow:b}}return a}))},className:"w-20 mx-auto block bg-slate-700 border border-slate-600 rounded px-2 py-1.5 text-white text-center text-sm"})}),(0,b.jsx)("td",{className:"px-4 py-3 align-top",children:!e&&a.receivingNow>0&&(0,b.jsxs)("select",{value:a.condition,onChange:b=>{var c,d;return c=a.productId,d=b.target.value,void q(a=>a.map(a=>a.productId===c?{...a,condition:d}:a))},className:`w-full bg-slate-700 border rounded px-2 py-1.5 text-sm ${"good"===a.condition?"border-slate-600 text-white":"border-amber-500/50 text-amber-400"}`,children:[(0,b.jsx)("option",{value:"good",children:"Good"}),(0,b.jsx)("option",{value:"damaged",children:"Damaged"}),(0,b.jsx)("option",{value:"wrong_item",children:"Wrong Item"}),(0,b.jsx)("option",{value:"short",children:"Short"})]})})]},a.productId)})})]})})]}),U&&(0,b.jsxs)("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-amber-400",children:"Issues Noted"}),(0,b.jsx)("div",{className:"text-sm text-slate-300 mt-1",children:"Some items are marked with condition issues. Items marked as damaged, wrong item, or short will still be received but the issues will be logged."})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Receiving Notes (Optional)"}),(0,b.jsx)("textarea",{value:r,onChange:a=>v(a.target.value),rows:2,placeholder:"Note any issues, discrepancies, or special handling...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]})]})}):null}function B({isOpen:a,onClose:i,editWO:j}){let{state:k,dispatch:l}=(0,f.useApp)(),{success:m,error:n}=(0,g.useToast)(),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[u,v]=(0,c.useState)("bundle"),[w,x]=(0,c.useState)("1"),[y,z]=(0,c.useState)("normal"),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),G=!!j,H=a=>k.inventory.filter(b=>b.productId===a).reduce((a,b)=>a+b.quantity,0);(0,c.useMemo)(()=>"bundle"===u?k.bundles.find(a=>a.id===q):k.products.find(a=>a.id===q),[q,u,k.bundles,k.products]);let I=(0,c.useMemo)(()=>{let a=parseInt(w)||0;if(!q||a<=0)return[];if("bundle"===u){let b=k.bundles.find(a=>a.id===q);return b?b.components.map(b=>{let c=k.products.find(a=>a.id===b.productId),d=H(b.productId),e=b.quantity*a;return{productId:b.productId,productName:b.productName||c?.name||"Unknown",sku:c?.sku||"",quantityRequired:e,quantityAvailable:d,isShort:d<e,shortBy:Math.max(0,e-d)}}):[]}let b=k.products.find(a=>a.id===q);return b?.components&&0!==b.components.length?b.components.map(b=>{let c=k.products.find(a=>a.id===b.productId),d=H(b.productId),e=b.quantity*a;return{productId:b.productId,productName:b.productName||c?.name||"Unknown",sku:c?.sku||"",quantityRequired:e,quantityAvailable:d,isShort:d<e,shortBy:Math.max(0,e-d)}}):[]},[q,u,w,k.bundles,k.products,k.inventory]),J=(0,c.useMemo)(()=>{if(0===I.length)return{canProduce:!0,maxProducible:parseInt(w)||0,shortComponents:[]};let a=I.filter(a=>a.isShort),b=0===a.length,c=1/0;return I.forEach(a=>{let b=a.quantityRequired/(parseInt(w)||1),d=Math.floor(a.quantityAvailable/b);c=Math.min(c,d)}),c===1/0&&(c=parseInt(w)||0),{canProduce:b,maxProducible:c,shortComponents:a}},[I,w]);(0,c.useEffect)(()=>{if(a)if(j)p(j.woNumber),r(j.outputProductId),x(j.quantityToProduce.toString()),z(j.priority),B(j.dueDate?new Date(j.dueDate).toISOString().split("T")[0]:""),D(j.notes||""),v(k.bundles.some(a=>a.id===j.outputProductId)?"bundle":"product");else{let a;p((a=k.workOrders.length+1,`WO-${a.toString().padStart(4,"0")}`)),r(""),v("bundle"),x("1"),z("normal"),B(""),D("")}},[a,j,k.bundles]);let K=(0,c.useMemo)(()=>!(!o.trim()||!q||!w||0>=parseInt(w)),[o,q,w]);return(0,b.jsx)(d.Modal,{open:a,onClose:i,title:G?"Edit Work Order":"Create Work Order",subtitle:G?`Editing ${j?.woNumber}`:"Schedule a production or assembly task",size:"lg",footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:()=>{if(K){F(!0);try{let a=parseInt(w)||0,b="bundle"===u?k.bundles.find(a=>a.id===q)?.name:k.products.find(a=>a.id===q)?.name,c=I.map(a=>({productId:a.productId,productName:a.productName,quantityRequired:a.quantityRequired,quantityUsed:0})),d={id:j?.id||crypto.randomUUID(),woNumber:o.trim(),status:j?.status||"pending",outputProductId:q,outputProductName:b||"",quantityToProduce:a,quantityProduced:j?.quantityProduced||0,priority:y,dueDate:A?new Date(A):void 0,components:c,notes:C.trim()||void 0,startedAt:j?.startedAt,completedAt:j?.completedAt,createdAt:j?.createdAt||new Date};G?(l({type:"UPDATE_WORK_ORDER",payload:d}),m(`Work Order ${o} updated`)):(l({type:"ADD_WORK_ORDER",payload:d}),m(`Work Order ${o} created`)),i()}catch(a){n("Failed to save work order")}finally{F(!1)}}},disabled:E||!K,children:E?"Saving...":G?"Save Changes":"Create Work Order"})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Work Order Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"WO Number"}),(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white font-mono focus:outline-none focus:border-emerald-500/50",readOnly:G})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Priority"}),(0,b.jsxs)("select",{value:y,onChange:a=>z(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"normal",children:"Normal"}),(0,b.jsx)("option",{value:"high",children:"High"}),(0,b.jsx)("option",{value:"urgent",children:"Urgent"})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Output Product"}),(0,b.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{v("bundle"),r("")},className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${"bundle"===u?"bg-emerald-500/20 border-emerald-500/30 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Bundle Assembly"}),(0,b.jsx)("button",{type:"button",onClick:()=>{v("product"),r("")},className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${"product"===u?"bg-emerald-500/20 border-emerald-500/30 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:"Product Manufacturing"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm text-slate-400 mb-1.5",children:["bundle"===u?"Select Bundle":"Select Product"," *"]}),(0,b.jsxs)("select",{value:q,onChange:a=>r(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsxs)("option",{value:"",children:["Select ",u,"..."]}),"bundle"===u?k.bundles.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.sku,")"]},a.id)):k.products.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.sku,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Quantity to Produce *"}),(0,b.jsx)("input",{type:"number",min:"1",value:w,onChange:a=>x(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"})]})]})]}),q&&"bundle"===u&&I.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Bill of Materials"}),(0,b.jsx)("div",{className:`mb-4 p-3 rounded-lg border ${J.canProduce?"bg-emerald-500/10 border-emerald-500/30":"bg-amber-500/10 border-amber-500/30"}`,children:J.canProduce?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-emerald-400",children:[(0,b.jsx)(s.Check,{className:"w-5 h-5"}),(0,b.jsxs)("span",{className:"text-sm",children:["Sufficient stock for ",(0,h.formatNumber)(parseInt(w)||0)," units"]})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-400",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-5 h-5"}),(0,b.jsxs)("span",{className:"text-sm",children:["Can only produce ",(0,h.formatNumber)(J.maxProducible)," units with current stock"]})]})}),(0,b.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Component"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"SKU"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Needed"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Available"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Status"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:I.map(a=>(0,b.jsxs)("tr",{className:a.isShort?"bg-amber-500/5":"",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white",children:a.productName}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-slate-400 font-mono",children:a.sku}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white text-center",children:(0,h.formatNumber)(a.quantityRequired)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:(0,b.jsx)("span",{className:a.isShort?"text-amber-400":"text-emerald-400",children:(0,h.formatNumber)(a.quantityAvailable)})}),(0,b.jsx)("td",{className:"px-4 py-3 text-center",children:a.isShort?(0,b.jsxs)("span",{className:"text-xs text-amber-400",children:["Short ",(0,h.formatNumber)(a.shortBy)]}):(0,b.jsxs)("span",{className:"text-xs text-emerald-400",children:[(0,b.jsx)(s.Check,{className:"w-4 h-4 inline"})," OK"]})})]},a.productId))})]})})]}),q&&"product"===u&&0===I.length&&(0,b.jsx)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"This product does not have predefined components (BOM). To add components, edit the product and add manufacturing components."})}),q&&"product"===u&&I.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Bill of Materials"}),(0,b.jsx)("div",{className:`mb-4 p-3 rounded-lg border ${J.canProduce?"bg-emerald-500/10 border-emerald-500/30":"bg-amber-500/10 border-amber-500/30"}`,children:J.canProduce?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-emerald-400",children:[(0,b.jsx)(s.Check,{className:"w-5 h-5"}),(0,b.jsxs)("span",{className:"text-sm",children:["Sufficient stock for ",(0,h.formatNumber)(parseInt(w)||0)," units"]})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2 text-amber-400",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-5 h-5"}),(0,b.jsxs)("span",{className:"text-sm",children:["Can only produce ",(0,h.formatNumber)(J.maxProducible)," units with current stock"]})]})}),(0,b.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Component"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"SKU"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Needed"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Available"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Status"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:I.map(a=>(0,b.jsxs)("tr",{className:a.isShort?"bg-amber-500/5":"",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white",children:a.productName}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-slate-400 font-mono",children:a.sku}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white text-center",children:(0,h.formatNumber)(a.quantityRequired)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:(0,b.jsx)("span",{className:a.isShort?"text-amber-400":"text-emerald-400",children:(0,h.formatNumber)(a.quantityAvailable)})}),(0,b.jsx)("td",{className:"px-4 py-3 text-center",children:a.isShort?(0,b.jsxs)("span",{className:"text-xs text-amber-400",children:["Short ",(0,h.formatNumber)(a.shortBy)]}):(0,b.jsxs)("span",{className:"text-xs text-emerald-400",children:[(0,b.jsx)(s.Check,{className:"w-4 h-4 inline"})," OK"]})})]},a.productId))})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Due Date (Optional)"}),(0,b.jsx)("input",{type:"date",value:A,onChange:a=>B(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:C,onChange:a=>D(a.target.value),rows:2,placeholder:"Optional notes for this work order...",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]})]})})}a.s(["ReceivePOModal",()=>A],5248),a.s(["CreateWorkOrderModal",()=>B],31887);var C=a.i(25015),D=a.i(41710),E=a.i(95490),F=a.i(16106);function G({isOpen:a,onClose:i,workOrder:k,onEdit:l}){var m;let{state:n,dispatch:o}=(0,f.useApp)(),{success:p,error:r,warning:u}=(0,g.useToast)(),v=(0,j.useConfirm)(),w=a=>n.inventory.filter(b=>b.productId===a).reduce((a,b)=>a+b.quantity,0),x=(0,c.useMemo)(()=>{if(!k)return{canStart:!0,shortComponents:[]};let a=k.components.filter(a=>w(a.productId)<a.quantityRequired);return{canStart:0===a.length,shortComponents:a}},[k,n.inventory]),y=async()=>{!k||(x.canStart?await v({title:"Start Production",message:`Start production on ${k.woNumber}? This will deduct components from inventory.`,confirmText:"Start Production"})&&(k.components.forEach(a=>{let b=n.locations.find(a=>a.isDefault),c=b?.id||n.locations[0]?.id||"loc-1";o({type:"ADJUST_STOCK",payload:{productId:a.productId,locationId:c,adjustment:-a.quantityRequired}})}),o({type:"UPDATE_WORK_ORDER",payload:{...k,status:"in_progress",startedAt:new Date,components:k.components.map(a=>({...a,quantityUsed:a.quantityRequired}))}}),p(`Started production on ${k.woNumber}`),i()):r("Insufficient stock to start production"))},A=async()=>{if(k&&await v({title:"Complete Work Order",message:`Complete ${k.woNumber}? This will add ${k.quantityToProduce} ${k.outputProductName} to inventory.`,confirmText:"Complete"})){let a=n.locations.find(a=>a.isDefault),b=a?.id||n.locations[0]?.id||"loc-1";o({type:"ADJUST_STOCK",payload:{productId:k.outputProductId,locationId:b,adjustment:k.quantityToProduce}}),o({type:"UPDATE_WORK_ORDER",payload:{...k,status:"completed",quantityProduced:k.quantityToProduce,completedAt:new Date}}),p(`${k.woNumber} completed! ${(0,h.formatNumber)(k.quantityToProduce)} ${k.outputProductName} added to inventory`),i()}},B=async()=>{if(!k)return;let a="in_progress"===k.status?`Cancel ${k.woNumber}? Components have already been deducted and will NOT be returned.`:`Cancel ${k.woNumber}?`;await v({title:"Cancel Work Order",message:a,confirmText:"Cancel Work Order",destructive:!0})&&(o({type:"UPDATE_WORK_ORDER",payload:{...k,status:"cancelled"}}),p(`${k.woNumber} cancelled`),i())};if(!k)return null;let G="completed"===k.status?100:50*("in_progress"===k.status);return(0,b.jsx)(d.Modal,{open:a,onClose:i,title:k.woNumber,subtitle:k.outputProductName,size:"lg",footer:(0,b.jsxs)(b.Fragment,{children:["pending"===k.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:()=>l?.(k),children:"Edit"}),(0,b.jsx)(e.Button,{variant:"secondary",onClick:B,children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:y,disabled:!x.canStart,children:[(0,b.jsx)(C.Play,{className:"w-4 h-4"}),"Start Production"]})]}),"in_progress"===k.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:B,children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:A,children:[(0,b.jsx)(s.Check,{className:"w-4 h-4"}),"Complete"]})]}),("completed"===k.status||"cancelled"===k.status)&&(0,b.jsx)(e.Button,{variant:"secondary",onClick:i,children:"Close"})]}),children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(m=k.status,(0,b.jsx)("span",{className:`px-3 py-1 text-sm rounded-full border ${{pending:"bg-slate-500/20 text-slate-400 border-slate-500/30",in_progress:"bg-blue-500/20 text-blue-400 border-blue-500/30",completed:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",cancelled:"bg-red-500/20 text-red-400 border-red-500/30"}[m]}`,children:{pending:"Pending",in_progress:"In Progress",completed:"Completed",cancelled:"Cancelled"}[m]})),(a=>{if("normal"===a)return null;let c={high:E.ArrowUp,urgent:F.Flame}[a];return(0,b.jsxs)("span",{className:`flex items-center gap-1 ${{high:"text-amber-400",urgent:"text-red-400"}[a]}`,children:[(0,b.jsx)(c,{className:"w-4 h-4"}),a.charAt(0).toUpperCase()+a.slice(1)]})})(k.priority)]})}),"in_progress"===k.status&&(0,b.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-slate-400",children:"Production Progress"}),(0,b.jsxs)("span",{className:"text-sm text-white",children:[G,"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,b.jsx)("div",{className:"h-2 rounded-full bg-blue-500 transition-all",style:{width:`${G}%`}})})]}),"pending"===k.status&&!x.canStart&&(0,b.jsxs)("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[(0,b.jsx)(t.AlertTriangle,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-amber-400",children:"Insufficient Stock"}),(0,b.jsx)("div",{className:"text-sm text-slate-300 mt-1",children:"Cannot start production. The following components are short:"}),(0,b.jsx)("ul",{className:"mt-2 space-y-1",children:x.shortComponents.map(a=>(0,b.jsxs)("li",{className:"text-sm text-slate-400",children:[a.productName,": need ",(0,h.formatNumber)(a.quantityRequired),", have ",(0,h.formatNumber)(w(a.productId))]},a.productId))})]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Output"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-14 h-14 bg-emerald-500/20 rounded-lg flex items-center justify-center",children:(0,b.jsx)(q.Package,{className:"w-7 h-7 text-emerald-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-medium text-white",children:k.outputProductName}),(0,b.jsx)("div",{className:"text-sm text-slate-400",children:"completed"===k.status?(0,b.jsxs)("span",{className:"text-emerald-400",children:[(0,h.formatNumber)(k.quantityProduced)," / ",(0,h.formatNumber)(k.quantityToProduce)," produced"]}):(0,b.jsxs)("span",{children:[(0,h.formatNumber)(k.quantityToProduce)," to produce"]})})]})]})]}),k.components.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Components"}),(0,b.jsx)("div",{className:"border border-slate-700 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-xs text-slate-400 uppercase tracking-wider",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:"Component"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Required"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Used"}),(0,b.jsx)("th",{className:"px-4 py-3 text-center",children:"Available"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:k.components.map(a=>{let c=w(a.productId),d=c<a.quantityRequired&&"pending"===k.status;return(0,b.jsxs)("tr",{className:d?"bg-amber-500/5":"",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white",children:a.productName}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-white text-center",children:(0,h.formatNumber)(a.quantityRequired)}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:"pending"===k.status?(0,b.jsx)("span",{className:"text-slate-400",children:"-"}):(0,b.jsx)("span",{className:"text-emerald-400",children:(0,h.formatNumber)(a.quantityUsed)})}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-center",children:(0,b.jsx)("span",{className:d?"text-amber-400":"text-slate-400",children:(0,h.formatNumber)(c)})})]},a.productId)})})]})})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(z.Calendar,{className:"w-4 h-4 text-slate-400"}),(0,b.jsx)("span",{className:"text-slate-400",children:"Due Date:"}),(0,b.jsx)("span",{className:"text-white",children:k.dueDate?(0,h.formatDate)(k.dueDate):"Not set"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(D.Clock,{className:"w-4 h-4 text-slate-400"}),(0,b.jsx)("span",{className:"text-slate-400",children:"Created:"}),(0,b.jsx)("span",{className:"text-white",children:(0,h.formatDate)(k.createdAt)})]})]})]}),k.notes&&(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-2",children:"Notes"}),(0,b.jsx)("p",{className:"text-sm text-slate-300",children:k.notes})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"Timeline"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"text-white",children:"Created"}),(0,b.jsx)("span",{className:"text-slate-400 ml-2",children:(0,h.formatDateTime)(k.createdAt)})]})]}),k.startedAt&&(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"text-white",children:"Production Started"}),(0,b.jsx)("span",{className:"text-slate-400 ml-2",children:(0,h.formatDateTime)(k.startedAt)})]})]}),k.completedAt&&(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"text-white",children:"Completed"}),(0,b.jsx)("span",{className:"text-slate-400 ml-2",children:(0,h.formatDateTime)(k.completedAt)})]})]}),"cancelled"===k.status&&(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500"}),(0,b.jsx)("div",{className:"text-sm",children:(0,b.jsx)("span",{className:"text-white",children:"Cancelled"})})]})]})]})]})})}a.s(["WorkOrderDetailModal",()=>G],65631);var H=a.i(47084),I=a.i(70893),J=a.i(10227);I.Warehouse,q.Package,J.Truck;var K=a.i(80032);a.i(3544),a.i(18398);let L=(0,v.default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>L],1027);let M={damaged_in_transit:"Damaged in Transit",defective:"Defective Product",wrong_item_sent:"Wrong Item Sent",not_as_described:"Not as Described",changed_mind:"Changed Mind",ordered_wrong:"Ordered Wrong",arrived_late:"Arrived Late",better_price_found:"Better Price Found",other:"Other"};function N({isOpen:a,onClose:d,preselectedOrder:e}){let{state:i,dispatch:j}=(0,f.useApp)(),{success:k,error:l}=(0,g.useToast)(),[m,n]=(0,c.useState)("order"),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)("");(0,c.useEffect)(()=>{e&&(p(e),n("items"),A(e))},[e]),(0,c.useEffect)(()=>{a||(n("order"),p(null),r(""),t([]),v(!1),x(0),z(""))},[a]);let A=a=>{t(a.items.map(a=>({productId:a.productId,productName:a.productName,sku:a.sku,price:a.price,maxQuantity:a.quantity,quantity:a.quantity,reason:"damaged_in_transit",selected:!1})))},B=i.orders.filter(a=>("shipped"===a.status||"delivered"===a.status)&&(""===q||a.orderNumber.toLowerCase().includes(q.toLowerCase())||a.customer.name.toLowerCase().includes(q.toLowerCase()))),C=s.filter(a=>a.selected),D=()=>{let a=C.reduce((a,b)=>a+b.price*b.quantity,0),b=u&&o?o.shipping:0,c=w/100*a;return{subtotal:a,shipping:b,restockingFee:c,total:a+b-c}};if(!a)return null;let E=D();return(0,b.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,b.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:d}),(0,b.jsxs)("div",{className:"relative bg-slate-900 border border-slate-700/50 rounded-2xl shadow-2xl w-full max-w-3xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:"Create Return"}),(0,b.jsxs)("p",{className:"text-sm text-slate-400",children:["order"===m&&"Select an order to create a return for","items"===m&&"Select items to return","details"===m&&"Review and confirm return details"]})]}),(0,b.jsx)("button",{onClick:d,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,b.jsx)("i",{className:"fas fa-times"})})]}),(0,b.jsxs)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:["order"===m&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),(0,b.jsx)("input",{type:"text",placeholder:"Search orders by number or customer...",value:q,onChange:a=>r(a.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg pl-10 pr-4 py-3 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500"})]}),(0,b.jsx)("div",{className:"space-y-2",children:0===B.length?(0,b.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,b.jsx)("i",{className:"fas fa-box-open text-4xl mb-3"}),(0,b.jsx)("p",{children:"No eligible orders found"}),(0,b.jsx)("p",{className:"text-sm",children:"Only shipped or delivered orders can be returned"})]}):B.map(a=>(0,b.jsx)("button",{onClick:()=>{p(a),A(a),n("items")},className:"w-full p-4 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700/50 rounded-lg text-left transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-white",children:a.orderNumber}),(0,b.jsx)("div",{className:"text-sm text-slate-400",children:a.customer.name})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-white",children:(0,h.formatCurrency)(a.total)}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:[a.items.reduce((a,b)=>a+b.quantity,0)," items"]})]})]})},a.id))})]}),"items"===m&&o&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"bg-slate-800/30 rounded-lg p-4 mb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white font-medium",children:o.orderNumber}),(0,b.jsx)("div",{className:"text-sm text-slate-400",children:o.customer.name})]}),(0,b.jsx)("button",{onClick:()=>{n("order"),p(null)},className:"text-sm text-emerald-400 hover:underline",children:"Change Order"})]})}),(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"Select the items to return:"}),(0,b.jsx)("div",{className:"space-y-3",children:s.map(a=>(0,b.jsx)("div",{className:`p-4 border rounded-lg transition-colors ${a.selected?"border-emerald-500/50 bg-emerald-500/10":"border-slate-700/50 bg-slate-800/30"}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("button",{onClick:()=>{var b;return b=a.productId,void t(a=>a.map(a=>a.productId===b?{...a,selected:!a.selected}:a))},className:`mt-1 w-5 h-5 rounded border flex items-center justify-center ${a.selected?"bg-emerald-500 border-emerald-500 text-white":"border-slate-600 text-transparent"}`,children:(0,b.jsx)("i",{className:"fas fa-check text-xs"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white font-medium",children:a.productName}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:["SKU: ",a.sku]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-white",children:(0,h.formatCurrency)(a.price)}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:["Max qty: ",a.maxQuantity]})]})]}),a.selected&&(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",max:a.maxQuantity,value:a.quantity,onChange:b=>{var c,d;return c=a.productId,d=parseInt(b.target.value)||1,void t(a=>a.map(a=>a.productId===c?{...a,quantity:Math.min(Math.max(1,d),a.maxQuantity)}:a))},className:"w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Reason"}),(0,b.jsx)("select",{value:a.reason,onChange:b=>{var c,d;return c=a.productId,d=b.target.value,void t(a=>a.map(a=>a.productId===c?{...a,reason:d}:a))},className:"w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white",children:Object.entries(M).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))})]})]})]})]})},a.productId))})]}),"details"===m&&o&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-white font-medium mb-3",children:"Return Items"}),(0,b.jsx)("div",{className:"bg-slate-800/30 rounded-lg overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-slate-800/50",children:(0,b.jsxs)("tr",{className:"text-left text-xs text-slate-400 uppercase",children:[(0,b.jsx)("th",{className:"px-4 py-2",children:"Product"}),(0,b.jsx)("th",{className:"px-4 py-2 text-center",children:"Qty"}),(0,b.jsx)("th",{className:"px-4 py-2",children:"Reason"}),(0,b.jsx)("th",{className:"px-4 py-2 text-right",children:"Refund"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-700/50",children:C.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)("div",{className:"text-white",children:a.productName}),(0,b.jsx)("div",{className:"text-xs text-slate-400",children:a.sku})]}),(0,b.jsx)("td",{className:"px-4 py-3 text-center text-white",children:a.quantity}),(0,b.jsx)("td",{className:"px-4 py-3 text-slate-300 text-sm",children:M[a.reason]}),(0,b.jsx)("td",{className:"px-4 py-3 text-right text-white",children:(0,h.formatCurrency)(a.price*a.quantity)})]},a.productId))})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:u,onChange:a=>v(a.target.checked),className:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500"}),(0,b.jsxs)("span",{className:"text-slate-300",children:["Refund shipping (",(0,h.formatCurrency)(o.shipping),")"]})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Restocking Fee %"}),(0,b.jsx)("input",{type:"number",min:"0",max:"100",value:w,onChange:a=>x(parseInt(a.target.value)||0),className:"w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white"})]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/30 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-white font-medium mb-3",children:"Refund Summary"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-slate-300",children:[(0,b.jsx)("span",{children:"Items Subtotal"}),(0,b.jsx)("span",{children:(0,h.formatCurrency)(E.subtotal)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-slate-300",children:[(0,b.jsx)("span",{children:"Shipping Refund"}),(0,b.jsx)("span",{children:(0,h.formatCurrency)(E.shipping)})]}),E.restockingFee>0&&(0,b.jsxs)("div",{className:"flex justify-between text-red-400",children:[(0,b.jsx)("span",{children:"Restocking Fee"}),(0,b.jsxs)("span",{children:["-",(0,h.formatCurrency)(E.restockingFee)]})]}),(0,b.jsxs)("div",{className:"pt-2 border-t border-slate-700 flex justify-between text-lg",children:[(0,b.jsx)("span",{className:"text-white font-semibold",children:"Total Refund"}),(0,b.jsx)("span",{className:"text-emerald-400 font-bold",children:(0,h.formatCurrency)(E.total)})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1",children:"Notes (optional)"}),(0,b.jsx)("textarea",{value:y,onChange:a=>z(a.target.value),rows:3,placeholder:"Add any notes about this return...",className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500 resize-none"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-slate-700/50",children:[(0,b.jsx)("div",{children:"order"!==m&&(0,b.jsxs)("button",{onClick:()=>n("details"===m?"items":"order"),className:"px-4 py-2 text-slate-400 hover:text-white transition-colors flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-arrow-left"}),"Back"]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{onClick:d,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg transition-colors",children:"Cancel"}),"items"===m&&(0,b.jsxs)("button",{onClick:()=>n("details"),disabled:0===C.length,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-lg transition-colors flex items-center gap-2",children:["Continue",(0,b.jsx)("i",{className:"fas fa-arrow-right"})]}),"details"===m&&(0,b.jsxs)("button",{onClick:()=>{if(!o||0===C.length)return void l("Please select at least one item to return");let a=D(),b=`RET-${String(i.returns.length+1).padStart(4,"0")}`;j({type:"ADD_RETURN",payload:{id:`return-${Date.now()}`,returnNumber:b,orderId:o.id,orderNumber:o.orderNumber,channel:o.channel,status:"requested",customer:{name:o.customer.name,email:o.customer.email},items:C.map(a=>({productId:a.productId,productName:a.productName,sku:a.sku,quantity:a.quantity,quantityReceived:0,reason:a.reason,refundAmount:a.price*a.quantity})),returnShipping:{},refund:{subtotal:a.subtotal,shipping:a.shipping,restockingFee:a.restockingFee,total:a.total},notes:y||void 0,createdAt:new Date,updatedAt:new Date}}),k(`Return ${b} created successfully`),d()},className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-check"}),"Create Return"]})]})]})]})]})})}a.s(["CreateReturnModal",()=>N],35940);var O=a.i(50944);function P({isOpen:a,onClose:d}){let e=(0,O.useRouter)(),{state:h,dispatch:i}=(0,f.useApp)(),{success:j,error:k}=(0,g.useToast)(),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)("cycle"),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("all"),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)([]),z=(0,c.useMemo)(()=>Array.from(new Set(h.products.map(a=>a.category))).sort(),[h.products]),A=(0,c.useMemo)(()=>{let a=h.products;if(p&&(a=a.filter(a=>h.inventory.some(b=>b.productId===a.id&&b.locationId===p))),v){let b=v.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.sku.toLowerCase().includes(b))}return a},[h.products,h.inventory,p,v]),B=()=>{m(""),o("cycle"),q(""),s(""),u("all"),w(""),y([]),d()};return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,b.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:B}),(0,b.jsxs)("div",{className:"relative bg-slate-900 border border-slate-700/50 rounded-2xl shadow-2xl w-full max-w-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:"Create Stock Count"}),(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"Set up a new inventory count"})]}),(0,b.jsx)("button",{onClick:B,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,b.jsx)("i",{className:"fas fa-times"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6 max-h-[60vh] overflow-y-auto",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Count Name"}),(0,b.jsx)("input",{type:"text",value:l,onChange:a=>m(a.target.value),placeholder:"e.g., Monthly Full Count - December",className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Count Type"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("button",{onClick:()=>o("full"),className:`p-4 rounded-lg border text-left transition-colors ${"full"===n?"bg-purple-500/20 border-purple-500 text-purple-400":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsx)("i",{className:"fas fa-boxes mb-2"}),(0,b.jsx)("div",{className:"font-medium",children:"Full Count"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"Count all items at location"})]}),(0,b.jsxs)("button",{onClick:()=>o("cycle"),className:`p-4 rounded-lg border text-left transition-colors ${"cycle"===n?"bg-blue-500/20 border-blue-500 text-blue-400":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsx)("i",{className:"fas fa-sync-alt mb-2"}),(0,b.jsx)("div",{className:"font-medium",children:"Cycle Count"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"Count specific category or zone"})]}),(0,b.jsxs)("button",{onClick:()=>o("spot"),className:`p-4 rounded-lg border text-left transition-colors ${"spot"===n?"bg-amber-500/20 border-amber-500 text-amber-400":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[(0,b.jsx)("i",{className:"fas fa-search mb-2"}),(0,b.jsx)("div",{className:"font-medium",children:"Spot Check"}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"Count specific items only"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Location"}),(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"Select a location..."}),h.locations.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),"cycle"===n&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Category (Optional)"}),(0,b.jsxs)("select",{value:r,onChange:a=>s(a.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),z.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),"spot"!==n&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Include Items"}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded-lg border transition-colors ${"all"===t?"bg-emerald-500/20 border-emerald-500 text-emerald-400":"bg-slate-800/50 border-slate-700 text-slate-400"}`,children:"All Items"}),(0,b.jsx)("button",{onClick:()=>u("low_stock"),className:`px-4 py-2 rounded-lg border transition-colors ${"low_stock"===t?"bg-amber-500/20 border-amber-500 text-amber-400":"bg-slate-800/50 border-slate-700 text-slate-400"}`,children:"Low Stock Only"}),(0,b.jsx)("button",{onClick:()=>u("high_value"),className:`px-4 py-2 rounded-lg border transition-colors ${"high_value"===t?"bg-purple-500/20 border-purple-500 text-purple-400":"bg-slate-800/50 border-slate-700 text-slate-400"}`,children:"High Value Only"})]})]}),"spot"===n&&p&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Select Items to Count (",x.length," selected)"]}),(0,b.jsxs)("div",{className:"relative mb-3",children:[(0,b.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),(0,b.jsx)("input",{type:"text",value:v,onChange:a=>w(a.target.value),placeholder:"Search products...",className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg pl-10 pr-4 py-2.5 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500"})]}),(0,b.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-slate-700 rounded-lg p-2",children:0===A.length?(0,b.jsx)("p",{className:"text-center py-4 text-slate-500",children:"No products found at this location"}):A.map(a=>(0,b.jsxs)("label",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors ${x.includes(a.id)?"bg-emerald-500/20 border border-emerald-500/30":"hover:bg-slate-800/50 border border-transparent"}`,children:[(0,b.jsx)("input",{type:"checkbox",checked:x.includes(a.id),onChange:()=>{var b;return b=a.id,void y(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"w-4 h-4 rounded border-slate-600 bg-slate-700 text-emerald-500 focus:ring-emerald-500"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white",children:a.name}),(0,b.jsx)("div",{className:"text-xs text-slate-400",children:a.sku})]}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:[h.inventory.find(b=>b.productId===a.id&&b.locationId===p)?.quantity||0," in stock"]})]},a.id))})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-slate-700/50",children:[(0,b.jsx)("button",{onClick:B,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg transition-colors",children:"Cancel"}),(0,b.jsxs)("button",{onClick:()=>{let a;if(!l.trim())return void k("Please enter a count name");if(!p)return void k("Please select a location");if("spot"===n&&0===x.length)return void k("Please select at least one product for spot check");let b=h.products.filter(a=>h.inventory.some(b=>b.productId===a.id&&b.locationId===p));if(r&&"cycle"===n&&(b=b.filter(a=>a.category===r)),"spot"===n&&(b=b.filter(a=>x.includes(a.id))),"low_stock"===t?b=b.filter(a=>{let b=h.inventory.find(b=>b.productId===a.id&&b.locationId===p);return b&&b.quantity<=a.reorderPoint}):"high_value"===t&&(b=b.filter(a=>a.cost.rolling>=10)),0===b.length)return void k("No products match the selected criteria");let c=b.map(a=>{let b=h.inventory.find(b=>b.productId===a.id&&b.locationId===p);return{productId:a.id,productName:a.name,sku:a.sku,binLocation:b?.binLocation,systemQty:b?.quantity||0,countedQty:null,variance:0,varianceValue:0,status:"pending"}}),f=h.locations.find(a=>a.id===p),g=(a=h.stockCounts.length+1,`SC-${String(a).padStart(4,"0")}`),m={id:`sc-${Date.now()}`,countNumber:g,name:l,type:n,status:"draft",location:p,locationName:f?.name||"",category:r||void 0,items:c,summary:{totalItems:c.length,countedItems:0,matchedItems:0,discrepancyItems:0,totalVariance:0},createdAt:new Date,updatedAt:new Date};i({type:"ADD_STOCK_COUNT",payload:m}),j(`Stock count ${g} created with ${c.length} items`),d(),e.push(`/inventory/counts/${m.id}`)},disabled:!l.trim()||!p||"spot"===n&&0===x.length,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-plus"}),"Create Count"]})]})]})]})}):null}function Q({isOpen:a,onClose:d,preselectedProduct:e}){let h=(0,O.useRouter)(),{state:i,dispatch:j}=(0,f.useApp)(),{success:k,error:l}=(0,g.useToast)(),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)([]),y=(a,b)=>{let c=i.inventory.find(c=>c.productId===a&&c.locationId===b);return c?.quantity||0},z=(0,c.useMemo)(()=>{if(!m)return[];let a=i.products.filter(a=>y(a.id,m)>0&&!w.some(b=>b.productId===a.id));if(s){let b=s.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.sku.toLowerCase().includes(b))}return a},[i.products,i.inventory,m,s,w]),A=()=>{n(""),p(""),r(""),t(""),v(!1),x([]),d()};if((0,c.useMemo)(()=>{if(e&&m&&!w.some(a=>a.productId===e.id)){let a=y(e.id,m);a>0&&x([{productId:e.id,productName:e.name,sku:e.sku,requestedQty:Math.min(1,a)}])}},[e,m]),!a)return null;let B=w.reduce((a,b)=>a+b.requestedQty,0);return(0,b.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,b.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:A}),(0,b.jsxs)("div",{className:"relative bg-slate-900 border border-slate-700/50 rounded-2xl shadow-2xl w-full max-w-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-700/50",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:"Create Stock Transfer"}),(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"Move inventory between locations"})]}),(0,b.jsx)("button",{onClick:A,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,b.jsx)("i",{className:"fas fa-times"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6 max-h-[60vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"From Location"}),(0,b.jsxs)("select",{value:m,onChange:a=>{n(a.target.value),x([])},className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 focus:outline-none focus:border-emerald-500",children:[(0,b.jsx)("option",{value:"",children:"Select source..."}),i.locations.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"To Location"}),(0,b.jsxs)("select",{value:o,onChange:a=>p(a.target.value),disabled:!m,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 focus:outline-none focus:border-emerald-500 disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Select destination..."}),i.locations.filter(a=>a.id!==m).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]}),m&&o&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4 py-2",children:[(0,b.jsx)("div",{className:"text-slate-400 font-medium",children:i.locations.find(a=>a.id===m)?.name}),(0,b.jsx)("i",{className:"fas fa-arrow-right text-emerald-400 text-xl"}),(0,b.jsx)("div",{className:"text-slate-400 font-medium",children:i.locations.find(a=>a.id===o)?.name})]}),m&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Add Products to Transfer"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),(0,b.jsx)("input",{type:"text",placeholder:"Search products at source location...",value:s,onChange:a=>{t(a.target.value),v(!0)},onFocus:()=>v(!0),className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg pl-10 pr-4 py-3 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500"}),u&&s&&(0,b.jsx)("div",{className:"absolute top-full left-0 right-0 bg-slate-800 border border-slate-700 rounded-lg mt-1 max-h-60 overflow-y-auto z-10",children:0===z.length?(0,b.jsx)("div",{className:"p-4 text-center text-slate-500",children:"No products found"}):z.slice(0,10).map(a=>(0,b.jsxs)("button",{onClick:()=>{let b;return b=y(a.id,m),void(x([...w,{productId:a.id,productName:a.name,sku:a.sku,requestedQty:Math.min(1,b)}]),t(""),v(!1))},className:"w-full flex items-center justify-between p-3 hover:bg-slate-700 transition-colors text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-white",children:a.name}),(0,b.jsx)("div",{className:"text-sm text-slate-400",children:a.sku})]}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:[y(a.id,m)," available"]})]},a.id))})]}),w.length>0&&(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[w.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-slate-800/50 border border-slate-700/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white",children:a.productName}),(0,b.jsxs)("div",{className:"text-sm text-slate-400",children:[a.sku," â€¢ Available: ",y(a.productId,m)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("label",{className:"text-sm text-slate-400",children:"Qty:"}),(0,b.jsx)("input",{type:"number",min:1,max:y(a.productId,m),value:a.requestedQty,onChange:a=>{var b;let d;return b=parseInt(a.target.value)||1,d=y(w[c].productId,m),void x(w.map((a,e)=>e===c?{...a,requestedQty:Math.min(Math.max(1,b),d)}:a))},className:"w-20 bg-slate-700/50 border border-slate-600 rounded px-2 py-1 text-white text-center focus:outline-none focus:border-emerald-500"})]}),(0,b.jsx)("button",{onClick:()=>{x(w.filter((a,b)=>b!==c))},className:"p-2 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors",children:(0,b.jsx)("i",{className:"fas fa-times"})})]},a.productId)),(0,b.jsxs)("div",{className:"flex justify-end pt-2 text-slate-400",children:["Total: ",w.length," product",1!==w.length?"s":"",", ",B," unit",1!==B?"s":""]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notes (optional)"}),(0,b.jsx)("textarea",{value:q,onChange:a=>r(a.target.value),placeholder:"Reason for transfer, special instructions...",rows:3,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500 resize-none"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-slate-700/50",children:[(0,b.jsx)("button",{onClick:A,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg transition-colors",children:"Cancel"}),(0,b.jsxs)("button",{onClick:()=>{let a;if(!m)return void l("Please select a source location");if(!o)return void l("Please select a destination location");if(m===o)return void l("Source and destination must be different");if(0===w.length)return void l("Please add at least one product to transfer");let b=i.locations.find(a=>a.id===m),c=i.locations.find(a=>a.id===o),d=(a=i.transfers.length+1,`TRF-${String(a).padStart(4,"0")}`),e={id:`trf-${Date.now()}`,transferNumber:d,status:"pending",fromLocation:m,fromLocationName:b?.name||"",toLocation:o,toLocationName:c?.name||"",items:w.map(a=>({productId:a.productId,productName:a.productName,sku:a.sku,requestedQty:a.requestedQty,shippedQty:0,receivedQty:0,status:"pending"})),notes:q||void 0,createdAt:new Date,updatedAt:new Date};j({type:"ADD_TRANSFER",payload:e}),k(`Transfer ${d} created`),A(),h.push(`/inventory/transfers/${e.id}`)},disabled:!m||!o||0===w.length,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,b.jsx)("i",{className:"fas fa-exchange-alt"}),"Create Transfer"]})]})]})]})})}a.s(["CreateStockCountModal",()=>P],2087),a.s(["CreateTransferModal",()=>Q],5379);let R=[{id:"tpl-usps-small",name:"Auto-assign USPS for small orders",description:"Orders under $50 with weight less than 1lb ship USPS First Class",category:"shipping",trigger:{type:"order_created"},conditions:[{field:"total",operator:"less_than",value:50}],actions:[{type:"assign_carrier",config:{carrier:"usps"}},{type:"assign_service",config:{service:"first_class"}}]},{id:"tpl-ups-heavy",name:"Use UPS for heavy orders",description:"Orders over 5lbs ship via UPS Ground",category:"shipping",trigger:{type:"order_created"},conditions:[{field:"weight",operator:"greater_than",value:80}],actions:[{type:"assign_carrier",config:{carrier:"ups"}},{type:"assign_service",config:{service:"ground"}}]},{id:"tpl-fedex-express",name:"FedEx for high-value orders",description:"Orders over $200 ship FedEx with signature required",category:"shipping",trigger:{type:"order_created"},conditions:[{field:"total",operator:"greater_than",value:200}],actions:[{type:"assign_carrier",config:{carrier:"fedex"}},{type:"assign_service",config:{service:"express_saver"}}]},{id:"tpl-prime-tag",name:"Tag Amazon Prime orders as urgent",description:"Add PRIME tag and set high priority for Amazon Prime orders",category:"tagging",trigger:{type:"order_created"},conditions:[{field:"is_prime",operator:"equals",value:!0}],actions:[{type:"set_order_tag",config:{tag:"PRIME"}},{type:"set_priority",config:{priority:"high"}}]},{id:"tpl-wholesale-tag",name:"Tag wholesale orders",description:"Add WHOLESALE tag and notify team for bulk orders",category:"tagging",trigger:{type:"order_created"},conditions:[{field:"item_count",operator:"greater_than",value:10}],actions:[{type:"set_order_tag",config:{tag:"WHOLESALE"}},{type:"send_notification",config:{message:"New wholesale order received"}}]},{id:"tpl-international-tag",name:"Tag international orders",description:"Flag orders shipping outside the US",category:"tagging",trigger:{type:"order_created"},conditions:[{field:"shipping_country",operator:"not_equals",value:"US"}],actions:[{type:"set_order_tag",config:{tag:"INTERNATIONAL"}},{type:"set_priority",config:{priority:"low"}}]},{id:"tpl-fragile-tag",name:"Tag fragile product orders",description:"Add FRAGILE tag when order contains specific SKUs",category:"tagging",trigger:{type:"order_created"},conditions:[{field:"contains_sku",operator:"contains",value:"4L"}],actions:[{type:"set_order_tag",config:{tag:"FRAGILE"}}]},{id:"tpl-low-stock-alert",name:"Create PO when stock is low",description:"Automatically create a PO draft and notify when stock drops below threshold",category:"inventory",trigger:{type:"low_stock",threshold:50},conditions:[],actions:[{type:"create_po_draft",config:{quantity:100}},{type:"send_notification",config:{message:"Low stock alert! PO draft created."}}]},{id:"tpl-critical-stock",name:"Critical stock email alert",description:"Send urgent email when stock is critically low",category:"inventory",trigger:{type:"low_stock",threshold:10},conditions:[],actions:[{type:"send_email",config:{recipient:"admin@company.com",subject:"URGENT: Critical stock level"}},{type:"send_notification",config:{message:"CRITICAL: Stock nearly depleted!"}}]},{id:"tpl-new-order-notify",name:"Notify on new Shopify orders",description:"Send notification when a new Shopify order is received",category:"notification",trigger:{type:"order_created"},conditions:[{field:"channel",operator:"equals",value:"shopify"}],actions:[{type:"send_notification",config:{message:"New Shopify order received!"}}]},{id:"tpl-vip-customer",name:"VIP customer alert",description:"Notify when orders come from VIP email domains",category:"notification",trigger:{type:"order_created"},conditions:[{field:"total",operator:"greater_than",value:500}],actions:[{type:"set_order_tag",config:{tag:"VIP"}},{type:"set_priority",config:{priority:"urgent"}},{type:"send_notification",config:{message:"VIP order received - prioritize!"}}]},{id:"tpl-gripper-sticker",name:"Add gripper sticker to every bottle",description:"Automatically add gripper stickers to orders containing bottles",category:"shipping",trigger:{type:"order_created"},conditions:[{field:"contains_sku",operator:"contains",value:"CN"}],actions:[{type:"add_fulfillment_item",config:{productId:"gripper-sku",quantity:1}}]}],S=[{type:"order_created",icon:"ShoppingCart",label:"New Order",description:"When an order is created"},{type:"order_status_changed",icon:"ArrowLeftRight",label:"Status Change",description:"When order status changes"},{type:"low_stock",icon:"AlertTriangle",label:"Low Stock",description:"When stock falls below threshold"},{type:"item_received",icon:"PackageCheck",label:"Item Received",description:"When inventory is received"},{type:"daily",icon:"Clock",label:"Scheduled",description:"Run at a specific time daily"},{type:"manual",icon:"Hand",label:"Manual",description:"Run manually when triggered"}],T=[{type:"set_order_tag",label:"Add Order Tag",icon:"Tag"},{type:"set_priority",label:"Set Priority",icon:"Flag"},{type:"assign_carrier",label:"Assign Carrier",icon:"Truck"},{type:"assign_service",label:"Assign Shipping Service",icon:"Package"},{type:"select_box",label:"Select Box",icon:"Box"},{type:"add_fulfillment_item",label:"Add Fulfillment Item",icon:"Plus"},{type:"send_notification",label:"Send Notification",icon:"Bell"},{type:"create_po_draft",label:"Create PO Draft",icon:"FileText"},{type:"send_email",label:"Send Email",icon:"Mail"},{type:"set_location",label:"Set Location",icon:"MapPin"}],U=[{value:"equals",label:"equals"},{value:"not_equals",label:"does not equal"},{value:"contains",label:"contains"},{value:"greater_than",label:"is greater than"},{value:"less_than",label:"is less than"},{value:"in_list",label:"is one of"}],V=[{value:"low",label:"Low"},{value:"normal",label:"Normal"},{value:"high",label:"High"},{value:"urgent",label:"Urgent"}],W=[{value:"usps",label:"USPS"},{value:"ups",label:"UPS"},{value:"fedex",label:"FedEx"},{value:"dhl",label:"DHL"}],X={usps:[{value:"first_class",label:"First Class"},{value:"priority",label:"Priority Mail"},{value:"priority_express",label:"Priority Express"},{value:"ground_advantage",label:"Ground Advantage"}],ups:[{value:"ground",label:"UPS Ground"},{value:"three_day_select",label:"3 Day Select"},{value:"second_day_air",label:"2nd Day Air"},{value:"next_day_air",label:"Next Day Air"}],fedex:[{value:"ground",label:"FedEx Ground"},{value:"home_delivery",label:"Home Delivery"},{value:"express_saver",label:"Express Saver"},{value:"standard_overnight",label:"Standard Overnight"}],dhl:[{value:"express",label:"DHL Express"},{value:"express_worldwide",label:"Express Worldwide"}]};function Y(a){switch(a.type){case"order_created":return"New Order";case"order_status_changed":if(a.toStatus)return`Status â†’ ${a.toStatus}`;return"Status Change";case"low_stock":return`Low Stock (â‰¤${a.threshold||50})`;case"item_received":return"Item Received";case"daily":return`Daily at ${a.time}`;case"manual":return"Manual";default:return"Unknown"}}function Z(a){switch(a.type){case"set_order_tag":return`Add tag "${a.config.tag}"`;case"set_priority":return`Set priority to ${a.config.priority}`;case"assign_carrier":return`Assign ${a.config.carrier?.toUpperCase()}`;case"assign_service":return`Use ${a.config.service}`;case"select_box":return`Select box ${a.config.boxId}`;case"send_notification":return"Send notification";case"add_fulfillment_item":return`Add item (qty: ${a.config.quantity||1})`;case"set_location":return"Set location";case"create_po_draft":return"Create PO draft";case"send_email":return"Send email";default:return"Unknown action"}}a.s(["getActionLabel",()=>Z,"getTriggerLabel",()=>Y],93847);var $=a.i(50522),_=a.i(13749),aa=a.i(15618),ab=a.i(38784);let ac=(0,v.default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);a.s(["ArrowLeftRight",()=>ac],19256);let ad=(0,v.default)("package-check",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);a.s(["PackageCheck",()=>ad],62143);var ae=a.i(25483),af=a.i(33350);let ag=(0,v.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var ah=a.i(23312),ai=a.i(4720),aj=a.i(92258),ak=a.i(24987),al=a.i(8406);let am=(0,v.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);a.s(["Filter",()=>am],69012);let an=["template","basic","trigger","conditions","actions","review"],ao={order_created:ab.ShoppingCart,order_status_changed:ac,low_stock:t.AlertTriangle,item_received:ad,daily:D.Clock,manual:ae.Hand},ap={set_order_tag:af.Tag,set_priority:ag,assign_carrier:J.Truck,assign_service:q.Package,select_box:K.Box,send_notification:ah.Bell,add_fulfillment_item:aa.Plus,create_po_draft:ai.FileText,send_email:aj.Mail,set_location:ak.MapPin};function aq({isOpen:a,onClose:h,editRule:i}){let j,k,{state:l,dispatch:m}=(0,f.useApp)(),{success:n,error:o}=(0,g.useToast)(),p=!!i,[q,r]=(0,c.useState)("template"),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(10),[D,E]=(0,c.useState)({type:"order_created"}),[F,G]=(0,c.useState)([]),[I,J]=(0,c.useState)([]),[K,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(50),[ab,ac]=(0,c.useState)("09:00"),[ad,ae]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a)if(i)if(u(i.name),w(i.description||""),z(i.enabled),B(i.priority),E(i.trigger),G(i.conditions),J(i.actions),r("basic"),"order_status_changed"===i.trigger.type){let a=i.trigger;M(a.fromStatus||""),O(a.toStatus||"")}else"low_stock"===i.trigger.type?Q(i.trigger.threshold||50):"daily"===i.trigger.type&&ac(i.trigger.time||"09:00");else u(""),w(""),z(!0),B(10),E({type:"order_created"}),G([]),J([]),M(""),O(""),Q(50),ac("09:00"),r("template")},[a,i]);let af=an.indexOf(q),ag=af>+!!p,ah=af<an.length-1,ai=(0,c.useMemo)(()=>{switch(q){case"template":case"trigger":case"conditions":return!0;case"basic":return t.trim().length>0;case"actions":return I.length>0;case"review":return t.trim().length>0&&I.length>0;default:return!1}},[q,t,I]),aj=()=>{G([...F,{id:crypto.randomUUID(),field:"",operator:"equals",value:""}])},ak=(a,b,c)=>{let d=[...F];d[a]={...d[a],[b]:c},G(d)},aq=()=>{J([...I,{id:crypto.randomUUID(),type:"set_order_tag",config:{}}])},ar=(a,b,c)=>{let d=[...I];d[a]={...d[a],config:{...d[a].config,[b]:c}},J(d)},as=()=>{switch(D.type){case"order_status_changed":return{type:"order_status_changed",...K&&{fromStatus:K},...N&&{toStatus:N}};case"low_stock":return{type:"low_stock",threshold:P};case"daily":return{type:"daily",time:ab};default:return D}},at=()=>["order_created","order_status_changed"].includes(D.type)?f.conditionFields.order:["low_stock","item_received"].includes(D.type)?f.conditionFields.inventory:f.conditionFields.order;return(0,b.jsxs)(d.Modal,{open:a,onClose:h,title:p?"Edit Automation Rule":"Create Automation Rule",subtitle:"template"===q?"Choose a template or start from scratch":void 0,size:"lg",footer:"template"!==q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"secondary",onClick:ag?()=>{ag&&r(an[af-1])}:h,children:ag?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(_.ChevronLeft,{className:"w-4 h-4"}),"Back"]}):"Cancel"}),"review"===q?(0,b.jsx)(e.Button,{onClick:()=>{if(ai){ae(!0);try{let a={id:i?.id||crypto.randomUUID(),name:t.trim(),description:v.trim()||void 0,enabled:y,trigger:as(),conditions:F,actions:I,priority:A,createdAt:i?.createdAt||new Date,updatedAt:new Date};p?(m({type:"UPDATE_AUTOMATION_RULE",payload:a}),n(`Rule "${t}" updated`)):(m({type:"ADD_AUTOMATION_RULE",payload:a}),n(`Rule "${t}" created`)),h()}catch(a){o("Failed to save rule")}finally{ae(!1)}}},disabled:ad||!ai,children:ad?"Saving...":p?"Save Changes":"Create Rule"}):(0,b.jsxs)(e.Button,{onClick:()=>{ah&&r(an[af+1])},disabled:!ai,children:["Next",(0,b.jsx)($.ChevronRight,{className:"w-4 h-4"})]})]}):void 0,children:["template"!==q&&(j=p?an.slice(1):an,k=p?af-1:af,(0,b.jsx)("div",{className:"flex items-center justify-center gap-2 mb-6",children:j.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${c===k?"bg-emerald-500 text-white":c<k?"bg-emerald-500/20 text-emerald-400":"bg-slate-700 text-slate-400"}`,children:c<k?(0,b.jsx)(s.Check,{className:"w-4 h-4"}):c+1}),c<j.length-1&&(0,b.jsx)("div",{className:`w-8 h-0.5 mx-1 ${c<k?"bg-emerald-500/50":"bg-slate-700"}`})]},a))})),(()=>{switch(q){case"template":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center pb-4",children:[(0,b.jsx)(al.Sparkles,{className:"w-12 h-12 text-emerald-400 mx-auto mb-3"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-white",children:"Start with a Template"}),(0,b.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Choose a pre-built rule or start from scratch"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-3 max-h-80 overflow-y-auto pr-2",children:R.map(a=>(0,b.jsx)("button",{onClick:()=>{u(a.name),w(a.description),E(a.trigger),G(a.conditions.map(a=>({...a,id:crypto.randomUUID()}))),J(a.actions.map(a=>({...a,id:crypto.randomUUID()}))),"low_stock"===a.trigger.type&&Q(a.trigger.threshold||50),r("basic")},className:"text-left p-4 rounded-lg bg-slate-800/50 border border-slate-700/50 hover:border-emerald-500/50 hover:bg-slate-800 transition-all",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center",children:(0,b.jsx)(L,{className:"w-5 h-5 text-emerald-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-white truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-0.5 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("span",{className:"px-2 py-0.5 rounded bg-slate-700 text-xs text-slate-300",children:Y(a.trigger)}),(0,b.jsxs)("span",{className:"text-xs text-slate-500",children:[a.actions.length," action",1!==a.actions.length?"s":""]})]})]}),(0,b.jsx)($.ChevronRight,{className:"w-5 h-5 text-slate-500 flex-shrink-0"})]})},a.id))}),(0,b.jsx)("div",{className:"pt-4 border-t border-slate-700/50",children:(0,b.jsxs)(e.Button,{variant:"secondary",className:"w-full",onClick:()=>r("basic"),children:[(0,b.jsx)(aa.Plus,{className:"w-4 h-4"}),"Start from Scratch"]})})]});case"basic":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Rule Name *"}),(0,b.jsx)("input",{type:"text",value:t,onChange:a=>u(a.target.value),placeholder:"e.g., Auto-assign USPS for orders under $50",className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50",autoFocus:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Description (Optional)"}),(0,b.jsx)("textarea",{value:v,onChange:a=>w(a.target.value),placeholder:"What does this rule do?",rows:3,className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50 resize-none"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Priority"}),(0,b.jsx)("input",{type:"number",min:1,max:100,value:A,onChange:a=>B(parseInt(a.target.value)||10),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Lower numbers run first"})]}),(0,b.jsx)("div",{className:"flex items-end pb-6",children:(0,b.jsx)("div",{className:"w-full bg-slate-800/50 border border-slate-700/50 rounded-lg p-4",children:(0,b.jsx)(H.Toggle,{checked:y,onChange:z,label:"Enabled"})})})]})]});case"trigger":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-3",children:"When should this rule run?"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:S.map(a=>{let c=ao[a.type]||L,d=D.type===a.type;return(0,b.jsxs)("button",{onClick:()=>E({type:a.type}),className:`p-4 border rounded-lg text-left transition-all ${d?"border-emerald-500 bg-emerald-500/10":"border-slate-700 hover:border-slate-600 bg-slate-800/50"}`,children:[(0,b.jsx)(c,{className:`w-5 h-5 mb-2 ${d?"text-emerald-400":"text-slate-400"}`}),(0,b.jsx)("div",{className:`font-medium ${d?"text-white":"text-slate-300"}`,children:a.label}),(0,b.jsx)("div",{className:"text-xs text-slate-400 mt-0.5",children:a.description})]},a.type)})})]}),"order_status_changed"===D.type&&(0,b.jsx)("div",{className:"bg-slate-800/50 rounded-lg p-4 space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"From Status (Optional)"}),(0,b.jsxs)("select",{value:K,onChange:a=>M(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Any status"}),(0,b.jsx)("option",{value:"to_pick",children:"To Pick"}),(0,b.jsx)("option",{value:"picking",children:"Picking"}),(0,b.jsx)("option",{value:"to_pack",children:"To Pack"}),(0,b.jsx)("option",{value:"packing",children:"Packing"}),(0,b.jsx)("option",{value:"ready",children:"Ready"}),(0,b.jsx)("option",{value:"shipped",children:"Shipped"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"To Status (Optional)"}),(0,b.jsxs)("select",{value:N,onChange:a=>O(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Any status"}),(0,b.jsx)("option",{value:"to_pick",children:"To Pick"}),(0,b.jsx)("option",{value:"picking",children:"Picking"}),(0,b.jsx)("option",{value:"to_pack",children:"To Pack"}),(0,b.jsx)("option",{value:"packing",children:"Packing"}),(0,b.jsx)("option",{value:"ready",children:"Ready"}),(0,b.jsx)("option",{value:"shipped",children:"Shipped"})]})]})]})}),"low_stock"===D.type&&(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Stock Threshold"}),(0,b.jsx)("input",{type:"number",min:0,value:P,onChange:a=>Q(parseInt(a.target.value)||50),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Rule triggers when stock falls to or below this level"})]}),"daily"===D.type&&(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400 mb-1.5",children:"Run Time"}),(0,b.jsx)("input",{type:"time",value:ab,onChange:a=>ac(a.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-emerald-500/50"})]})]});case"conditions":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400",children:"Conditions (Optional)"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-0.5",children:"Only run this rule when these conditions are met"})]}),(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",onClick:aj,children:[(0,b.jsx)(aa.Plus,{className:"w-4 h-4"}),"Add"]})]}),0===F.length?(0,b.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,b.jsx)(am,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"No conditions - rule will run for all matching triggers"})]}):(0,b.jsx)("div",{className:"space-y-3",children:F.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-slate-800/50 rounded-lg",children:[c>0&&(0,b.jsx)("span",{className:"text-xs text-slate-500 px-2",children:"AND"}),(0,b.jsxs)("select",{value:a.field,onChange:a=>ak(c,"field",a.target.value),className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select field..."}),at().map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),(0,b.jsx)("select",{value:a.operator,onChange:a=>ak(c,"operator",a.target.value),className:"w-36 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:U.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))}),(0,b.jsx)("input",{type:"text",value:a.value,onChange:a=>ak(c,"value",a.target.value),placeholder:"Value...",className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),(0,b.jsx)("button",{onClick:()=>{G(F.filter((a,b)=>b!==c))},className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:(0,b.jsx)(x.X,{className:"w-4 h-4"})})]},a.id))})]});case"actions":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-slate-400",children:"Actions *"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-0.5",children:"What should happen when this rule triggers?"})]}),(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",onClick:aq,children:[(0,b.jsx)(aa.Plus,{className:"w-4 h-4"}),"Add"]})]}),0===I.length?(0,b.jsxs)("div",{className:"text-center py-8 text-slate-400 border-2 border-dashed border-slate-700 rounded-lg",children:[(0,b.jsx)(C.Play,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"Add at least one action"}),(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"mt-3",onClick:aq,children:[(0,b.jsx)(aa.Plus,{className:"w-4 h-4"}),"Add Action"]})]}):(0,b.jsx)("div",{className:"space-y-3",children:I.map((a,c)=>{let d=ap[a.type]||L;return(0,b.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-emerald-500/20 flex items-center justify-center",children:(0,b.jsx)(d,{className:"w-4 h-4 text-emerald-400"})}),(0,b.jsxs)("select",{value:a.type,onChange:a=>{var b,d;let e;return b="type",d=a.target.value,e=[...I],void(e[c]={...e[c],type:d,config:{}},J(e))},className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select action..."}),T.map(a=>(0,b.jsx)("option",{value:a.type,children:a.label},a.type))]}),(0,b.jsx)("button",{onClick:()=>{J(I.filter((a,b)=>b!==c))},className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:(0,b.jsx)(x.X,{className:"w-4 h-4"})})]}),"set_order_tag"===a.type&&(0,b.jsx)("input",{type:"text",value:a.config.tag||"",onChange:a=>ar(c,"tag",a.target.value),placeholder:"Tag name (e.g., PRIORITY, FRAGILE)",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),"set_priority"===a.type&&(0,b.jsxs)("select",{value:a.config.priority||"",onChange:a=>ar(c,"priority",a.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select priority..."}),V.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),"assign_carrier"===a.type&&(0,b.jsxs)("select",{value:a.config.carrier||"",onChange:a=>ar(c,"carrier",a.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select carrier..."}),W.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),"assign_service"===a.type&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("select",{value:a.config.carrier||"",onChange:a=>ar(c,"carrier",a.target.value),className:"bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Carrier..."}),W.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),(0,b.jsxs)("select",{value:a.config.service||"",onChange:a=>ar(c,"service",a.target.value),className:"bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Service..."}),(X[a.config.carrier]||[]).map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]})]}),"select_box"===a.type&&(0,b.jsxs)("select",{value:a.config.boxId||"",onChange:a=>ar(c,"boxId",a.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select box..."}),l.boxes.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),"add_fulfillment_item"===a.type&&(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("select",{value:a.config.productId||"",onChange:a=>ar(c,"productId",a.target.value),className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select product..."}),l.products.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.sku,")"]},a.id))]}),(0,b.jsx)("input",{type:"number",min:1,value:a.config.quantity||1,onChange:a=>ar(c,"quantity",parseInt(a.target.value)||1),className:"w-20 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50"})]}),"send_notification"===a.type&&(0,b.jsx)("input",{type:"text",value:a.config.message||"",onChange:a=>ar(c,"message",a.target.value),placeholder:"Notification message...",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),"create_po_draft"===a.type&&(0,b.jsx)("input",{type:"number",min:1,value:a.config.quantity||100,onChange:a=>ar(c,"quantity",parseInt(a.target.value)||100),placeholder:"Quantity to order...",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),"send_email"===a.type&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("input",{type:"email",value:a.config.recipient||"",onChange:a=>ar(c,"recipient",a.target.value),placeholder:"Recipient email...",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"}),(0,b.jsx)("input",{type:"text",value:a.config.subject||"",onChange:a=>ar(c,"subject",a.target.value),placeholder:"Email subject...",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"})]}),"set_location"===a.type&&(0,b.jsxs)("select",{value:a.config.locationId||"",onChange:a=>ar(c,"locationId",a.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500/50",children:[(0,b.jsx)("option",{value:"",children:"Select location..."}),l.locations.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]},a.id)})})]});case"review":return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center pb-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-emerald-500/20 flex items-center justify-center mx-auto mb-3",children:(0,b.jsx)(s.Check,{className:"w-8 h-8 text-emerald-400"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-white",children:"Review Your Rule"}),(0,b.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Make sure everything looks correct"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-lg font-medium text-white",children:t}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs ${y?"bg-emerald-500/20 text-emerald-400":"bg-slate-600/50 text-slate-400"}`,children:y?"Active":"Disabled"})]}),v&&(0,b.jsx)("p",{className:"text-sm text-slate-400",children:v})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 uppercase mb-2",children:"Trigger"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(L,{className:"w-4 h-4 text-emerald-400"}),(0,b.jsx)("span",{className:"text-white",children:Y(as())})]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 uppercase mb-2",children:"Conditions"}),0===F.length?(0,b.jsx)("span",{className:"text-slate-400 text-sm",children:"No conditions (runs for all matching triggers)"}):(0,b.jsx)("div",{className:"space-y-1",children:F.map((a,c)=>{let d=at().find(b=>b.value===a.field);return(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[c>0&&(0,b.jsx)("span",{className:"text-slate-500",children:"AND"}),(0,b.jsx)("span",{className:"text-white",children:d?.label||a.field}),(0,b.jsx)("span",{className:"text-slate-400",children:a.operator.replace("_"," ")}),(0,b.jsx)("span",{className:"text-emerald-400",children:String(a.value)})]},a.id)})})]}),(0,b.jsxs)("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"text-xs text-slate-500 uppercase mb-2",children:["Actions (",I.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:I.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)(C.Play,{className:"w-3 h-3 text-emerald-400"}),(0,b.jsx)("span",{className:"text-white",children:Z(a)})]},a.id))})]})]})]});default:return null}})()]})}a.s(["AutomationRuleModal",()=>aq],67668),a.i(11840),af.Tag,K.Box,af.Tag,q.Package,J.Truck,a.s([],94660)}];

//# sourceMappingURL=components_modals_index_ts_740fb980._.js.map