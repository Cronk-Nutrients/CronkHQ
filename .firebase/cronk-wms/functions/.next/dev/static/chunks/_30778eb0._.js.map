{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps } from 'firebase/app'\nimport { getAuth, connectAuthEmulator } from 'firebase/auth'\nimport { getFirestore, connectFirestoreEmulator } from 'firebase/firestore'\nimport { getStorage } from 'firebase/storage'\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY || \"AIzaSyCWksF-L5FQkrEXbviMVadKHni-smNdeWo\",\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN || \"cronk-wms.firebaseapp.com\",\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID || \"cronk-wms\",\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET || \"cronk-wms.firebasestorage.app\",\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID || \"1085255099980\",\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID || \"1:1085255099980:web:ce50bce603dc23560a76e9\",\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID || \"G-DGHP1Y66PT\",\n}\n\n// Initialize Firebase only once\nconst app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0]\n\nexport const auth = getAuth(app)\nexport const db = getFirestore(app)\nexport const storage = getStorage(app)\n\n// Use emulators in development (optional)\nif (process.env.NODE_ENV === 'development' && process.env.NEXT_PUBLIC_USE_EMULATORS === 'true') {\n  connectAuthEmulator(auth, 'http://localhost:9099')\n  connectFirestoreEmulator(db, 'localhost', 8080)\n}\n\nexport default app\n"],"names":[],"mappings":";;;;;;;;;;AAMU;AANV;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ,+EAA4C;IACpD,YAAY,iEAAgD;IAC5D,WAAW,iDAA+C;IAC1D,eAAe,qEAAmD;IAClE,mBAAmB,qDAAwD;IAC3E,OAAO,kFAA2C;IAClD,eAAe,oDAAmD;AACpE;AAEA,gCAAgC;AAChC,MAAM,MAAM,IAAA,8KAAO,IAAG,MAAM,KAAK,IAAI,IAAA,oLAAa,EAAC,kBAAkB,IAAA,8KAAO,GAAE,CAAC,EAAE;AAE1E,MAAM,OAAO,IAAA,wKAAO,EAAC;AACrB,MAAM,KAAK,IAAA,kLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8KAAU,EAAC;AAElC,0CAA0C;AAC1C,IAAI,oDAAyB,iBAAiB,2KAAO,CAAC,GAAG,CAAC,yBAAyB,KAAK,QAAQ;IAC9F,IAAA,oLAAmB,EAAC,MAAM;IAC1B,IAAA,8LAAwB,EAAC,IAAI,aAAa;AAC5C;uCAEe"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/context/AuthContext.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react'\nimport {\n  User,\n  signInWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n  sendPasswordResetEmail,\n  updateProfile,\n  createUserWithEmailAndPassword,\n} from 'firebase/auth'\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore'\nimport { auth, db } from '@/lib/firebase'\n\n// Demo account credentials\nconst DEMO_EMAIL = 'demo@cronknutrients.com'\nconst DEMO_PASSWORD = 'demo1234'\n\nexport interface UserProfile {\n  uid: string\n  email: string | null\n  displayName: string | null\n  photoURL: string | null\n  role: 'admin' | 'warehouse' | 'viewer'\n  company?: string\n  organizationId?: string // Organization this user belongs to\n  organizations?: string[] // All organizations user is a member of\n  createdAt?: Date\n  lastLoginAt?: Date\n  isDemo?: boolean\n}\n\ninterface AuthContextType {\n  user: User | null\n  userProfile: UserProfile | null\n  loading: boolean\n  error: string | null\n  isDemo: boolean\n  login: (email: string, password: string, rememberMe?: boolean) => Promise<void>\n  logout: () => Promise<void>\n  register: (email: string, password: string, displayName: string) => Promise<void>\n  resetPassword: (email: string) => Promise<void>\n  updateUserProfile: (data: Partial<UserProfile>) => Promise<void>\n  clearError: () => void\n  /** For demo mode: switch between different roles to test permissions */\n  setDemoRole: (role: 'admin' | 'warehouse' | 'viewer') => void\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\n// Demo user profile (mock)\nconst DEMO_USER_PROFILE: UserProfile = {\n  uid: 'demo-user-id',\n  email: DEMO_EMAIL,\n  displayName: 'Demo User',\n  photoURL: null,\n  role: 'admin',\n  company: 'Cronk Nutrients (Demo)',\n  organizationId: 'demo-org-id',\n  organizations: ['demo-org-id'],\n  isDemo: true,\n}\n\n// Create a mock User object for demo mode\nconst createDemoUser = (): User => ({\n  uid: 'demo-user-id',\n  email: DEMO_EMAIL,\n  emailVerified: true,\n  displayName: 'Demo User',\n  photoURL: null,\n  isAnonymous: false,\n  metadata: {} as User['metadata'],\n  providerData: [],\n  refreshToken: '',\n  tenantId: null,\n  phoneNumber: null,\n  providerId: 'demo',\n  delete: async () => {},\n  getIdToken: async () => 'demo-token',\n  getIdTokenResult: async () => ({} as any),\n  reload: async () => {},\n  toJSON: () => ({}),\n}) as User\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [userProfile, setUserProfile] = useState<UserProfile | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [isDemo, setIsDemo] = useState(false)\n\n  // Check for persisted demo session on mount\n  useEffect(() => {\n    const demoSession = typeof window !== 'undefined' ? localStorage.getItem('demo_session') : null\n    if (demoSession === 'true') {\n      setUser(createDemoUser())\n      setUserProfile(DEMO_USER_PROFILE)\n      setIsDemo(true)\n      setLoading(false)\n    }\n  }, [])\n\n  // Fetch user profile from Firestore\n  const fetchUserProfile = async (uid: string): Promise<UserProfile | null> => {\n    try {\n      const userDoc = await getDoc(doc(db, 'users', uid))\n      if (userDoc.exists()) {\n        return userDoc.data() as UserProfile\n      }\n      return null\n    } catch (err) {\n      console.error('Error fetching user profile:', err)\n      return null\n    }\n  }\n\n  // Create or update user profile in Firestore\n  const createOrUpdateUserProfile = async (user: User, additionalData?: Partial<UserProfile>) => {\n    const userRef = doc(db, 'users', user.uid)\n    const userDoc = await getDoc(userRef)\n\n    if (!userDoc.exists()) {\n      // Create new user profile\n      const newProfile: UserProfile = {\n        uid: user.uid,\n        email: user.email,\n        displayName: user.displayName || additionalData?.displayName || null,\n        photoURL: user.photoURL,\n        role: 'admin', // Default role - first user is admin\n        createdAt: new Date(),\n        lastLoginAt: new Date(),\n        ...additionalData,\n      }\n      await setDoc(userRef, {\n        ...newProfile,\n        createdAt: serverTimestamp(),\n        lastLoginAt: serverTimestamp(),\n      })\n      return newProfile\n    } else {\n      // Update last login\n      await setDoc(userRef, { lastLoginAt: serverTimestamp() }, { merge: true })\n      return userDoc.data() as UserProfile\n    }\n  }\n\n  // Listen for auth state changes (only for non-demo users)\n  useEffect(() => {\n    // Skip Firebase listener if in demo mode\n    if (isDemo) return\n\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      // Don't override demo session\n      const demoSession = typeof window !== 'undefined' ? localStorage.getItem('demo_session') : null\n      if (demoSession === 'true') return\n\n      setUser(firebaseUser)\n\n      if (firebaseUser) {\n        const profile = await fetchUserProfile(firebaseUser.uid)\n        if (profile) {\n          setUserProfile(profile)\n        } else {\n          // Create profile if doesn't exist\n          const newProfile = await createOrUpdateUserProfile(firebaseUser)\n          setUserProfile(newProfile)\n        }\n      } else {\n        setUserProfile(null)\n      }\n\n      setLoading(false)\n    })\n\n    return () => unsubscribe()\n  }, [isDemo])\n\n  // Login\n  const login = async (email: string, password: string, rememberMe: boolean = true) => {\n    try {\n      setError(null)\n      setLoading(true)\n\n      // Check for demo login\n      if (email.toLowerCase() === DEMO_EMAIL && password === DEMO_PASSWORD) {\n        // Demo mode - no Firebase auth needed\n        setUser(createDemoUser())\n        setUserProfile(DEMO_USER_PROFILE)\n        setIsDemo(true)\n        if (typeof window !== 'undefined') {\n          localStorage.setItem('demo_session', 'true')\n        }\n        setLoading(false)\n        return\n      }\n\n      // Regular Firebase login\n      const result = await signInWithEmailAndPassword(auth, email, password)\n\n      // Update last login in Firestore\n      await createOrUpdateUserProfile(result.user)\n      setIsDemo(false)\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem('demo_session')\n      }\n\n    } catch (err: unknown) {\n      const errorMessage = getAuthErrorMessage((err as { code?: string }).code || '')\n      setError(errorMessage)\n      throw new Error(errorMessage)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Logout\n  const logout = async () => {\n    try {\n      setError(null)\n\n      // Clear demo session if active\n      if (isDemo) {\n        if (typeof window !== 'undefined') {\n          localStorage.removeItem('demo_session')\n        }\n        setUser(null)\n        setUserProfile(null)\n        setIsDemo(false)\n        return\n      }\n\n      // Regular Firebase logout\n      await signOut(auth)\n      setUser(null)\n      setUserProfile(null)\n    } catch (err) {\n      setError('Failed to log out. Please try again.')\n      throw err\n    }\n  }\n\n  // Register new user\n  const register = async (email: string, password: string, displayName: string) => {\n    try {\n      setError(null)\n      setLoading(true)\n\n      const result = await createUserWithEmailAndPassword(auth, email, password)\n\n      // Update display name\n      await updateProfile(result.user, { displayName })\n\n      // Create user profile in Firestore\n      await createOrUpdateUserProfile(result.user, { displayName })\n\n    } catch (err: unknown) {\n      const errorMessage = getAuthErrorMessage((err as { code?: string }).code || '')\n      setError(errorMessage)\n      throw new Error(errorMessage)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Reset password\n  const resetPassword = async (email: string) => {\n    try {\n      setError(null)\n      await sendPasswordResetEmail(auth, email)\n    } catch (err: unknown) {\n      const errorMessage = getAuthErrorMessage((err as { code?: string }).code || '')\n      setError(errorMessage)\n      throw new Error(errorMessage)\n    }\n  }\n\n  // Update user profile\n  const updateUserProfile = async (data: Partial<UserProfile>) => {\n    if (!user) throw new Error('No user logged in')\n\n    // Demo users can't update profile in Firestore\n    if (isDemo) {\n      setUserProfile(prev => prev ? { ...prev, ...data } : null)\n      return\n    }\n\n    try {\n      setError(null)\n      const userRef = doc(db, 'users', user.uid)\n      await setDoc(userRef, data, { merge: true })\n\n      // Update local state\n      setUserProfile(prev => prev ? { ...prev, ...data } : null)\n\n      // Update Firebase Auth profile if name changed\n      if (data.displayName) {\n        await updateProfile(user, { displayName: data.displayName })\n      }\n    } catch (err) {\n      setError('Failed to update profile')\n      throw err\n    }\n  }\n\n  // Clear error\n  const clearError = () => setError(null)\n\n  // Set demo role (for testing permissions)\n  const setDemoRole = (role: 'admin' | 'warehouse' | 'viewer') => {\n    if (isDemo && userProfile) {\n      setUserProfile({ ...userProfile, role })\n    }\n  }\n\n  const value = {\n    user,\n    userProfile,\n    loading,\n    error,\n    isDemo,\n    login,\n    logout,\n    register,\n    resetPassword,\n    updateUserProfile,\n    clearError,\n    setDemoRole,\n  }\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\n// Hook to use auth context\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n\n// Helper to get user-friendly error messages\nfunction getAuthErrorMessage(code: string): string {\n  switch (code) {\n    case 'auth/user-not-found':\n      return 'No account found with this email address.'\n    case 'auth/wrong-password':\n      return 'Incorrect password. Please try again.'\n    case 'auth/invalid-email':\n      return 'Please enter a valid email address.'\n    case 'auth/email-already-in-use':\n      return 'An account with this email already exists.'\n    case 'auth/weak-password':\n      return 'Password should be at least 6 characters.'\n    case 'auth/too-many-requests':\n      return 'Too many failed attempts. Please try again later.'\n    case 'auth/network-request-failed':\n      return 'Network error. Please check your connection.'\n    case 'auth/invalid-credential':\n      return 'Invalid email or password.'\n    default:\n      return 'An error occurred. Please try again.'\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/types/organization.ts"],"sourcesContent":["// Organization Types for Multi-Tenant Architecture\n\nexport type PlanType = 'free' | 'starter' | 'professional' | 'enterprise';\nexport type MemberRole = 'owner' | 'admin' | 'manager' | 'staff' | 'viewer';\nexport type InviteStatus = 'pending' | 'accepted' | 'expired' | 'revoked';\n\nexport interface PlanLimits {\n  users: number;\n  products: number;\n  ordersPerMonth: number;\n  locations: number;\n}\n\nexport interface OrganizationSettings {\n  timezone: string;\n  currency: string;\n  dateFormat: string;\n  autoJoinDomain?: boolean; // Allow users with matching domain to auto-join\n  requireApproval?: boolean; // Require admin approval for new members\n  defaultMemberRole: MemberRole;\n}\n\nexport interface Organization {\n  id: string;\n  name: string;\n  slug: string; // URL-friendly identifier (unique)\n  domain?: string; // Company email domain for auto-join\n  logo?: string;\n  plan: PlanType;\n  planLimits: PlanLimits;\n  settings: OrganizationSettings;\n  createdAt: Date;\n  updatedAt: Date;\n  ownerId: string; // User ID of the organization owner\n}\n\nexport interface OrganizationMember {\n  id: string;\n  organizationId: string;\n  userId: string;\n  email: string;\n  displayName?: string;\n  role: MemberRole;\n  invitedBy?: string; // User ID who invited this member\n  joinedAt: Date;\n  lastActiveAt?: Date;\n}\n\nexport interface OrganizationInvite {\n  id: string;\n  organizationId: string;\n  email: string;\n  role: MemberRole;\n  invitedBy: string; // User ID\n  invitedByName?: string;\n  organizationName?: string;\n  status: InviteStatus;\n  expiresAt: Date;\n  createdAt: Date;\n  acceptedAt?: Date;\n  token: string; // Unique token for accepting invite\n}\n\n// Extended user profile with organization info\nexport interface UserWithOrg {\n  id: string;\n  email: string;\n  displayName?: string;\n  organizationId?: string; // Current/primary organization\n  organizations?: string[]; // All organizations user belongs to\n  currentOrgRole?: MemberRole;\n}\n\n// Default plan limits by plan type\nexport const PLAN_LIMITS: Record<PlanType, PlanLimits> = {\n  free: {\n    users: 1,\n    products: 50,\n    ordersPerMonth: 100,\n    locations: 1,\n  },\n  starter: {\n    users: 3,\n    products: 500,\n    ordersPerMonth: 1000,\n    locations: 2,\n  },\n  professional: {\n    users: 10,\n    products: 5000,\n    ordersPerMonth: 10000,\n    locations: 5,\n  },\n  enterprise: {\n    users: -1, // Unlimited\n    products: -1,\n    ordersPerMonth: -1,\n    locations: -1,\n  },\n};\n\n// Default organization settings\nexport const DEFAULT_ORG_SETTINGS: OrganizationSettings = {\n  timezone: 'America/Chicago',\n  currency: 'USD',\n  dateFormat: 'MM/DD/YYYY',\n  autoJoinDomain: false,\n  requireApproval: false,\n  defaultMemberRole: 'staff',\n};\n\n// Role permissions\nexport interface RolePermissions {\n  canManageOrganization: boolean;\n  canManageMembers: boolean;\n  canManageIntegrations: boolean;\n  canManageProducts: boolean;\n  canManageOrders: boolean;\n  canManageInventory: boolean;\n  canViewReports: boolean;\n  canExportData: boolean;\n}\n\nexport const ROLE_PERMISSIONS: Record<MemberRole, RolePermissions> = {\n  owner: {\n    canManageOrganization: true,\n    canManageMembers: true,\n    canManageIntegrations: true,\n    canManageProducts: true,\n    canManageOrders: true,\n    canManageInventory: true,\n    canViewReports: true,\n    canExportData: true,\n  },\n  admin: {\n    canManageOrganization: true,\n    canManageMembers: true,\n    canManageIntegrations: true,\n    canManageProducts: true,\n    canManageOrders: true,\n    canManageInventory: true,\n    canViewReports: true,\n    canExportData: true,\n  },\n  manager: {\n    canManageOrganization: false,\n    canManageMembers: false,\n    canManageIntegrations: false,\n    canManageProducts: true,\n    canManageOrders: true,\n    canManageInventory: true,\n    canViewReports: true,\n    canExportData: true,\n  },\n  staff: {\n    canManageOrganization: false,\n    canManageMembers: false,\n    canManageIntegrations: false,\n    canManageProducts: false,\n    canManageOrders: true,\n    canManageInventory: true,\n    canViewReports: false,\n    canExportData: false,\n  },\n  viewer: {\n    canManageOrganization: false,\n    canManageMembers: false,\n    canManageIntegrations: false,\n    canManageProducts: false,\n    canManageOrders: false,\n    canManageInventory: false,\n    canViewReports: true,\n    canExportData: false,\n  },\n};\n\n// Helper to check if a role has a specific permission\nexport function hasPermission(role: MemberRole, permission: keyof RolePermissions): boolean {\n  return ROLE_PERMISSIONS[role]?.[permission] ?? false;\n}\n\n// Helper to check if user can perform role assignment\nexport function canAssignRole(assignerRole: MemberRole, targetRole: MemberRole): boolean {\n  const roleHierarchy: MemberRole[] = ['owner', 'admin', 'manager', 'staff', 'viewer'];\n  const assignerIndex = roleHierarchy.indexOf(assignerRole);\n  const targetIndex = roleHierarchy.indexOf(targetRole);\n\n  // Can only assign roles lower than your own (higher index)\n  // Owner can assign any role, admin can assign manager and below, etc.\n  if (assignerRole === 'owner') return true;\n  if (assignerRole === 'admin') return targetIndex > 0; // Can't assign owner\n  return false; // Only owner and admin can assign roles\n}\n\n// Generate a URL-friendly slug from organization name\nexport function generateSlug(name: string): string {\n  return name\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-+|-+$/g, '')\n    .slice(0, 50);\n}\n\n// Generate a unique invite token\nexport function generateInviteToken(): string {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let token = '';\n  for (let i = 0; i < 32; i++) {\n    token += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return token;\n}\n"],"names":[],"mappings":"AAAA,mDAAmD;;;;;;;;;;;;;;;;;AA0E5C,MAAM,cAA4C;IACvD,MAAM;QACJ,OAAO;QACP,UAAU;QACV,gBAAgB;QAChB,WAAW;IACb;IACA,SAAS;QACP,OAAO;QACP,UAAU;QACV,gBAAgB;QAChB,WAAW;IACb;IACA,cAAc;QACZ,OAAO;QACP,UAAU;QACV,gBAAgB;QAChB,WAAW;IACb;IACA,YAAY;QACV,OAAO,CAAC;QACR,UAAU,CAAC;QACX,gBAAgB,CAAC;QACjB,WAAW,CAAC;IACd;AACF;AAGO,MAAM,uBAA6C;IACxD,UAAU;IACV,UAAU;IACV,YAAY;IACZ,gBAAgB;IAChB,iBAAiB;IACjB,mBAAmB;AACrB;AAcO,MAAM,mBAAwD;IACnE,OAAO;QACL,uBAAuB;QACvB,kBAAkB;QAClB,uBAAuB;QACvB,mBAAmB;QACnB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,eAAe;IACjB;IACA,OAAO;QACL,uBAAuB;QACvB,kBAAkB;QAClB,uBAAuB;QACvB,mBAAmB;QACnB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,eAAe;IACjB;IACA,SAAS;QACP,uBAAuB;QACvB,kBAAkB;QAClB,uBAAuB;QACvB,mBAAmB;QACnB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,eAAe;IACjB;IACA,OAAO;QACL,uBAAuB;QACvB,kBAAkB;QAClB,uBAAuB;QACvB,mBAAmB;QACnB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,eAAe;IACjB;IACA,QAAQ;QACN,uBAAuB;QACvB,kBAAkB;QAClB,uBAAuB;QACvB,mBAAmB;QACnB,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;QAChB,eAAe;IACjB;AACF;AAGO,SAAS,cAAc,IAAgB,EAAE,UAAiC;IAC/E,OAAO,gBAAgB,CAAC,KAAK,EAAE,CAAC,WAAW,IAAI;AACjD;AAGO,SAAS,cAAc,YAAwB,EAAE,UAAsB;IAC5E,MAAM,gBAA8B;QAAC;QAAS;QAAS;QAAW;QAAS;KAAS;IACpF,MAAM,gBAAgB,cAAc,OAAO,CAAC;IAC5C,MAAM,cAAc,cAAc,OAAO,CAAC;IAE1C,2DAA2D;IAC3D,sEAAsE;IACtE,IAAI,iBAAiB,SAAS,OAAO;IACrC,IAAI,iBAAiB,SAAS,OAAO,cAAc,GAAG,qBAAqB;IAC3E,OAAO,OAAO,wCAAwC;AACxD;AAGO,SAAS,aAAa,IAAY;IACvC,OAAO,KACJ,WAAW,GACX,OAAO,CAAC,eAAe,KACvB,OAAO,CAAC,YAAY,IACpB,KAAK,CAAC,GAAG;AACd;AAGO,SAAS;IACd,MAAM,QAAQ;IACd,IAAI,QAAQ;IACZ,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;QAC3B,SAAS,MAAM,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,MAAM;IAC/D;IACA,OAAO;AACT"}},
    {"offset": {"line": 548, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/context/OrganizationContext.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useEffect, useState, ReactNode, useCallback } from 'react'\nimport {\n  doc,\n  getDoc,\n  setDoc,\n  collection,\n  query,\n  where,\n  getDocs,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  serverTimestamp,\n  Timestamp,\n  onSnapshot,\n} from 'firebase/firestore'\nimport { db } from '@/lib/firebase'\nimport { useAuth } from './AuthContext'\nimport {\n  Organization,\n  OrganizationMember,\n  OrganizationInvite,\n  MemberRole,\n  PlanType,\n  PLAN_LIMITS,\n  DEFAULT_ORG_SETTINGS,\n  generateSlug,\n  generateInviteToken,\n  hasPermission,\n  RolePermissions,\n  ROLE_PERMISSIONS,\n} from '@/types/organization'\n\n// Demo organization data\nconst DEMO_ORGANIZATION: Organization = {\n  id: 'demo-org-id',\n  name: 'Cronk Nutrients (Demo)',\n  slug: 'cronk-demo',\n  plan: 'enterprise',\n  planLimits: PLAN_LIMITS.enterprise,\n  settings: {\n    ...DEFAULT_ORG_SETTINGS,\n    timezone: 'America/Chicago',\n    currency: 'USD',\n  },\n  createdAt: new Date(),\n  updatedAt: new Date(),\n  ownerId: 'demo-user-id',\n}\n\nconst DEMO_MEMBER: OrganizationMember = {\n  id: 'demo-member-id',\n  organizationId: 'demo-org-id',\n  userId: 'demo-user-id',\n  email: 'demo@cronknutrients.com',\n  displayName: 'Demo User',\n  role: 'owner',\n  joinedAt: new Date(),\n}\n\ninterface OrganizationContextType {\n  // State\n  organization: Organization | null\n  membership: OrganizationMember | null\n  members: OrganizationMember[]\n  invites: OrganizationInvite[]\n  loading: boolean\n  error: string | null\n\n  // Computed\n  isOwner: boolean\n  isAdmin: boolean\n  permissions: RolePermissions | null\n  hasOrganization: boolean\n  needsSetup: boolean\n\n  // Organization management\n  createOrganization: (name: string, plan?: PlanType) => Promise<Organization>\n  updateOrganization: (data: Partial<Organization>) => Promise<void>\n  switchOrganization: (orgId: string) => Promise<void>\n\n  // Member management\n  inviteMember: (email: string, role: MemberRole) => Promise<OrganizationInvite>\n  updateMemberRole: (memberId: string, role: MemberRole) => Promise<void>\n  removeMember: (memberId: string) => Promise<void>\n  revokeInvite: (inviteId: string) => Promise<void>\n\n  // Invite handling\n  checkPendingInvites: (email: string) => Promise<OrganizationInvite[]>\n  acceptInvite: (inviteId: string) => Promise<void>\n  declineInvite: (inviteId: string) => Promise<void>\n\n  // Utilities\n  clearError: () => void\n  refreshOrganization: () => Promise<void>\n}\n\nconst OrganizationContext = createContext<OrganizationContextType | undefined>(undefined)\n\nexport function OrganizationProvider({ children }: { children: ReactNode }) {\n  const { user, userProfile, isDemo, loading: authLoading } = useAuth()\n\n  const [organization, setOrganization] = useState<Organization | null>(null)\n  const [membership, setMembership] = useState<OrganizationMember | null>(null)\n  const [members, setMembers] = useState<OrganizationMember[]>([])\n  const [invites, setInvites] = useState<OrganizationInvite[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  // Computed values\n  const isOwner = membership?.role === 'owner'\n  const isAdmin = membership?.role === 'admin' || membership?.role === 'owner'\n  const permissions = membership ? ROLE_PERMISSIONS[membership.role] : null\n  const hasOrganization = !!organization\n  const needsSetup = !authLoading && !isDemo && !!user && !organization && !loading\n\n  // Clear error\n  const clearError = useCallback(() => setError(null), [])\n\n  // Fetch organization data\n  const fetchOrganization = useCallback(async (orgId: string) => {\n    try {\n      const orgDoc = await getDoc(doc(db, 'organizations', orgId))\n      if (orgDoc.exists()) {\n        const data = orgDoc.data()\n        return {\n          ...data,\n          id: orgDoc.id,\n          createdAt: data.createdAt?.toDate() || new Date(),\n          updatedAt: data.updatedAt?.toDate() || new Date(),\n        } as Organization\n      }\n      return null\n    } catch (err) {\n      console.error('Error fetching organization:', err)\n      return null\n    }\n  }, [])\n\n  // Fetch user's membership\n  const fetchMembership = useCallback(async (userId: string) => {\n    try {\n      const membershipsQuery = query(\n        collection(db, 'organization_members'),\n        where('userId', '==', userId)\n      )\n      const snapshot = await getDocs(membershipsQuery)\n\n      if (!snapshot.empty) {\n        const doc = snapshot.docs[0]\n        const data = doc.data()\n        return {\n          ...data,\n          id: doc.id,\n          joinedAt: data.joinedAt?.toDate() || new Date(),\n          lastActiveAt: data.lastActiveAt?.toDate(),\n        } as OrganizationMember\n      }\n      return null\n    } catch (err) {\n      console.error('Error fetching membership:', err)\n      return null\n    }\n  }, [])\n\n  // Fetch all members of an organization\n  const fetchMembers = useCallback(async (orgId: string) => {\n    try {\n      const membersQuery = query(\n        collection(db, 'organization_members'),\n        where('organizationId', '==', orgId)\n      )\n      const snapshot = await getDocs(membersQuery)\n\n      return snapshot.docs.map(doc => {\n        const data = doc.data()\n        return {\n          ...data,\n          id: doc.id,\n          joinedAt: data.joinedAt?.toDate() || new Date(),\n          lastActiveAt: data.lastActiveAt?.toDate(),\n        } as OrganizationMember\n      })\n    } catch (err) {\n      console.error('Error fetching members:', err)\n      return []\n    }\n  }, [])\n\n  // Fetch pending invites for an organization\n  const fetchInvites = useCallback(async (orgId: string) => {\n    try {\n      const invitesQuery = query(\n        collection(db, 'organization_invites'),\n        where('organizationId', '==', orgId),\n        where('status', '==', 'pending')\n      )\n      const snapshot = await getDocs(invitesQuery)\n\n      return snapshot.docs.map(doc => {\n        const data = doc.data()\n        return {\n          ...data,\n          id: doc.id,\n          createdAt: data.createdAt?.toDate() || new Date(),\n          expiresAt: data.expiresAt?.toDate() || new Date(),\n          acceptedAt: data.acceptedAt?.toDate(),\n        } as OrganizationInvite\n      })\n    } catch (err) {\n      console.error('Error fetching invites:', err)\n      return []\n    }\n  }, [])\n\n  // Initialize organization data\n  useEffect(() => {\n    if (authLoading) return\n\n    // Handle demo mode\n    if (isDemo) {\n      setOrganization(DEMO_ORGANIZATION)\n      setMembership(DEMO_MEMBER)\n      setMembers([DEMO_MEMBER])\n      setInvites([])\n      setLoading(false)\n      return\n    }\n\n    // No user, clear state\n    if (!user) {\n      setOrganization(null)\n      setMembership(null)\n      setMembers([])\n      setInvites([])\n      setLoading(false)\n      return\n    }\n\n    // Fetch user's organization\n    const initOrganization = async () => {\n      setLoading(true)\n      try {\n        // First, find user's membership\n        const userMembership = await fetchMembership(user.uid)\n\n        if (userMembership) {\n          setMembership(userMembership)\n\n          // Fetch the organization\n          const org = await fetchOrganization(userMembership.organizationId)\n          if (org) {\n            setOrganization(org)\n\n            // Fetch all members if user has permission\n            if (hasPermission(userMembership.role, 'canManageMembers')) {\n              const orgMembers = await fetchMembers(userMembership.organizationId)\n              setMembers(orgMembers)\n\n              const orgInvites = await fetchInvites(userMembership.organizationId)\n              setInvites(orgInvites)\n            } else {\n              setMembers([userMembership])\n              setInvites([])\n            }\n          }\n        } else {\n          // No membership found - user needs to create or join an org\n          setOrganization(null)\n          setMembership(null)\n          setMembers([])\n          setInvites([])\n        }\n      } catch (err) {\n        console.error('Error initializing organization:', err)\n        setError('Failed to load organization data')\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    initOrganization()\n  }, [user, isDemo, authLoading, fetchMembership, fetchOrganization, fetchMembers, fetchInvites])\n\n  // Create a new organization\n  const createOrganization = useCallback(async (name: string, plan: PlanType = 'free'): Promise<Organization> => {\n    if (!user) throw new Error('Must be logged in to create an organization')\n    if (isDemo) throw new Error('Cannot create organization in demo mode')\n\n    try {\n      setError(null)\n\n      // Generate unique slug\n      let slug = generateSlug(name)\n      let slugExists = true\n      let attempts = 0\n\n      while (slugExists && attempts < 10) {\n        const slugQuery = query(\n          collection(db, 'organizations'),\n          where('slug', '==', slug)\n        )\n        const slugSnapshot = await getDocs(slugQuery)\n        slugExists = !slugSnapshot.empty\n\n        if (slugExists) {\n          slug = `${generateSlug(name)}-${Math.random().toString(36).substring(2, 6)}`\n          attempts++\n        }\n      }\n\n      // Create organization\n      const orgData = {\n        name,\n        slug,\n        plan,\n        planLimits: PLAN_LIMITS[plan],\n        settings: DEFAULT_ORG_SETTINGS,\n        ownerId: user.uid,\n        createdAt: serverTimestamp(),\n        updatedAt: serverTimestamp(),\n      }\n\n      const orgRef = await addDoc(collection(db, 'organizations'), orgData)\n\n      // Create owner membership\n      const displayName = userProfile?.displayName || user.displayName || null\n      const memberData = {\n        organizationId: orgRef.id,\n        userId: user.uid,\n        email: user.email || '',\n        ...(displayName && { displayName }),\n        role: 'owner' as MemberRole,\n        joinedAt: serverTimestamp(),\n      }\n\n      await addDoc(collection(db, 'organization_members'), memberData)\n\n      // Update user document with organizationId\n      await setDoc(doc(db, 'users', user.uid), {\n        organizationId: orgRef.id,\n      }, { merge: true })\n\n      const newOrg: Organization = {\n        ...orgData,\n        id: orgRef.id,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n      }\n\n      const newMember: OrganizationMember = {\n        ...memberData,\n        id: 'temp-id',\n        displayName: displayName || '',\n        joinedAt: new Date(),\n      }\n\n      setOrganization(newOrg)\n      setMembership(newMember)\n      setMembers([newMember])\n\n      return newOrg\n    } catch (err) {\n      console.error('Error creating organization:', err)\n      setError('Failed to create organization')\n      throw err\n    }\n  }, [user, userProfile, isDemo])\n\n  // Update organization\n  const updateOrganization = useCallback(async (data: Partial<Organization>) => {\n    if (!organization || !membership) throw new Error('No organization')\n    if (!hasPermission(membership.role, 'canManageOrganization')) {\n      throw new Error('Insufficient permissions')\n    }\n    if (isDemo) throw new Error('Cannot update organization in demo mode')\n\n    try {\n      setError(null)\n\n      await updateDoc(doc(db, 'organizations', organization.id), {\n        ...data,\n        updatedAt: serverTimestamp(),\n      })\n\n      setOrganization(prev => prev ? { ...prev, ...data, updatedAt: new Date() } : null)\n    } catch (err) {\n      console.error('Error updating organization:', err)\n      setError('Failed to update organization')\n      throw err\n    }\n  }, [organization, membership, isDemo])\n\n  // Switch organization (for users with multiple orgs)\n  const switchOrganization = useCallback(async (orgId: string) => {\n    if (!user) throw new Error('Must be logged in')\n    if (isDemo) throw new Error('Cannot switch organization in demo mode')\n\n    try {\n      setLoading(true)\n      setError(null)\n\n      // Verify user is a member of this org\n      const memberQuery = query(\n        collection(db, 'organization_members'),\n        where('organizationId', '==', orgId),\n        where('userId', '==', user.uid)\n      )\n      const memberSnapshot = await getDocs(memberQuery)\n\n      if (memberSnapshot.empty) {\n        throw new Error('You are not a member of this organization')\n      }\n\n      // Fetch the new organization\n      const org = await fetchOrganization(orgId)\n      if (!org) throw new Error('Organization not found')\n\n      const memberDoc = memberSnapshot.docs[0]\n      const memberData = memberDoc.data()\n      const newMembership: OrganizationMember = {\n        ...memberData,\n        id: memberDoc.id,\n        joinedAt: memberData.joinedAt?.toDate() || new Date(),\n      } as OrganizationMember\n\n      // Update user's current organization\n      await setDoc(doc(db, 'users', user.uid), {\n        organizationId: orgId,\n      }, { merge: true })\n\n      setOrganization(org)\n      setMembership(newMembership)\n\n      // Fetch members if permitted\n      if (hasPermission(newMembership.role, 'canManageMembers')) {\n        const orgMembers = await fetchMembers(orgId)\n        setMembers(orgMembers)\n\n        const orgInvites = await fetchInvites(orgId)\n        setInvites(orgInvites)\n      } else {\n        setMembers([newMembership])\n        setInvites([])\n      }\n    } catch (err) {\n      console.error('Error switching organization:', err)\n      setError('Failed to switch organization')\n      throw err\n    } finally {\n      setLoading(false)\n    }\n  }, [user, isDemo, fetchOrganization, fetchMembers, fetchInvites])\n\n  // Invite a member\n  const inviteMember = useCallback(async (email: string, role: MemberRole): Promise<OrganizationInvite> => {\n    if (!organization || !membership || !user) throw new Error('No organization')\n    if (!hasPermission(membership.role, 'canManageMembers')) {\n      throw new Error('Insufficient permissions')\n    }\n    if (isDemo) throw new Error('Cannot invite members in demo mode')\n\n    try {\n      setError(null)\n\n      // Check if user is already a member\n      const existingMemberQuery = query(\n        collection(db, 'organization_members'),\n        where('organizationId', '==', organization.id),\n        where('email', '==', email.toLowerCase())\n      )\n      const existingMember = await getDocs(existingMemberQuery)\n      if (!existingMember.empty) {\n        throw new Error('User is already a member')\n      }\n\n      // Check for existing pending invite\n      const existingInviteQuery = query(\n        collection(db, 'organization_invites'),\n        where('organizationId', '==', organization.id),\n        where('email', '==', email.toLowerCase()),\n        where('status', '==', 'pending')\n      )\n      const existingInvite = await getDocs(existingInviteQuery)\n      if (!existingInvite.empty) {\n        throw new Error('An invitation is already pending for this email')\n      }\n\n      // Create invite\n      const invitedByName = userProfile?.displayName || user.displayName || null\n      const inviteData = {\n        organizationId: organization.id,\n        email: email.toLowerCase(),\n        role,\n        invitedBy: user.uid,\n        ...(invitedByName && { invitedByName }),\n        organizationName: organization.name,\n        status: 'pending' as const,\n        token: generateInviteToken(),\n        createdAt: serverTimestamp(),\n        expiresAt: Timestamp.fromDate(new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)), // 7 days\n      }\n\n      const inviteRef = await addDoc(collection(db, 'organization_invites'), inviteData)\n\n      const newInvite: OrganizationInvite = {\n        ...inviteData,\n        id: inviteRef.id,\n        createdAt: new Date(),\n        expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\n      }\n\n      setInvites(prev => [...prev, newInvite])\n\n      return newInvite\n    } catch (err) {\n      console.error('Error inviting member:', err)\n      setError(err instanceof Error ? err.message : 'Failed to send invitation')\n      throw err\n    }\n  }, [organization, membership, user, userProfile, isDemo])\n\n  // Update member role\n  const updateMemberRole = useCallback(async (memberId: string, role: MemberRole) => {\n    if (!organization || !membership) throw new Error('No organization')\n    if (!hasPermission(membership.role, 'canManageMembers')) {\n      throw new Error('Insufficient permissions')\n    }\n    if (isDemo) throw new Error('Cannot update members in demo mode')\n\n    try {\n      setError(null)\n\n      await updateDoc(doc(db, 'organization_members', memberId), { role })\n\n      setMembers(prev =>\n        prev.map(m => m.id === memberId ? { ...m, role } : m)\n      )\n    } catch (err) {\n      console.error('Error updating member role:', err)\n      setError('Failed to update member role')\n      throw err\n    }\n  }, [organization, membership, isDemo])\n\n  // Remove member\n  const removeMember = useCallback(async (memberId: string) => {\n    if (!organization || !membership) throw new Error('No organization')\n    if (!hasPermission(membership.role, 'canManageMembers')) {\n      throw new Error('Insufficient permissions')\n    }\n    if (isDemo) throw new Error('Cannot remove members in demo mode')\n\n    try {\n      setError(null)\n\n      // Get the member being removed\n      const memberToRemove = members.find(m => m.id === memberId)\n      if (memberToRemove?.role === 'owner') {\n        throw new Error('Cannot remove the organization owner')\n      }\n\n      await deleteDoc(doc(db, 'organization_members', memberId))\n\n      setMembers(prev => prev.filter(m => m.id !== memberId))\n    } catch (err) {\n      console.error('Error removing member:', err)\n      setError(err instanceof Error ? err.message : 'Failed to remove member')\n      throw err\n    }\n  }, [organization, membership, members, isDemo])\n\n  // Revoke invite\n  const revokeInvite = useCallback(async (inviteId: string) => {\n    if (!organization || !membership) throw new Error('No organization')\n    if (!hasPermission(membership.role, 'canManageMembers')) {\n      throw new Error('Insufficient permissions')\n    }\n    if (isDemo) throw new Error('Cannot revoke invites in demo mode')\n\n    try {\n      setError(null)\n\n      await updateDoc(doc(db, 'organization_invites', inviteId), {\n        status: 'revoked',\n      })\n\n      setInvites(prev => prev.filter(i => i.id !== inviteId))\n    } catch (err) {\n      console.error('Error revoking invite:', err)\n      setError('Failed to revoke invitation')\n      throw err\n    }\n  }, [organization, membership, isDemo])\n\n  // Check for pending invites for an email\n  const checkPendingInvites = useCallback(async (email: string): Promise<OrganizationInvite[]> => {\n    try {\n      const invitesQuery = query(\n        collection(db, 'organization_invites'),\n        where('email', '==', email.toLowerCase()),\n        where('status', '==', 'pending')\n      )\n      const snapshot = await getDocs(invitesQuery)\n\n      return snapshot.docs.map(doc => {\n        const data = doc.data()\n        return {\n          ...data,\n          id: doc.id,\n          createdAt: data.createdAt?.toDate() || new Date(),\n          expiresAt: data.expiresAt?.toDate() || new Date(),\n        } as OrganizationInvite\n      }).filter(invite => invite.expiresAt > new Date())\n    } catch (err) {\n      console.error('Error checking invites:', err)\n      return []\n    }\n  }, [])\n\n  // Accept invite\n  const acceptInvite = useCallback(async (inviteId: string) => {\n    if (!user) throw new Error('Must be logged in')\n    if (isDemo) throw new Error('Cannot accept invites in demo mode')\n\n    try {\n      setLoading(true)\n      setError(null)\n\n      // Get the invite\n      const inviteDoc = await getDoc(doc(db, 'organization_invites', inviteId))\n      if (!inviteDoc.exists()) throw new Error('Invite not found')\n\n      const invite = inviteDoc.data()\n      if (invite.status !== 'pending') throw new Error('Invite is no longer valid')\n      if (invite.email !== user.email?.toLowerCase()) throw new Error('This invite is for a different email')\n      if (invite.expiresAt.toDate() < new Date()) throw new Error('Invite has expired')\n\n      // Create membership\n      const displayName = userProfile?.displayName || user.displayName || null\n      const memberData = {\n        organizationId: invite.organizationId,\n        userId: user.uid,\n        email: user.email,\n        ...(displayName && { displayName }),\n        role: invite.role,\n        invitedBy: invite.invitedBy,\n        joinedAt: serverTimestamp(),\n      }\n\n      await addDoc(collection(db, 'organization_members'), memberData)\n\n      // Update invite status\n      await updateDoc(doc(db, 'organization_invites', inviteId), {\n        status: 'accepted',\n        acceptedAt: serverTimestamp(),\n      })\n\n      // Update user's organization\n      await setDoc(doc(db, 'users', user.uid), {\n        organizationId: invite.organizationId,\n      }, { merge: true })\n\n      // Fetch the organization\n      const org = await fetchOrganization(invite.organizationId)\n      if (org) {\n        setOrganization(org)\n        setMembership({\n          ...memberData,\n          id: 'new-member',\n          displayName: displayName || '',\n          joinedAt: new Date(),\n        } as OrganizationMember)\n      }\n    } catch (err) {\n      console.error('Error accepting invite:', err)\n      setError(err instanceof Error ? err.message : 'Failed to accept invitation')\n      throw err\n    } finally {\n      setLoading(false)\n    }\n  }, [user, userProfile, isDemo, fetchOrganization])\n\n  // Decline invite\n  const declineInvite = useCallback(async (inviteId: string) => {\n    if (isDemo) throw new Error('Cannot decline invites in demo mode')\n\n    try {\n      setError(null)\n\n      await updateDoc(doc(db, 'organization_invites', inviteId), {\n        status: 'revoked',\n      })\n    } catch (err) {\n      console.error('Error declining invite:', err)\n      setError('Failed to decline invitation')\n      throw err\n    }\n  }, [isDemo])\n\n  // Refresh organization data\n  const refreshOrganization = useCallback(async () => {\n    if (!organization || isDemo) return\n\n    try {\n      setLoading(true)\n      const org = await fetchOrganization(organization.id)\n      if (org) setOrganization(org)\n\n      if (membership && hasPermission(membership.role, 'canManageMembers')) {\n        const orgMembers = await fetchMembers(organization.id)\n        setMembers(orgMembers)\n\n        const orgInvites = await fetchInvites(organization.id)\n        setInvites(orgInvites)\n      }\n    } catch (err) {\n      console.error('Error refreshing organization:', err)\n    } finally {\n      setLoading(false)\n    }\n  }, [organization, membership, isDemo, fetchOrganization, fetchMembers, fetchInvites])\n\n  const value: OrganizationContextType = {\n    // State\n    organization,\n    membership,\n    members,\n    invites,\n    loading,\n    error,\n\n    // Computed\n    isOwner,\n    isAdmin,\n    permissions,\n    hasOrganization,\n    needsSetup,\n\n    // Organization management\n    createOrganization,\n    updateOrganization,\n    switchOrganization,\n\n    // Member management\n    inviteMember,\n    updateMemberRole,\n    removeMember,\n    revokeInvite,\n\n    // Invite handling\n    checkPendingInvites,\n    acceptInvite,\n    declineInvite,\n\n    // Utilities\n    clearError,\n    refreshOrganization,\n  }\n\n  return (\n    <OrganizationContext.Provider value={value}>\n      {children}\n    </OrganizationContext.Provider>\n  )\n}\n\n// Hook to use organization context\nexport function useOrganization() {\n  const context = useContext(OrganizationContext)\n  if (context === undefined) {\n    throw new Error('useOrganization must be used within an OrganizationProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1313, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/context/AppContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useReducer, useEffect, ReactNode } from 'react';\nimport { useAuth } from '@/context/AuthContext';\n\n// Types\n// Component for product manufacturing BOM\nexport interface ProductComponent {\n  productId: string;\n  productName: string;\n  quantity: number;\n}\n\nexport interface ProductVariant {\n  id: string;\n  sku: string;\n  name: string;\n  size?: string;\n  productId: string;\n}\n\nexport interface Product {\n  id: string;\n  name: string;\n  sku: string;\n  barcode?: string;\n  category: string;\n  description?: string;\n  cost: {\n    rolling: number;\n    fixed: number;\n  };\n  prices: {\n    msrp: number;\n    shopify: number;\n    amazon: number;\n    wholesale: number;\n  };\n  weight: {\n    value: number;\n    unit: 'lbs' | 'oz' | 'kg' | 'g';\n  };\n  dimensions?: { length: number; width: number; height: number };\n  reorderPoint: number;\n  supplier?: string;\n  skus?: {\n    shopify?: string;\n    amazon?: string;\n  };\n  imageUrl?: string;\n  // Manufacturing components (BOM) - e.g., front label, back label\n  components?: ProductComponent[];\n  // Case pack quantity for PO ordering\n  casePackQty?: number;\n  // Parent product ID if this is a variant\n  parentProductId?: string;\n  // Variant info (e.g., size)\n  variantInfo?: {\n    size?: string;\n    type?: string;\n  };\n  // Serial number tracking\n  trackSerials?: boolean;\n  serialPrefix?: string;\n  serialNextNumber?: number;\n  serialSuffix?: string;\n  // Lot/batch tracking\n  trackLots?: boolean;\n  expirationTracking?: boolean;\n  expirationWarningDays?: number;\n  lotPrefix?: string;\n  lotNextNumber?: number;\n  // Supplier\n  primarySupplierId?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Serial Number Tracking Types\nexport interface SerialNumber {\n  id: string;\n  serial: string;\n  productId: string;\n  productName: string;\n  sku: string;\n  status: 'in_stock' | 'reserved' | 'sold' | 'returned' | 'damaged';\n  locationId: string;\n  locationName: string;\n  purchaseOrderId?: string;\n  salesOrderId?: string;\n  receivedAt: Date;\n  soldAt?: Date;\n  notes?: string;\n}\n\nexport interface SerialMovement {\n  id: string;\n  serialId: string;\n  serialNumber: string;\n  type: 'received' | 'transferred' | 'sold' | 'returned' | 'adjusted';\n  fromLocationId?: string;\n  fromLocationName?: string;\n  toLocationId?: string;\n  toLocationName?: string;\n  orderId?: string;\n  poId?: string;\n  notes?: string;\n  createdAt: Date;\n  createdBy?: string;\n}\n\n// Lot/Batch Tracking Types\nexport interface InventoryLot {\n  id: string;\n  lotNumber: string;\n  productId: string;\n  productName: string;\n  sku: string;\n  quantity: number;\n  reservedQty: number;\n  expirationDate?: Date;\n  manufacturedDate?: Date;\n  receivedDate: Date;\n  status: 'active' | 'quarantine' | 'expired' | 'recalled';\n  locationId: string;\n  locationName: string;\n  purchaseOrderId?: string;\n  supplierLotNumber?: string;\n  notes?: string;\n  cost?: number;\n}\n\nexport interface LotMovement {\n  id: string;\n  lotId: string;\n  lotNumber: string;\n  productId: string;\n  type: 'received' | 'picked' | 'transferred' | 'adjusted' | 'expired' | 'recalled';\n  quantity: number;\n  fromLocationId?: string;\n  fromLocationName?: string;\n  toLocationId?: string;\n  toLocationName?: string;\n  orderId?: string;\n  orderNumber?: string;\n  notes?: string;\n  createdAt: Date;\n  createdBy?: string;\n}\n\n// Supplier Management Types\nexport interface Supplier {\n  id: string;\n  name: string;\n  code: string; // Short code like \"HGC\" for HIGROCORP\n  contactName?: string;\n  email?: string;\n  phone?: string;\n  website?: string;\n  address?: {\n    street: string;\n    city: string;\n    state: string;\n    zip: string;\n    country: string;\n  };\n  currency: 'USD' | 'CAD' | 'EUR' | 'GBP';\n  paymentTerms?: string; // \"Net 30\", \"COD\", etc.\n  leadTimeDays?: number;\n  minimumOrderValue?: number;\n  notes?: string;\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface ProductSupplier {\n  productId: string;\n  supplierId: string;\n  supplierSku?: string; // Supplier's SKU for this product\n  unitCost: number;\n  currency: 'USD' | 'CAD' | 'EUR' | 'GBP';\n  minimumOrderQty?: number;\n  leadTimeDays?: number;\n  isPrimary: boolean;\n  lastOrderedAt?: Date;\n  notes?: string;\n}\n\nexport interface InventoryLevel {\n  productId: string;\n  locationId: string;\n  quantity: number;\n  binLocation?: string;\n  updatedAt: Date;\n}\n\nexport interface Location {\n  id: string;\n  name: string;\n  type: 'warehouse' | 'fba' | 'fbm';\n  address?: string;\n  isDefault: boolean;\n}\n\nexport interface OrderItem {\n  productId: string;\n  productName: string;\n  sku: string;\n  quantity: number;\n  price: number;\n  cost: number;\n  picked?: boolean;\n}\n\nexport interface Order {\n  id: string;\n  orderNumber: string;\n  veeqoId?: string;\n  channel: 'shopify' | 'amazon_fbm' | 'amazon_fba' | 'manual';\n  status: 'draft' | 'to_pick' | 'picking' | 'to_pack' | 'packing' | 'ready' | 'shipped' | 'delivered' | 'cancelled';\n  customer: {\n    name: string;\n    email: string;\n    phone?: string;\n    address: {\n      street: string;\n      city: string;\n      state: string;\n      zip: string;\n      country: string;\n    };\n  };\n  items: OrderItem[];\n  subtotal: number;\n  shipping: number;\n  tax: number;\n  discount: number;\n  total: number;\n  cogs: number;\n  profit: number;\n  margin: number;\n  trackingNumber?: string;\n  carrier?: string;\n  service?: string;\n  shippedAt?: Date;\n  // Picking batch assignment\n  pickingBatchId?: string;\n  // Billing address (can be different from shipping)\n  billingAddress?: {\n    street: string;\n    city: string;\n    state: string;\n    zip: string;\n    country: string;\n  };\n  // Order notes\n  notes?: string;\n  // Automation rule related fields\n  tags?: string[];\n  priority?: 'low' | 'normal' | 'high' | 'urgent';\n  suggestedCarrier?: string;\n  suggestedService?: string;\n  suggestedBoxId?: string;\n  fulfillmentItems?: {\n    productId: string;\n    quantity: number;\n    reason: string;\n  }[];\n  isPrime?: boolean;\n  requiresSignature?: boolean;\n  totalWeight?: number;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface PickingBatch {\n  id: string;\n  batchNumber: string;\n  status: 'open' | 'in_progress' | 'completed';\n  orderIds: string[];\n  assignedTo?: string;\n  createdAt: Date;\n  completedAt?: Date;\n}\n\n// Return types\nexport type ReturnReason =\n  | 'damaged_in_transit'\n  | 'defective'\n  | 'wrong_item_sent'\n  | 'not_as_described'\n  | 'changed_mind'\n  | 'ordered_wrong'\n  | 'arrived_late'\n  | 'better_price_found'\n  | 'other';\n\nexport type ItemCondition =\n  | 'new_sealed'\n  | 'new_opened'\n  | 'like_new'\n  | 'good'\n  | 'damaged'\n  | 'unsellable';\n\nexport interface ReturnItem {\n  productId: string;\n  productName: string;\n  sku: string;\n  quantity: number;\n  quantityReceived: number;\n  reason: ReturnReason;\n  condition?: ItemCondition;\n  refundAmount: number;\n}\n\nexport interface Return {\n  id: string;\n  returnNumber: string;\n  orderId: string;\n  orderNumber: string;\n  channel: 'shopify' | 'amazon_fbm' | 'amazon_fba' | 'manual';\n  status: 'requested' | 'approved' | 'in_transit' | 'received' | 'inspected' | 'refunded' | 'rejected';\n  customer: {\n    name: string;\n    email: string;\n  };\n  items: ReturnItem[];\n  returnShipping: {\n    trackingNumber?: string;\n    carrier?: string;\n    labelUrl?: string;\n  };\n  refund: {\n    subtotal: number;\n    shipping: number;\n    restockingFee: number;\n    total: number;\n    refundedAt?: Date;\n    refundMethod?: 'original_payment' | 'store_credit' | 'manual';\n  };\n  notes?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Stock Count types\nexport interface StockCountItem {\n  productId: string;\n  productName: string;\n  sku: string;\n  binLocation?: string;\n  systemQty: number;\n  countedQty: number | null;\n  variance: number;\n  varianceValue: number;\n  status: 'pending' | 'counted' | 'verified';\n  countedBy?: string;\n  countedAt?: Date;\n  notes?: string;\n}\n\nexport interface StockCount {\n  id: string;\n  countNumber: string;\n  name: string;\n  type: 'full' | 'cycle' | 'spot';\n  status: 'draft' | 'in_progress' | 'completed' | 'cancelled';\n  location: string;\n  locationName: string;\n  category?: string;\n  assignedTo?: string;\n  items: StockCountItem[];\n  summary: {\n    totalItems: number;\n    countedItems: number;\n    matchedItems: number;\n    discrepancyItems: number;\n    totalVariance: number;\n  };\n  startedAt?: Date;\n  completedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Stock Transfer types\nexport interface TransferItem {\n  productId: string;\n  productName: string;\n  sku: string;\n  requestedQty: number;\n  shippedQty: number;\n  receivedQty: number;\n  status: 'pending' | 'shipped' | 'received' | 'short';\n}\n\nexport interface StockTransfer {\n  id: string;\n  transferNumber: string;\n  status: 'draft' | 'pending' | 'in_transit' | 'received' | 'cancelled';\n  fromLocation: string;\n  fromLocationName: string;\n  toLocation: string;\n  toLocationName: string;\n  items: TransferItem[];\n  notes?: string;\n  requestedBy?: string;\n  shippedAt?: Date;\n  receivedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface PurchaseOrderItem {\n  productId: string;\n  productName: string;\n  sku: string;\n  quantity: number;\n  receivedQty: number;\n  unitCost: number;\n}\n\nexport interface PurchaseOrder {\n  id: string;\n  poNumber: string;\n  supplier: string;\n  status: 'draft' | 'sent' | 'partial' | 'received' | 'cancelled';\n  currency: 'USD' | 'CAD';\n  expectedDate?: Date;\n  items: PurchaseOrderItem[];\n  subtotal: number;\n  shipping: number;\n  total: number;\n  notes?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface WorkOrderComponent {\n  productId: string;\n  productName: string;\n  quantityRequired: number;\n  quantityUsed: number;\n}\n\nexport interface WorkOrder {\n  id: string;\n  woNumber: string;\n  status: 'pending' | 'in_progress' | 'completed' | 'cancelled';\n  outputProductId: string;\n  outputProductName: string;\n  quantityToProduce: number;\n  quantityProduced: number;\n  priority: 'normal' | 'high' | 'urgent';\n  dueDate?: Date;\n  components: WorkOrderComponent[];\n  notes?: string;\n  startedAt?: Date;\n  completedAt?: Date;\n  createdAt: Date;\n}\n\nexport interface BundleComponent {\n  productId: string;\n  productName: string;\n  quantity: number;\n}\n\nexport interface Bundle {\n  id: string;\n  name: string;\n  sku: string;\n  type: 'virtual' | 'physical' | 'fba_kit';\n  description?: string;\n  prices: {\n    msrp: number;\n    shopify: number;\n    amazon: number;\n    wholesale: number;\n  };\n  compareAtPrices: {\n    msrp: number;\n    shopify: number;\n    amazon: number;\n  };\n  components: BundleComponent[];\n  assemblyInstructions?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface Shipment {\n  id: string;\n  orderId: string;\n  orderNumber: string;\n  carrier: 'usps' | 'ups' | 'fedex' | 'dhl';\n  service: string;\n  trackingNumber: string;\n  customerPaid: number;\n  actualCost: number;\n  profit: number;\n  weight: number;\n  status: 'label_created' | 'in_transit' | 'delivered' | 'exception';\n  customerName: string;\n  customerCity: string;\n  customerState: string;\n  shippedAt: Date;\n  deliveredAt?: Date;\n}\n\nexport interface ShippingBox {\n  id: string;\n  name: string;\n  sku?: string;\n  innerLength: number;\n  innerWidth: number;\n  innerHeight: number;\n  maxWeight: number;\n  cost?: number;\n  smartBoxEligible: boolean;\n}\n\nexport interface AppSettings {\n  companyName: string;\n  companyAddress?: string;\n  logoUrl?: string;\n  defaultLocation: string;\n  gripperStickerEnabled: boolean;\n  gripperStickerSku: string;\n  smartBoxEnabled: boolean;\n  lowStockThreshold: number;\n  // Picking Settings\n  pickingMode: 'multi_tote' | 'single_tote';\n  maxOrdersPerBatch: number;\n  maxItemsPerBatch: number;\n  autoReallocateIncomplete: boolean;\n}\n\n// Picking Tote\nexport interface PickingTote {\n  id: string;\n  barcode: string;\n  name: string;\n  locationId: string;\n  isActive: boolean;\n}\n\n// Fulfillment Rule (user-configurable)\nexport type FulfillmentRuleType =\n  | 'gripper_sticker'\n  | 'box_selection'\n  | 'label_deduction'\n  | 'auto_allocate'\n  | 'weight_threshold'\n  | 'custom';\n\nexport interface FulfillmentRule {\n  id: string;\n  name: string;\n  description?: string;\n  type: FulfillmentRuleType;\n  enabled: boolean;\n  priority: number;\n  conditions: FulfillmentRuleCondition[];\n  actions: FulfillmentRuleAction[];\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface FulfillmentRuleCondition {\n  id: string;\n  field: 'channel' | 'sku' | 'category' | 'weight' | 'quantity' | 'total_value' | 'destination_state' | 'destination_country';\n  operator: 'equals' | 'not_equals' | 'contains' | 'greater_than' | 'less_than' | 'in_list';\n  value: string | number | string[];\n}\n\nexport interface FulfillmentRuleAction {\n  id: string;\n  type: 'add_item' | 'deduct_inventory' | 'set_box' | 'add_note' | 'set_carrier' | 'apply_discount';\n  config: {\n    productId?: string;\n    quantity?: number;\n    boxId?: string;\n    note?: string;\n    carrier?: string;\n    discountPercent?: number;\n  };\n}\n\n// Automation Rule Types\nexport interface AutomationRule {\n  id: string;\n  name: string;\n  description?: string;\n  enabled: boolean;\n  trigger: RuleTrigger;\n  conditions: RuleCondition[];\n  actions: RuleAction[];\n  priority: number; // Lower = runs first\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport type RuleTrigger =\n  | { type: 'order_created' }\n  | { type: 'order_status_changed'; fromStatus?: string; toStatus?: string }\n  | { type: 'low_stock'; threshold?: number }\n  | { type: 'item_received' }\n  | { type: 'daily'; time: string } // \"09:00\"\n  | { type: 'manual' };\n\nexport interface RuleCondition {\n  id: string;\n  field: string;\n  operator: 'equals' | 'not_equals' | 'contains' | 'greater_than' | 'less_than' | 'in_list';\n  value: string | number | boolean | string[];\n}\n\nexport interface RuleAction {\n  id: string;\n  type: RuleActionType;\n  config: Record<string, any>;\n}\n\nexport type RuleActionType =\n  | 'set_order_tag'\n  | 'set_priority'\n  | 'assign_carrier'\n  | 'assign_service'\n  | 'select_box'\n  | 'send_notification'\n  | 'add_fulfillment_item'\n  | 'set_location'\n  | 'create_po_draft'\n  | 'send_email';\n\n// Condition field options by trigger type\nexport const conditionFields = {\n  order: [\n    { value: 'channel', label: 'Sales Channel' },\n    { value: 'total', label: 'Order Total' },\n    { value: 'item_count', label: 'Item Count' },\n    { value: 'shipping_country', label: 'Ship To Country' },\n    { value: 'shipping_state', label: 'Ship To State' },\n    { value: 'customer_email', label: 'Customer Email' },\n    { value: 'contains_sku', label: 'Contains SKU' },\n    { value: 'weight', label: 'Total Weight' },\n    { value: 'is_prime', label: 'Is Amazon Prime' },\n    { value: 'requires_signature', label: 'Requires Signature' }\n  ],\n  inventory: [\n    { value: 'sku', label: 'Product SKU' },\n    { value: 'category', label: 'Category' },\n    { value: 'quantity', label: 'Quantity' },\n    { value: 'location', label: 'Location' },\n    { value: 'cost', label: 'Product Cost' }\n  ]\n};\n\nexport interface AppState {\n  products: Product[];\n  inventory: InventoryLevel[];\n  locations: Location[];\n  orders: Order[];\n  purchaseOrders: PurchaseOrder[];\n  workOrders: WorkOrder[];\n  bundles: Bundle[];\n  shipments: Shipment[];\n  boxes: ShippingBox[];\n  pickingBatches: PickingBatch[];\n  pickingTotes: PickingTote[];\n  fulfillmentRules: FulfillmentRule[];\n  returns: Return[];\n  stockCounts: StockCount[];\n  transfers: StockTransfer[];\n  automationRules: AutomationRule[];\n  serialNumbers: SerialNumber[];\n  serialMovements: SerialMovement[];\n  lots: InventoryLot[];\n  lotMovements: LotMovement[];\n  suppliers: Supplier[];\n  productSuppliers: ProductSupplier[];\n  settings: AppSettings;\n  isLoading: boolean;\n  isInitialized: boolean;\n}\n\n// Action Types\ntype Action =\n  | { type: 'SET_LOADING'; payload: boolean }\n  | { type: 'SET_INITIALIZED'; payload: boolean }\n  | { type: 'RESET_STATE' }\n  | { type: 'SET_PRODUCTS'; payload: Product[] }\n  | { type: 'ADD_PRODUCT'; payload: Product }\n  | { type: 'UPDATE_PRODUCT'; payload: Product }\n  | { type: 'DELETE_PRODUCT'; payload: string }\n  | { type: 'SET_INVENTORY'; payload: InventoryLevel[] }\n  | { type: 'UPDATE_INVENTORY'; payload: InventoryLevel }\n  | { type: 'ADJUST_STOCK'; payload: { productId: string; locationId: string; adjustment: number } }\n  | { type: 'SET_LOCATIONS'; payload: Location[] }\n  | { type: 'ADD_LOCATION'; payload: Location }\n  | { type: 'UPDATE_LOCATION'; payload: Location }\n  | { type: 'DELETE_LOCATION'; payload: string }\n  | { type: 'SET_ORDERS'; payload: Order[] }\n  | { type: 'ADD_ORDER'; payload: Order }\n  | { type: 'UPDATE_ORDER'; payload: Order }\n  | { type: 'UPDATE_ORDER_STATUS'; payload: { orderId: string; status: Order['status'] } }\n  | { type: 'DELETE_ORDER'; payload: string }\n  | { type: 'SET_PURCHASE_ORDERS'; payload: PurchaseOrder[] }\n  | { type: 'ADD_PURCHASE_ORDER'; payload: PurchaseOrder }\n  | { type: 'UPDATE_PURCHASE_ORDER'; payload: PurchaseOrder }\n  | { type: 'DELETE_PURCHASE_ORDER'; payload: string }\n  | { type: 'SET_WORK_ORDERS'; payload: WorkOrder[] }\n  | { type: 'ADD_WORK_ORDER'; payload: WorkOrder }\n  | { type: 'UPDATE_WORK_ORDER'; payload: WorkOrder }\n  | { type: 'DELETE_WORK_ORDER'; payload: string }\n  | { type: 'SET_BUNDLES'; payload: Bundle[] }\n  | { type: 'ADD_BUNDLE'; payload: Bundle }\n  | { type: 'UPDATE_BUNDLE'; payload: Bundle }\n  | { type: 'DELETE_BUNDLE'; payload: string }\n  | { type: 'SET_SHIPMENTS'; payload: Shipment[] }\n  | { type: 'ADD_SHIPMENT'; payload: Shipment }\n  | { type: 'UPDATE_SHIPMENT'; payload: Shipment }\n  | { type: 'SET_BOXES'; payload: ShippingBox[] }\n  | { type: 'ADD_BOX'; payload: ShippingBox }\n  | { type: 'UPDATE_BOX'; payload: ShippingBox }\n  | { type: 'DELETE_BOX'; payload: string }\n  | { type: 'SET_PICKING_BATCHES'; payload: PickingBatch[] }\n  | { type: 'ADD_PICKING_BATCH'; payload: PickingBatch }\n  | { type: 'UPDATE_PICKING_BATCH'; payload: PickingBatch }\n  | { type: 'DELETE_PICKING_BATCH'; payload: string }\n  | { type: 'ASSIGN_ORDER_TO_BATCH'; payload: { orderId: string; batchId: string | null } }\n  | { type: 'SET_RETURNS'; payload: Return[] }\n  | { type: 'ADD_RETURN'; payload: Return }\n  | { type: 'UPDATE_RETURN'; payload: Return }\n  | { type: 'SET_STOCK_COUNTS'; payload: StockCount[] }\n  | { type: 'ADD_STOCK_COUNT'; payload: StockCount }\n  | { type: 'UPDATE_STOCK_COUNT'; payload: StockCount }\n  | { type: 'DELETE_STOCK_COUNT'; payload: string }\n  | { type: 'SET_TRANSFERS'; payload: StockTransfer[] }\n  | { type: 'ADD_TRANSFER'; payload: StockTransfer }\n  | { type: 'UPDATE_TRANSFER'; payload: StockTransfer }\n  | { type: 'SET_AUTOMATION_RULES'; payload: AutomationRule[] }\n  | { type: 'ADD_AUTOMATION_RULE'; payload: AutomationRule }\n  | { type: 'UPDATE_AUTOMATION_RULE'; payload: AutomationRule }\n  | { type: 'DELETE_AUTOMATION_RULE'; payload: string }\n  | { type: 'TOGGLE_RULE'; payload: string }\n  | { type: 'SET_SERIAL_NUMBERS'; payload: SerialNumber[] }\n  | { type: 'ADD_SERIAL_NUMBERS'; payload: SerialNumber[] }\n  | { type: 'UPDATE_SERIAL_NUMBER'; payload: SerialNumber }\n  | { type: 'RESERVE_SERIALS'; payload: { serials: string[]; orderId: string } }\n  | { type: 'SELL_SERIALS'; payload: { serials: string[]; orderId: string } }\n  | { type: 'RETURN_SERIAL'; payload: { serial: string; condition: 'in_stock' | 'damaged' } }\n  | { type: 'ADD_SERIAL_MOVEMENT'; payload: SerialMovement }\n  | { type: 'SET_LOTS'; payload: InventoryLot[] }\n  | { type: 'ADD_LOT'; payload: InventoryLot }\n  | { type: 'ADD_LOTS'; payload: InventoryLot[] }\n  | { type: 'UPDATE_LOT'; payload: InventoryLot }\n  | { type: 'PICK_FROM_LOT'; payload: { lotId: string; quantity: number; orderId: string; orderNumber: string } }\n  | { type: 'RESERVE_LOT_QTY'; payload: { lotId: string; quantity: number } }\n  | { type: 'RELEASE_LOT_QTY'; payload: { lotId: string; quantity: number } }\n  | { type: 'RECALL_LOT'; payload: { lotId: string; notes: string } }\n  | { type: 'QUARANTINE_LOT'; payload: { lotId: string; notes: string } }\n  | { type: 'ADD_LOT_MOVEMENT'; payload: LotMovement }\n  | { type: 'SET_SUPPLIERS'; payload: Supplier[] }\n  | { type: 'ADD_SUPPLIER'; payload: Supplier }\n  | { type: 'UPDATE_SUPPLIER'; payload: Supplier }\n  | { type: 'DELETE_SUPPLIER'; payload: string }\n  | { type: 'SET_PRODUCT_SUPPLIERS'; payload: ProductSupplier[] }\n  | { type: 'ADD_PRODUCT_SUPPLIER'; payload: ProductSupplier }\n  | { type: 'UPDATE_PRODUCT_SUPPLIER'; payload: ProductSupplier }\n  | { type: 'REMOVE_PRODUCT_SUPPLIER'; payload: { productId: string; supplierId: string } }\n  | { type: 'UPDATE_SETTINGS'; payload: Partial<AppSettings> }\n  // Picking Totes\n  | { type: 'SET_PICKING_TOTES'; payload: PickingTote[] }\n  | { type: 'ADD_PICKING_TOTE'; payload: PickingTote }\n  | { type: 'UPDATE_PICKING_TOTE'; payload: PickingTote }\n  | { type: 'DELETE_PICKING_TOTE'; payload: string }\n  // Fulfillment Rules\n  | { type: 'SET_FULFILLMENT_RULES'; payload: FulfillmentRule[] }\n  | { type: 'ADD_FULFILLMENT_RULE'; payload: FulfillmentRule }\n  | { type: 'UPDATE_FULFILLMENT_RULE'; payload: FulfillmentRule }\n  | { type: 'DELETE_FULFILLMENT_RULE'; payload: string };\n\n// Reducer\nfunction appReducer(state: AppState, action: Action): AppState {\n  switch (action.type) {\n    case 'SET_LOADING':\n      return { ...state, isLoading: action.payload };\n    case 'SET_INITIALIZED':\n      return { ...state, isInitialized: action.payload };\n    case 'RESET_STATE':\n      return { ...initialState, isLoading: false, isInitialized: true };\n\n    // Products\n    case 'SET_PRODUCTS':\n      return { ...state, products: action.payload };\n    case 'ADD_PRODUCT':\n      return { ...state, products: [...state.products, action.payload] };\n    case 'UPDATE_PRODUCT':\n      return {\n        ...state,\n        products: state.products.map(p => p.id === action.payload.id ? action.payload : p),\n      };\n    case 'DELETE_PRODUCT':\n      return { ...state, products: state.products.filter(p => p.id !== action.payload) };\n\n    // Inventory\n    case 'SET_INVENTORY':\n      return { ...state, inventory: action.payload };\n    case 'UPDATE_INVENTORY':\n      return {\n        ...state,\n        inventory: state.inventory.map(inv =>\n          inv.productId === action.payload.productId && inv.locationId === action.payload.locationId\n            ? action.payload\n            : inv\n        ),\n      };\n    case 'ADJUST_STOCK':\n      return {\n        ...state,\n        inventory: state.inventory.map(inv =>\n          inv.productId === action.payload.productId && inv.locationId === action.payload.locationId\n            ? { ...inv, quantity: inv.quantity + action.payload.adjustment, updatedAt: new Date() }\n            : inv\n        ),\n      };\n\n    // Locations\n    case 'SET_LOCATIONS':\n      return { ...state, locations: action.payload };\n    case 'ADD_LOCATION':\n      return { ...state, locations: [...state.locations, action.payload] };\n    case 'UPDATE_LOCATION':\n      return {\n        ...state,\n        locations: state.locations.map(l => l.id === action.payload.id ? action.payload : l),\n      };\n    case 'DELETE_LOCATION':\n      return { ...state, locations: state.locations.filter(l => l.id !== action.payload) };\n\n    // Orders\n    case 'SET_ORDERS':\n      return { ...state, orders: action.payload };\n    case 'ADD_ORDER':\n      return { ...state, orders: [...state.orders, action.payload] };\n    case 'UPDATE_ORDER':\n      return {\n        ...state,\n        orders: state.orders.map(o => o.id === action.payload.id ? action.payload : o),\n      };\n    case 'UPDATE_ORDER_STATUS':\n      return {\n        ...state,\n        orders: state.orders.map(o =>\n          o.id === action.payload.orderId\n            ? { ...o, status: action.payload.status, updatedAt: new Date() }\n            : o\n        ),\n      };\n    case 'DELETE_ORDER':\n      return { ...state, orders: state.orders.filter(o => o.id !== action.payload) };\n\n    // Purchase Orders\n    case 'SET_PURCHASE_ORDERS':\n      return { ...state, purchaseOrders: action.payload };\n    case 'ADD_PURCHASE_ORDER':\n      return { ...state, purchaseOrders: [...state.purchaseOrders, action.payload] };\n    case 'UPDATE_PURCHASE_ORDER':\n      return {\n        ...state,\n        purchaseOrders: state.purchaseOrders.map(po =>\n          po.id === action.payload.id ? action.payload : po\n        ),\n      };\n    case 'DELETE_PURCHASE_ORDER':\n      return { ...state, purchaseOrders: state.purchaseOrders.filter(po => po.id !== action.payload) };\n\n    // Work Orders\n    case 'SET_WORK_ORDERS':\n      return { ...state, workOrders: action.payload };\n    case 'ADD_WORK_ORDER':\n      return { ...state, workOrders: [...state.workOrders, action.payload] };\n    case 'UPDATE_WORK_ORDER':\n      return {\n        ...state,\n        workOrders: state.workOrders.map(wo =>\n          wo.id === action.payload.id ? action.payload : wo\n        ),\n      };\n    case 'DELETE_WORK_ORDER':\n      return { ...state, workOrders: state.workOrders.filter(wo => wo.id !== action.payload) };\n\n    // Bundles\n    case 'SET_BUNDLES':\n      return { ...state, bundles: action.payload };\n    case 'ADD_BUNDLE':\n      return { ...state, bundles: [...state.bundles, action.payload] };\n    case 'UPDATE_BUNDLE':\n      return {\n        ...state,\n        bundles: state.bundles.map(b => b.id === action.payload.id ? action.payload : b),\n      };\n    case 'DELETE_BUNDLE':\n      return { ...state, bundles: state.bundles.filter(b => b.id !== action.payload) };\n\n    // Shipments\n    case 'SET_SHIPMENTS':\n      return { ...state, shipments: action.payload };\n    case 'ADD_SHIPMENT':\n      return { ...state, shipments: [...state.shipments, action.payload] };\n    case 'UPDATE_SHIPMENT':\n      return {\n        ...state,\n        shipments: state.shipments.map(s => s.id === action.payload.id ? action.payload : s),\n      };\n\n    // Boxes\n    case 'SET_BOXES':\n      return { ...state, boxes: action.payload };\n    case 'ADD_BOX':\n      return { ...state, boxes: [...state.boxes, action.payload] };\n    case 'UPDATE_BOX':\n      return {\n        ...state,\n        boxes: state.boxes.map(b => b.id === action.payload.id ? action.payload : b),\n      };\n    case 'DELETE_BOX':\n      return { ...state, boxes: state.boxes.filter(b => b.id !== action.payload) };\n\n    // Suppliers\n    case 'SET_SUPPLIERS':\n      return { ...state, suppliers: action.payload };\n    case 'ADD_SUPPLIER':\n      return { ...state, suppliers: [...state.suppliers, action.payload] };\n    case 'UPDATE_SUPPLIER':\n      return {\n        ...state,\n        suppliers: state.suppliers.map(s => s.id === action.payload.id ? action.payload : s),\n      };\n    case 'DELETE_SUPPLIER':\n      return {\n        ...state,\n        suppliers: state.suppliers.filter(s => s.id !== action.payload),\n        productSuppliers: state.productSuppliers.filter(ps => ps.supplierId !== action.payload),\n      };\n    case 'SET_PRODUCT_SUPPLIERS':\n      return { ...state, productSuppliers: action.payload };\n    case 'ADD_PRODUCT_SUPPLIER':\n      return { ...state, productSuppliers: [...state.productSuppliers, action.payload] };\n    case 'UPDATE_PRODUCT_SUPPLIER':\n      return {\n        ...state,\n        productSuppliers: state.productSuppliers.map(ps =>\n          ps.productId === action.payload.productId && ps.supplierId === action.payload.supplierId\n            ? action.payload\n            : ps\n        ),\n      };\n    case 'REMOVE_PRODUCT_SUPPLIER':\n      return {\n        ...state,\n        productSuppliers: state.productSuppliers.filter(\n          ps => !(ps.productId === action.payload.productId && ps.supplierId === action.payload.supplierId)\n        ),\n      };\n\n    // Settings\n    case 'UPDATE_SETTINGS':\n      return { ...state, settings: { ...state.settings, ...action.payload } };\n\n    // Picking Batches\n    case 'SET_PICKING_BATCHES':\n      return { ...state, pickingBatches: action.payload };\n    case 'ADD_PICKING_BATCH':\n      return { ...state, pickingBatches: [...state.pickingBatches, action.payload] };\n    case 'UPDATE_PICKING_BATCH':\n      return {\n        ...state,\n        pickingBatches: state.pickingBatches.map(b => b.id === action.payload.id ? action.payload : b),\n      };\n    case 'DELETE_PICKING_BATCH':\n      return {\n        ...state,\n        pickingBatches: state.pickingBatches.filter(b => b.id !== action.payload),\n        // Also remove batch assignment from orders\n        orders: state.orders.map(o => o.pickingBatchId === action.payload ? { ...o, pickingBatchId: undefined } : o),\n      };\n    case 'ASSIGN_ORDER_TO_BATCH': {\n      const { orderId, batchId } = action.payload;\n      // Update the order's pickingBatchId\n      const updatedOrders = state.orders.map(o =>\n        o.id === orderId ? { ...o, pickingBatchId: batchId || undefined } : o\n      );\n      // Update the batch's orderIds\n      let updatedBatches = state.pickingBatches;\n      if (batchId) {\n        updatedBatches = state.pickingBatches.map(b => {\n          if (b.id === batchId && !b.orderIds.includes(orderId)) {\n            return { ...b, orderIds: [...b.orderIds, orderId] };\n          }\n          // Remove from other batches\n          if (b.id !== batchId && b.orderIds.includes(orderId)) {\n            return { ...b, orderIds: b.orderIds.filter(id => id !== orderId) };\n          }\n          return b;\n        });\n      } else {\n        // Remove from all batches\n        updatedBatches = state.pickingBatches.map(b => ({\n          ...b,\n          orderIds: b.orderIds.filter(id => id !== orderId),\n        }));\n      }\n      return { ...state, orders: updatedOrders, pickingBatches: updatedBatches };\n    }\n\n    // Returns\n    case 'SET_RETURNS':\n      return { ...state, returns: action.payload };\n    case 'ADD_RETURN':\n      return { ...state, returns: [...state.returns, action.payload] };\n    case 'UPDATE_RETURN':\n      return {\n        ...state,\n        returns: state.returns.map(r => r.id === action.payload.id ? action.payload : r),\n      };\n\n    // Stock Counts\n    case 'SET_STOCK_COUNTS':\n      return { ...state, stockCounts: action.payload };\n    case 'ADD_STOCK_COUNT':\n      return { ...state, stockCounts: [...state.stockCounts, action.payload] };\n    case 'UPDATE_STOCK_COUNT':\n      return {\n        ...state,\n        stockCounts: state.stockCounts.map(sc => sc.id === action.payload.id ? action.payload : sc),\n      };\n    case 'DELETE_STOCK_COUNT':\n      return { ...state, stockCounts: state.stockCounts.filter(sc => sc.id !== action.payload) };\n\n    // Transfers\n    case 'SET_TRANSFERS':\n      return { ...state, transfers: action.payload };\n    case 'ADD_TRANSFER':\n      return { ...state, transfers: [...state.transfers, action.payload] };\n    case 'UPDATE_TRANSFER':\n      return {\n        ...state,\n        transfers: state.transfers.map(t => t.id === action.payload.id ? action.payload : t),\n      };\n\n    // Automation Rules\n    case 'SET_AUTOMATION_RULES':\n      return { ...state, automationRules: action.payload };\n    case 'ADD_AUTOMATION_RULE':\n      return { ...state, automationRules: [...state.automationRules, action.payload] };\n    case 'UPDATE_AUTOMATION_RULE':\n      return {\n        ...state,\n        automationRules: state.automationRules.map(r => r.id === action.payload.id ? action.payload : r),\n      };\n    case 'DELETE_AUTOMATION_RULE':\n      return { ...state, automationRules: state.automationRules.filter(r => r.id !== action.payload) };\n    case 'TOGGLE_RULE':\n      return {\n        ...state,\n        automationRules: state.automationRules.map(r =>\n          r.id === action.payload ? { ...r, enabled: !r.enabled, updatedAt: new Date() } : r\n        ),\n      };\n\n    // Serial Numbers\n    case 'SET_SERIAL_NUMBERS':\n      return { ...state, serialNumbers: action.payload };\n    case 'ADD_SERIAL_NUMBERS':\n      return { ...state, serialNumbers: [...state.serialNumbers, ...action.payload] };\n    case 'UPDATE_SERIAL_NUMBER':\n      return {\n        ...state,\n        serialNumbers: state.serialNumbers.map(sn =>\n          sn.id === action.payload.id ? action.payload : sn\n        ),\n      };\n    case 'RESERVE_SERIALS':\n      return {\n        ...state,\n        serialNumbers: state.serialNumbers.map(sn =>\n          action.payload.serials.includes(sn.serial)\n            ? { ...sn, status: 'reserved' as const, salesOrderId: action.payload.orderId }\n            : sn\n        ),\n      };\n    case 'SELL_SERIALS':\n      return {\n        ...state,\n        serialNumbers: state.serialNumbers.map(sn =>\n          action.payload.serials.includes(sn.serial)\n            ? { ...sn, status: 'sold' as const, salesOrderId: action.payload.orderId, soldAt: new Date() }\n            : sn\n        ),\n      };\n    case 'RETURN_SERIAL':\n      return {\n        ...state,\n        serialNumbers: state.serialNumbers.map(sn =>\n          sn.serial === action.payload.serial\n            ? { ...sn, status: action.payload.condition, salesOrderId: undefined, soldAt: undefined }\n            : sn\n        ),\n      };\n    case 'ADD_SERIAL_MOVEMENT':\n      return { ...state, serialMovements: [...state.serialMovements, action.payload] };\n\n    // Lots\n    case 'SET_LOTS':\n      return { ...state, lots: action.payload };\n    case 'ADD_LOT':\n      return { ...state, lots: [...state.lots, action.payload] };\n    case 'ADD_LOTS':\n      return { ...state, lots: [...state.lots, ...action.payload] };\n    case 'UPDATE_LOT':\n      return {\n        ...state,\n        lots: state.lots.map(lot => lot.id === action.payload.id ? action.payload : lot),\n      };\n    case 'PICK_FROM_LOT':\n      return {\n        ...state,\n        lots: state.lots.map(lot =>\n          lot.id === action.payload.lotId\n            ? { ...lot, quantity: lot.quantity - action.payload.quantity, reservedQty: Math.max(0, lot.reservedQty - action.payload.quantity) }\n            : lot\n        ),\n      };\n    case 'RESERVE_LOT_QTY':\n      return {\n        ...state,\n        lots: state.lots.map(lot =>\n          lot.id === action.payload.lotId\n            ? { ...lot, reservedQty: lot.reservedQty + action.payload.quantity }\n            : lot\n        ),\n      };\n    case 'RELEASE_LOT_QTY':\n      return {\n        ...state,\n        lots: state.lots.map(lot =>\n          lot.id === action.payload.lotId\n            ? { ...lot, reservedQty: Math.max(0, lot.reservedQty - action.payload.quantity) }\n            : lot\n        ),\n      };\n    case 'RECALL_LOT':\n      return {\n        ...state,\n        lots: state.lots.map(lot =>\n          lot.id === action.payload.lotId\n            ? { ...lot, status: 'recalled' as const, notes: action.payload.notes }\n            : lot\n        ),\n      };\n    case 'QUARANTINE_LOT':\n      return {\n        ...state,\n        lots: state.lots.map(lot =>\n          lot.id === action.payload.lotId\n            ? { ...lot, status: 'quarantine' as const, notes: action.payload.notes }\n            : lot\n        ),\n      };\n    case 'ADD_LOT_MOVEMENT':\n      return { ...state, lotMovements: [...state.lotMovements, action.payload] };\n\n    // Picking Totes\n    case 'SET_PICKING_TOTES':\n      return { ...state, pickingTotes: action.payload };\n    case 'ADD_PICKING_TOTE':\n      return { ...state, pickingTotes: [...state.pickingTotes, action.payload] };\n    case 'UPDATE_PICKING_TOTE':\n      return {\n        ...state,\n        pickingTotes: state.pickingTotes.map(t => t.id === action.payload.id ? action.payload : t),\n      };\n    case 'DELETE_PICKING_TOTE':\n      return { ...state, pickingTotes: state.pickingTotes.filter(t => t.id !== action.payload) };\n\n    // Fulfillment Rules\n    case 'SET_FULFILLMENT_RULES':\n      return { ...state, fulfillmentRules: action.payload };\n    case 'ADD_FULFILLMENT_RULE':\n      return { ...state, fulfillmentRules: [...state.fulfillmentRules, action.payload] };\n    case 'UPDATE_FULFILLMENT_RULE':\n      return {\n        ...state,\n        fulfillmentRules: state.fulfillmentRules.map(r => r.id === action.payload.id ? action.payload : r),\n      };\n    case 'DELETE_FULFILLMENT_RULE':\n      return { ...state, fulfillmentRules: state.fulfillmentRules.filter(r => r.id !== action.payload) };\n\n    default:\n      return state;\n  }\n}\n\n// Initial State\nconst initialState: AppState = {\n  products: [],\n  inventory: [],\n  locations: [],\n  orders: [],\n  purchaseOrders: [],\n  workOrders: [],\n  bundles: [],\n  shipments: [],\n  boxes: [],\n  pickingBatches: [],\n  pickingTotes: [],\n  fulfillmentRules: [],\n  returns: [],\n  stockCounts: [],\n  transfers: [],\n  automationRules: [],\n  serialNumbers: [],\n  serialMovements: [],\n  lots: [],\n  lotMovements: [],\n  suppliers: [],\n  productSuppliers: [],\n  settings: {\n    companyName: 'Cronk Nutrients',\n    defaultLocation: 'loc-1',\n    gripperStickerEnabled: true,\n    gripperStickerSku: 'LAB010R',\n    smartBoxEnabled: true,\n    lowStockThreshold: 50,\n    // Picking Settings\n    pickingMode: 'multi_tote',\n    maxOrdersPerBatch: 20,\n    maxItemsPerBatch: 100,\n    autoReallocateIncomplete: true,\n  },\n  isLoading: true,\n  isInitialized: false,\n};\n\n// Context\nconst AppContext = createContext<{\n  state: AppState;\n  dispatch: React.Dispatch<Action>;\n} | undefined>(undefined);\n\n// Provider\nexport function AppProvider({ children }: { children: ReactNode }) {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n  const { isDemo, loading: authLoading, user } = useAuth();\n\n  // Initialize data - mock data for demo, empty for real users\n  useEffect(() => {\n    // Wait for auth to finish loading\n    if (authLoading) return;\n\n    const initializeData = async () => {\n      try {\n        // If not demo mode, reset to empty state for real users\n        if (!isDemo) {\n          // For real users: empty state, they import their own data\n          // This also clears any demo data if switching from demo to real user\n          // In the future, this would load from Firestore per user\n          dispatch({ type: 'RESET_STATE' });\n          return;\n        }\n\n        // Demo mode: Import mock data dynamically to avoid circular dependencies\n        const {\n          products,\n          locations,\n          inventory,\n          orders,\n          purchaseOrders,\n          workOrders,\n          bundles,\n          shippingBoxes\n        } = await import('@/data/mockData');\n\n        // Transform existing mock data to match new interfaces\n        const transformedLocations: Location[] = locations.map(loc => ({\n          id: loc.id,\n          name: loc.name,\n          type: loc.type as 'warehouse' | 'fba' | 'fbm',\n          address: undefined,\n          isDefault: loc.id === 'loc-1',\n        }));\n\n        const transformedProducts: Product[] = products.map(p => ({\n          id: p.id,\n          name: p.name,\n          sku: p.sku,\n          barcode: p.barcode,\n          category: p.category,\n          description: undefined,\n          cost: {\n            rolling: p.costs.base,\n            fixed: p.costs.base,\n          },\n          prices: {\n            msrp: p.prices.msrp,\n            shopify: p.prices.shopify,\n            amazon: p.prices.amazon,\n            wholesale: p.prices.wholesale,\n          },\n          weight: {\n            value: p.weight || 0,\n            unit: 'lbs' as const,\n          },\n          dimensions: p.dimensions || { length: 0, width: 0, height: 0 },\n          reorderPoint: p.reorderPoint,\n          supplier: p.defaultVendor,\n          skus: {\n            shopify: `SHOP-${p.sku}`,\n            amazon: `AMZ-${p.sku}`,\n          },\n          createdAt: new Date(p.createdAt),\n          updatedAt: new Date(p.updatedAt),\n        }));\n\n        const transformedInventory: InventoryLevel[] = inventory.map(inv => ({\n          productId: inv.productId,\n          locationId: inv.locationId,\n          quantity: inv.quantity,\n          binLocation: inv.binLocation,\n          updatedAt: new Date(),\n        }));\n\n        // Map mockData status to AppContext status\n        const mapOrderStatus = (status: string): Order['status'] => {\n          const statusMap: Record<string, Order['status']> = {\n            'ready_to_ship': 'ready',\n            'in_progress': 'picking',\n          };\n          return statusMap[status] || status as Order['status'];\n        };\n\n        const transformedOrders: Order[] = orders.map(o => ({\n          id: o.id,\n          orderNumber: o.orderNumber,\n          veeqoId: o.externalId,\n          channel: o.channel as Order['channel'],\n          status: mapOrderStatus(o.status),\n          customer: {\n            name: o.customer.name,\n            email: o.customer.email,\n            phone: o.customer.phone,\n            address: {\n              street: o.shippingAddress.line1,\n              city: o.shippingAddress.city,\n              state: o.shippingAddress.state,\n              zip: o.shippingAddress.postalCode,\n              country: o.shippingAddress.country,\n            },\n          },\n          items: o.items.map(item => ({\n            productId: item.productId || item.bundleId || '',\n            productName: item.name,\n            sku: item.sku,\n            quantity: item.quantity,\n            price: item.price,\n            cost: item.cost,\n            picked: false,\n          })),\n          subtotal: o.subtotal,\n          shipping: o.shipping,\n          tax: o.tax,\n          discount: 0,\n          total: o.total,\n          cogs: o.cogs,\n          profit: o.profit,\n          margin: o.marginPercent,\n          trackingNumber: o.shipments?.[0]?.trackingNumber,\n          carrier: o.shipments?.[0]?.carrier,\n          createdAt: new Date(o.createdAt),\n          updatedAt: new Date(o.updatedAt),\n        }));\n\n        const transformedPOs: PurchaseOrder[] = purchaseOrders.map(po => ({\n          id: po.id,\n          poNumber: po.poNumber,\n          supplier: po.supplier.name,\n          status: po.status as PurchaseOrder['status'],\n          currency: po.currency,\n          expectedDate: po.expectedDate ? new Date(po.expectedDate) : undefined,\n          items: po.items.map(item => ({\n            productId: item.productId,\n            productName: item.product?.name || '',\n            sku: item.product?.sku || '',\n            quantity: item.quantity,\n            receivedQty: item.quantityReceived,\n            unitCost: item.unitCost,\n          })),\n          subtotal: po.subtotal,\n          shipping: 0,\n          total: po.subtotalUSD,\n          notes: po.notes,\n          createdAt: new Date(po.createdAt),\n          updatedAt: new Date(po.createdAt),\n        }));\n\n        const transformedWOs: WorkOrder[] = workOrders.map(wo => ({\n          id: wo.id,\n          woNumber: wo.woNumber,\n          status: wo.status as WorkOrder['status'],\n          outputProductId: wo.outputProductId,\n          outputProductName: wo.outputProduct?.name || '',\n          quantityToProduce: wo.outputQuantity,\n          quantityProduced: wo.status === 'completed' ? wo.outputQuantity : 0,\n          priority: 'normal',\n          components: wo.inputs.map(input => ({\n            productId: input.productId,\n            productName: input.product?.name || '',\n            quantityRequired: input.quantityRequired,\n            quantityUsed: input.quantityUsed,\n          })),\n          notes: wo.notes,\n          createdAt: new Date(wo.createdAt),\n          completedAt: wo.completedAt ? new Date(wo.completedAt) : undefined,\n        }));\n\n        const transformedBundles: Bundle[] = bundles.map(b => ({\n          id: b.id,\n          name: b.name,\n          sku: b.sku,\n          type: 'virtual' as const,\n          description: b.description,\n          prices: {\n            msrp: b.prices.msrp,\n            shopify: b.prices.shopify,\n            amazon: b.prices.amazon,\n            wholesale: b.prices.wholesale || b.prices.msrp * 0.6,\n          },\n          compareAtPrices: b.compareAtPrices || {\n            msrp: b.prices.msrp * 1.2,\n            shopify: (b.prices.shopify || b.prices.msrp) * 1.2,\n            amazon: (b.prices.amazon || b.prices.msrp) * 1.2,\n          },\n          components: (b.components || []).map(c => ({\n            productId: c.productId,\n            productName: c.product?.name || '',\n            quantity: c.quantity,\n          })),\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        }));\n\n        const transformedBoxes: ShippingBox[] = shippingBoxes.map(box => ({\n          id: box.id,\n          name: box.name,\n          sku: box.sku,\n          innerLength: box.dimensions.length,\n          innerWidth: box.dimensions.width,\n          innerHeight: box.dimensions.height,\n          maxWeight: box.maxWeight,\n          cost: box.cost,\n          smartBoxEligible: box.isSmartBoxEligible,\n        }));\n\n        // Create mock shipments from shipped orders\n        const mockShipments: Shipment[] = transformedOrders\n          .filter(o => o.status === 'shipped' || o.status === 'delivered')\n          .map(o => ({\n            id: `ship-${o.id}`,\n            orderId: o.id,\n            orderNumber: o.orderNumber,\n            carrier: (o.carrier || 'usps') as Shipment['carrier'],\n            service: o.service || 'Priority Mail',\n            trackingNumber: o.trackingNumber || `TRK${Math.random().toString(36).substr(2, 12).toUpperCase()}`,\n            customerPaid: o.shipping,\n            actualCost: o.shipping * 0.7,\n            profit: o.shipping * 0.3,\n            weight: 2.5,\n            status: o.status === 'delivered' ? 'delivered' : 'in_transit',\n            customerName: o.customer.name,\n            customerCity: o.customer.address.city,\n            customerState: o.customer.address.state,\n            shippedAt: new Date(o.updatedAt),\n            deliveredAt: o.status === 'delivered' ? new Date() : undefined,\n          }));\n\n        // Create mock picking batches\n        const mockPickingBatches: PickingBatch[] = [\n          {\n            id: 'batch-1',\n            batchNumber: 'PB-001',\n            status: 'open',\n            orderIds: [],\n            createdAt: new Date(),\n          },\n          {\n            id: 'batch-2',\n            batchNumber: 'PB-002',\n            status: 'in_progress',\n            orderIds: [],\n            assignedTo: 'John',\n            createdAt: new Date(Date.now() - 86400000), // Yesterday\n          },\n        ];\n\n        // Create mock returns\n        const mockReturns: Return[] = [\n          {\n            id: 'return-1',\n            returnNumber: 'RET-0001',\n            orderId: 'order-5',\n            orderNumber: 'SH-4518',\n            channel: 'shopify',\n            status: 'requested',\n            customer: { name: 'James Wilson', email: 'jwilson@email.com' },\n            items: [{\n              productId: 'prod-mic-1l',\n              productName: '1L Micro 5-0-1',\n              sku: 'CNMIC1L',\n              quantity: 1,\n              quantityReceived: 0,\n              reason: 'damaged_in_transit',\n              refundAmount: 12.99\n            }],\n            returnShipping: {},\n            refund: { subtotal: 12.99, shipping: 0, restockingFee: 0, total: 12.99 },\n            createdAt: new Date(Date.now() - 86400000),\n            updatedAt: new Date(Date.now() - 86400000)\n          },\n          {\n            id: 'return-2',\n            returnNumber: 'RET-0002',\n            orderId: 'order-6',\n            orderNumber: 'AZ-8833',\n            channel: 'amazon_fbm',\n            status: 'in_transit',\n            customer: { name: 'Lisa Chen', email: 'lchen@email.com' },\n            items: [{\n              productId: 'prod-bb-500',\n              productName: '500mL Bud Booster 0-1-3',\n              sku: 'CNBB500ML',\n              quantity: 2,\n              quantityReceived: 0,\n              reason: 'changed_mind',\n              refundAmount: 45.76\n            }],\n            returnShipping: { trackingNumber: 'RET123456789', carrier: 'usps' },\n            refund: { subtotal: 45.76, shipping: 0, restockingFee: 4.58, total: 41.18 },\n            createdAt: new Date(Date.now() - 172800000),\n            updatedAt: new Date(Date.now() - 86400000)\n          },\n          {\n            id: 'return-3',\n            returnNumber: 'RET-0003',\n            orderId: 'order-7',\n            orderNumber: 'SH-4517',\n            channel: 'shopify',\n            status: 'received',\n            customer: { name: 'Tom Brady', email: 'tbrady@email.com' },\n            items: [{\n              productId: 'prod-gro-1l',\n              productName: '1L Grow 2-1-6',\n              sku: 'CNGRO1L',\n              quantity: 1,\n              quantityReceived: 1,\n              reason: 'defective',\n              refundAmount: 12.99\n            }],\n            returnShipping: { trackingNumber: 'RET987654321', carrier: 'ups' },\n            refund: { subtotal: 12.99, shipping: 6.99, restockingFee: 0, total: 19.98 },\n            createdAt: new Date(Date.now() - 259200000),\n            updatedAt: new Date()\n          }\n        ];\n\n        // Create mock stock counts\n        const mockStockCounts: StockCount[] = [\n          {\n            id: 'sc-1',\n            countNumber: 'SC-0001',\n            name: 'Weekly Cycle Count - Zone A',\n            type: 'cycle',\n            status: 'in_progress',\n            location: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            assignedTo: 'John',\n            items: [\n              {\n                productId: 'prod-mic-500',\n                productName: '500mL Micro 5-0-1',\n                sku: 'CNMIC500ML',\n                binLocation: 'A1-01',\n                systemQty: 150,\n                countedQty: 148,\n                variance: -2,\n                varianceValue: -10.50,\n                status: 'counted',\n                countedAt: new Date(Date.now() - 3600000)\n              },\n              {\n                productId: 'prod-mic-1l',\n                productName: '1L Micro 5-0-1',\n                sku: 'CNMIC1L',\n                binLocation: 'A1-02',\n                systemQty: 75,\n                countedQty: null,\n                variance: 0,\n                varianceValue: 0,\n                status: 'pending'\n              }\n            ],\n            summary: {\n              totalItems: 15,\n              countedItems: 8,\n              matchedItems: 6,\n              discrepancyItems: 2,\n              totalVariance: -24.50\n            },\n            startedAt: new Date(Date.now() - 86400000),\n            createdAt: new Date(Date.now() - 86400000),\n            updatedAt: new Date()\n          },\n          {\n            id: 'sc-2',\n            countNumber: 'SC-0002',\n            name: 'Monthly Full Count - December',\n            type: 'full',\n            status: 'completed',\n            location: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            items: [],\n            summary: {\n              totalItems: 45,\n              countedItems: 45,\n              matchedItems: 42,\n              discrepancyItems: 3,\n              totalVariance: -156.75\n            },\n            startedAt: new Date(Date.now() - 604800000),\n            completedAt: new Date(Date.now() - 518400000),\n            createdAt: new Date(Date.now() - 604800000),\n            updatedAt: new Date(Date.now() - 518400000)\n          }\n        ];\n\n        // Create mock transfers\n        const mockTransfers: StockTransfer[] = [\n          {\n            id: 'trf-1',\n            transferNumber: 'TRF-0001',\n            status: 'in_transit',\n            fromLocation: 'loc-warehouse',\n            fromLocationName: 'Texas Warehouse',\n            toLocation: 'loc-fba',\n            toLocationName: 'FBA Inbound',\n            items: [\n              {\n                productId: 'prod-mic-500',\n                productName: '500mL Micro 5-0-1',\n                sku: 'CNMIC500ML',\n                requestedQty: 50,\n                shippedQty: 50,\n                receivedQty: 0,\n                status: 'shipped'\n              },\n              {\n                productId: 'prod-bb-500',\n                productName: '500mL Bud Booster 0-1-3',\n                sku: 'CNBB500ML',\n                requestedQty: 30,\n                shippedQty: 30,\n                receivedQty: 0,\n                status: 'shipped'\n              }\n            ],\n            notes: 'FBA replenishment shipment',\n            shippedAt: new Date(Date.now() - 172800000),\n            createdAt: new Date(Date.now() - 259200000),\n            updatedAt: new Date(Date.now() - 172800000)\n          },\n          {\n            id: 'trf-2',\n            transferNumber: 'TRF-0002',\n            status: 'received',\n            fromLocation: 'loc-warehouse',\n            fromLocationName: 'Texas Warehouse',\n            toLocation: 'loc-fba',\n            toLocationName: 'FBA Inbound',\n            items: [\n              {\n                productId: 'prod-gro-1l',\n                productName: '1L Grow 2-1-6',\n                sku: 'CNGRO1L',\n                requestedQty: 100,\n                shippedQty: 100,\n                receivedQty: 98,\n                status: 'short'\n              }\n            ],\n            notes: 'Weekly FBA restock',\n            shippedAt: new Date(Date.now() - 604800000),\n            receivedAt: new Date(Date.now() - 518400000),\n            createdAt: new Date(Date.now() - 691200000),\n            updatedAt: new Date(Date.now() - 518400000)\n          }\n        ];\n\n        // Create mock automation rules\n        const mockAutomationRules: AutomationRule[] = [\n          {\n            id: 'rule-1',\n            name: 'Tag Amazon Prime orders',\n            description: 'Automatically add PRIME tag to Amazon Prime orders for priority handling',\n            enabled: true,\n            trigger: { type: 'order_created' },\n            conditions: [\n              { id: 'cond-1', field: 'channel', operator: 'equals', value: 'amazon_fbm' }\n            ],\n            actions: [\n              { id: 'act-1', type: 'set_order_tag', config: { tag: 'PRIME' } },\n              { id: 'act-2', type: 'set_priority', config: { priority: 'high' } }\n            ],\n            priority: 1,\n            createdAt: new Date(Date.now() - 604800000),\n            updatedAt: new Date(Date.now() - 604800000)\n          },\n          {\n            id: 'rule-2',\n            name: 'Auto-assign USPS for small orders',\n            description: 'Orders under $50 and less than 1lb ship USPS First Class',\n            enabled: true,\n            trigger: { type: 'order_created' },\n            conditions: [\n              { id: 'cond-2', field: 'total', operator: 'less_than', value: 50 }\n            ],\n            actions: [\n              { id: 'act-3', type: 'assign_carrier', config: { carrier: 'usps' } },\n              { id: 'act-4', type: 'assign_service', config: { service: 'first_class' } }\n            ],\n            priority: 2,\n            createdAt: new Date(Date.now() - 259200000),\n            updatedAt: new Date(Date.now() - 259200000)\n          },\n          {\n            id: 'rule-3',\n            name: 'Low stock notification',\n            description: 'Send email when stock falls below 50 units',\n            enabled: false,\n            trigger: { type: 'low_stock', threshold: 50 },\n            conditions: [],\n            actions: [\n              { id: 'act-5', type: 'send_notification', config: { message: 'Stock is running low!' } },\n              { id: 'act-6', type: 'create_po_draft', config: { quantity: 100 } }\n            ],\n            priority: 3,\n            createdAt: new Date(Date.now() - 172800000),\n            updatedAt: new Date(Date.now() - 172800000)\n          }\n        ];\n\n        // Create mock lots\n        const mockLots: InventoryLot[] = [\n          {\n            id: 'lot-1',\n            lotNumber: 'LOT-20241215-001',\n            productId: 'prod-mic-500',\n            productName: '500mL Micro 5-0-1',\n            sku: 'CNMIC500ML',\n            quantity: 100,\n            reservedQty: 5,\n            expirationDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days from now\n            manufacturedDate: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000), // 60 days ago\n            receivedDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), // 30 days ago\n            status: 'active',\n            locationId: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            supplierLotNumber: 'HG-2024-1234',\n          },\n          {\n            id: 'lot-2',\n            lotNumber: 'LOT-20241201-001',\n            productId: 'prod-mic-500',\n            productName: '500mL Micro 5-0-1',\n            sku: 'CNMIC500ML',\n            quantity: 50,\n            reservedQty: 0,\n            expirationDate: new Date(Date.now() + 10 * 24 * 60 * 60 * 1000), // 10 days from now (expiring soon)\n            manufacturedDate: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000),\n            receivedDate: new Date(Date.now() - 45 * 24 * 60 * 60 * 1000),\n            status: 'active',\n            locationId: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            supplierLotNumber: 'HG-2024-1198',\n          },\n          {\n            id: 'lot-3',\n            lotNumber: 'LOT-20241220-001',\n            productId: 'prod-gro-1l',\n            productName: '1L Grow 2-1-6',\n            sku: 'CNGRO1L',\n            quantity: 75,\n            reservedQty: 10,\n            expirationDate: new Date(Date.now() + 180 * 24 * 60 * 60 * 1000), // 6 months from now\n            manufacturedDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),\n            receivedDate: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000),\n            status: 'active',\n            locationId: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n          },\n          {\n            id: 'lot-4',\n            lotNumber: 'LOT-20241101-001',\n            productId: 'prod-bb-500',\n            productName: '500mL Bud Booster 0-1-3',\n            sku: 'CNBB500ML',\n            quantity: 25,\n            reservedQty: 0,\n            expirationDate: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000), // 5 days ago (expired)\n            manufacturedDate: new Date(Date.now() - 120 * 24 * 60 * 60 * 1000),\n            receivedDate: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000),\n            status: 'expired',\n            locationId: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            notes: 'Expired - pending disposal',\n          },\n          {\n            id: 'lot-5',\n            lotNumber: 'LOT-20241210-001',\n            productId: 'prod-mic-1l',\n            productName: '1L Micro 5-0-1',\n            sku: 'CNMIC1L',\n            quantity: 40,\n            reservedQty: 0,\n            receivedDate: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000),\n            status: 'quarantine',\n            locationId: 'loc-warehouse',\n            locationName: 'Texas Warehouse',\n            notes: 'Quality check pending - suspected contamination',\n          },\n        ];\n\n        dispatch({ type: 'SET_LOCATIONS', payload: transformedLocations });\n        dispatch({ type: 'SET_PRODUCTS', payload: transformedProducts });\n        dispatch({ type: 'SET_INVENTORY', payload: transformedInventory });\n        dispatch({ type: 'SET_ORDERS', payload: transformedOrders });\n        dispatch({ type: 'SET_PURCHASE_ORDERS', payload: transformedPOs });\n        dispatch({ type: 'SET_WORK_ORDERS', payload: transformedWOs });\n        dispatch({ type: 'SET_BUNDLES', payload: transformedBundles });\n        dispatch({ type: 'SET_BOXES', payload: transformedBoxes });\n        dispatch({ type: 'SET_SHIPMENTS', payload: mockShipments });\n        dispatch({ type: 'SET_PICKING_BATCHES', payload: mockPickingBatches });\n        dispatch({ type: 'SET_RETURNS', payload: mockReturns });\n        dispatch({ type: 'SET_STOCK_COUNTS', payload: mockStockCounts });\n        dispatch({ type: 'SET_TRANSFERS', payload: mockTransfers });\n        dispatch({ type: 'SET_AUTOMATION_RULES', payload: mockAutomationRules });\n        dispatch({ type: 'SET_LOTS', payload: mockLots });\n\n        // Create mock suppliers\n        const mockSuppliers: Supplier[] = [\n          {\n            id: 'sup-hgc',\n            name: 'HIGROCORP INC.',\n            code: 'HGC',\n            contactName: 'John Martinez',\n            email: 'john@higrocorp.com',\n            phone: '(555) 123-4567',\n            website: 'https://higrocorp.com',\n            address: {\n              street: '123 Industrial Blvd',\n              city: 'Houston',\n              state: 'TX',\n              zip: '77001',\n              country: 'US',\n            },\n            currency: 'USD',\n            paymentTerms: 'Net 30',\n            leadTimeDays: 14,\n            minimumOrderValue: 500,\n            notes: 'Primary nutrient supplier',\n            isActive: true,\n            createdAt: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000),\n            updatedAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),\n          },\n          {\n            id: 'sup-btl',\n            name: 'Bottle Supply Co',\n            code: 'BTL',\n            contactName: 'Sarah Chen',\n            email: 'sarah@bottlesupply.com',\n            phone: '(555) 987-6543',\n            currency: 'USD',\n            paymentTerms: 'Net 15',\n            leadTimeDays: 7,\n            minimumOrderValue: 250,\n            isActive: true,\n            createdAt: new Date(Date.now() - 180 * 24 * 60 * 60 * 1000),\n            updatedAt: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000),\n          },\n          {\n            id: 'sup-lbl',\n            name: 'Label Pros International',\n            code: 'LBL',\n            contactName: 'Mike Wilson',\n            email: 'mike@labelpros.com',\n            phone: '(555) 456-7890',\n            currency: 'USD',\n            paymentTerms: 'COD',\n            leadTimeDays: 10,\n            isActive: true,\n            createdAt: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000),\n            updatedAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),\n          },\n        ];\n\n        // Create mock product-supplier relationships\n        const mockProductSuppliers: ProductSupplier[] = [\n          {\n            productId: 'prod-mic-500',\n            supplierId: 'sup-hgc',\n            supplierSku: 'HGC-MIC-500',\n            unitCost: 3.50,\n            currency: 'USD',\n            minimumOrderQty: 100,\n            leadTimeDays: 14,\n            isPrimary: true,\n            lastOrderedAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),\n          },\n          {\n            productId: 'prod-mic-1l',\n            supplierId: 'sup-hgc',\n            supplierSku: 'HGC-MIC-1L',\n            unitCost: 5.75,\n            currency: 'USD',\n            minimumOrderQty: 50,\n            leadTimeDays: 14,\n            isPrimary: true,\n          },\n          {\n            productId: 'prod-gro-1l',\n            supplierId: 'sup-hgc',\n            supplierSku: 'HGC-GRO-1L',\n            unitCost: 5.50,\n            currency: 'USD',\n            minimumOrderQty: 50,\n            isPrimary: true,\n          },\n          {\n            productId: 'prod-bb-500',\n            supplierId: 'sup-hgc',\n            supplierSku: 'HGC-BB-500',\n            unitCost: 4.25,\n            currency: 'USD',\n            minimumOrderQty: 100,\n            isPrimary: true,\n          },\n        ];\n\n        dispatch({ type: 'SET_SUPPLIERS', payload: mockSuppliers });\n        dispatch({ type: 'SET_PRODUCT_SUPPLIERS', payload: mockProductSuppliers });\n        dispatch({ type: 'SET_LOADING', payload: false });\n        dispatch({ type: 'SET_INITIALIZED', payload: true });\n      } catch (error) {\n        console.error('Failed to initialize app data:', error);\n        dispatch({ type: 'SET_LOADING', payload: false });\n      }\n    };\n\n    initializeData();\n  }, [isDemo, authLoading]);\n\n  return (\n    <AppContext.Provider value={{ state, dispatch }}>\n      {children}\n    </AppContext.Provider>\n  );\n}\n\n// Hook\nexport function useApp() {\n  const context = useContext(AppContext);\n  if (context === undefined) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n}\n\n// Selector hooks for common data access patterns\nexport function useProducts() {\n  const { state } = useApp();\n  return state.products;\n}\n\nexport function useOrders() {\n  const { state } = useApp();\n  return state.orders;\n}\n\nexport function useInventory() {\n  const { state } = useApp();\n  return state.inventory;\n}\n\nexport function useLocations() {\n  const { state } = useApp();\n  return state.locations;\n}\n\nexport function useSettings() {\n  const { state } = useApp();\n  return state.settings;\n}\n\n// Helper to get product stock across all locations\nexport function useProductStock(productId: string) {\n  const { state } = useApp();\n  return state.inventory\n    .filter(inv => inv.productId === productId)\n    .reduce((total, inv) => total + inv.quantity, 0);\n}\n\n// Helper to get stock at a specific location\nexport function useLocationStock(productId: string, locationId: string) {\n  const { state } = useApp();\n  const inv = state.inventory.find(\n    i => i.productId === productId && i.locationId === locationId\n  );\n  return inv?.quantity || 0;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3078, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/context/DateRangeContext.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useState, useMemo, ReactNode, useCallback } from 'react'\n\nexport type DateRangePreset = 'today' | 'yesterday' | 'wtd' | 'mtd' | 'qtd' | 'ytd' | 'last7' | 'last30' | 'last90' | 'custom'\n\nexport interface DateRangeValue {\n  startDate: Date\n  endDate: Date\n  preset: DateRangePreset\n  label: string\n}\n\ninterface DateRangeContextType {\n  // Current date range\n  dateRange: DateRangeValue\n  preset: DateRangePreset\n\n  // Setters\n  setPreset: (preset: DateRangePreset) => void\n  setCustomRange: (startDate: Date, endDate: Date) => void\n\n  // Helpers\n  isInRange: (date: Date | string) => boolean\n  getComparisonRange: () => { startDate: Date; endDate: Date } | null\n\n  // Preset labels for UI\n  presetLabels: Record<DateRangePreset, string>\n}\n\nconst DateRangeContext = createContext<DateRangeContextType | undefined>(undefined)\n\n// Get date range from preset\nfunction getDateRangeFromPreset(preset: DateRangePreset, customStart?: Date, customEnd?: Date): DateRangeValue {\n  const now = new Date()\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n  const endOfToday = new Date(today)\n  endOfToday.setHours(23, 59, 59, 999)\n\n  const labels: Record<DateRangePreset, string> = {\n    today: 'Today',\n    yesterday: 'Yesterday',\n    wtd: 'Week to Date',\n    mtd: 'Month to Date',\n    qtd: 'Quarter to Date',\n    ytd: 'Year to Date',\n    last7: 'Last 7 Days',\n    last30: 'Last 30 Days',\n    last90: 'Last 90 Days',\n    custom: 'Custom Range',\n  }\n\n  switch (preset) {\n    case 'today':\n      return {\n        startDate: today,\n        endDate: endOfToday,\n        preset,\n        label: labels.today,\n      }\n\n    case 'yesterday': {\n      const yesterday = new Date(today)\n      yesterday.setDate(yesterday.getDate() - 1)\n      const endOfYesterday = new Date(yesterday)\n      endOfYesterday.setHours(23, 59, 59, 999)\n      return {\n        startDate: yesterday,\n        endDate: endOfYesterday,\n        preset,\n        label: labels.yesterday,\n      }\n    }\n\n    case 'wtd': {\n      // Week starts on Sunday (adjust if needed)\n      const dayOfWeek = today.getDay()\n      const startOfWeek = new Date(today)\n      startOfWeek.setDate(today.getDate() - dayOfWeek)\n      return {\n        startDate: startOfWeek,\n        endDate: endOfToday,\n        preset,\n        label: labels.wtd,\n      }\n    }\n\n    case 'mtd': {\n      const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\n      return {\n        startDate: startOfMonth,\n        endDate: endOfToday,\n        preset,\n        label: labels.mtd,\n      }\n    }\n\n    case 'qtd': {\n      const quarter = Math.floor(today.getMonth() / 3)\n      const startOfQuarter = new Date(today.getFullYear(), quarter * 3, 1)\n      return {\n        startDate: startOfQuarter,\n        endDate: endOfToday,\n        preset,\n        label: labels.qtd,\n      }\n    }\n\n    case 'ytd': {\n      const startOfYear = new Date(today.getFullYear(), 0, 1)\n      return {\n        startDate: startOfYear,\n        endDate: endOfToday,\n        preset,\n        label: labels.ytd,\n      }\n    }\n\n    case 'last7': {\n      const start = new Date(today)\n      start.setDate(today.getDate() - 6) // Include today = 7 days\n      return {\n        startDate: start,\n        endDate: endOfToday,\n        preset,\n        label: labels.last7,\n      }\n    }\n\n    case 'last30': {\n      const start = new Date(today)\n      start.setDate(today.getDate() - 29) // Include today = 30 days\n      return {\n        startDate: start,\n        endDate: endOfToday,\n        preset,\n        label: labels.last30,\n      }\n    }\n\n    case 'last90': {\n      const start = new Date(today)\n      start.setDate(today.getDate() - 89) // Include today = 90 days\n      return {\n        startDate: start,\n        endDate: endOfToday,\n        preset,\n        label: labels.last90,\n      }\n    }\n\n    case 'custom': {\n      if (customStart && customEnd) {\n        const formattedStart = customStart.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n        const formattedEnd = customEnd.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n        return {\n          startDate: customStart,\n          endDate: customEnd,\n          preset,\n          label: `${formattedStart} - ${formattedEnd}`,\n        }\n      }\n      // Default custom to last 30 days if no dates provided\n      const start = new Date(today)\n      start.setDate(today.getDate() - 29)\n      return {\n        startDate: start,\n        endDate: endOfToday,\n        preset,\n        label: labels.custom,\n      }\n    }\n\n    default:\n      return {\n        startDate: today,\n        endDate: endOfToday,\n        preset: 'today',\n        label: labels.today,\n      }\n  }\n}\n\nexport function DateRangeProvider({ children }: { children: ReactNode }) {\n  const [preset, setPresetState] = useState<DateRangePreset>('mtd')\n  const [customStart, setCustomStart] = useState<Date | undefined>()\n  const [customEnd, setCustomEnd] = useState<Date | undefined>()\n\n  // Calculate current date range\n  const dateRange = useMemo(() => {\n    return getDateRangeFromPreset(preset, customStart, customEnd)\n  }, [preset, customStart, customEnd])\n\n  // Set preset\n  const setPreset = useCallback((newPreset: DateRangePreset) => {\n    setPresetState(newPreset)\n    if (newPreset !== 'custom') {\n      setCustomStart(undefined)\n      setCustomEnd(undefined)\n    }\n  }, [])\n\n  // Set custom range\n  const setCustomRange = useCallback((startDate: Date, endDate: Date) => {\n    // Normalize dates to start/end of day\n    const start = new Date(startDate)\n    start.setHours(0, 0, 0, 0)\n\n    const end = new Date(endDate)\n    end.setHours(23, 59, 59, 999)\n\n    setCustomStart(start)\n    setCustomEnd(end)\n    setPresetState('custom')\n  }, [])\n\n  // Check if a date is in the current range\n  const isInRange = useCallback((date: Date | string): boolean => {\n    const checkDate = typeof date === 'string' ? new Date(date) : date\n    // Compare timestamps to avoid any date object comparison issues\n    const checkTime = checkDate.getTime()\n    const startTime = dateRange.startDate.getTime()\n    const endTime = dateRange.endDate.getTime()\n    return checkTime >= startTime && checkTime <= endTime\n  }, [dateRange])\n\n  // Get comparison period (same length, previous period)\n  const getComparisonRange = useCallback(() => {\n    const { startDate, endDate } = dateRange\n    const duration = endDate.getTime() - startDate.getTime()\n\n    const compEnd = new Date(startDate.getTime() - 1) // Day before start\n    compEnd.setHours(23, 59, 59, 999)\n\n    const compStart = new Date(compEnd.getTime() - duration)\n    compStart.setHours(0, 0, 0, 0)\n\n    return { startDate: compStart, endDate: compEnd }\n  }, [dateRange])\n\n  // Preset labels\n  const presetLabels: Record<DateRangePreset, string> = {\n    today: 'Today',\n    yesterday: 'Yesterday',\n    wtd: 'Week to Date',\n    mtd: 'Month to Date',\n    qtd: 'Quarter to Date',\n    ytd: 'Year to Date',\n    last7: 'Last 7 Days',\n    last30: 'Last 30 Days',\n    last90: 'Last 90 Days',\n    custom: 'Custom Range',\n  }\n\n  const value: DateRangeContextType = {\n    dateRange,\n    preset,\n    setPreset,\n    setCustomRange,\n    isInRange,\n    getComparisonRange,\n    presetLabels,\n  }\n\n  return (\n    <DateRangeContext.Provider value={value}>\n      {children}\n    </DateRangeContext.Provider>\n  )\n}\n\nexport function useDateRange() {\n  const context = useContext(DateRangeContext)\n  if (context === undefined) {\n    throw new Error('useDateRange must be used within a DateRangeProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3364, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/components/ui/Toast.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useCallback, ReactNode } from 'react';\n\ntype ToastType = 'success' | 'error' | 'info' | 'warning';\n\ninterface Toast {\n  id: string;\n  type: ToastType;\n  message: string;\n  duration?: number;\n}\n\ninterface ToastContextType {\n  toasts: Toast[];\n  addToast: (type: ToastType, message: string, duration?: number) => void;\n  removeToast: (id: string) => void;\n  success: (message: string, duration?: number) => void;\n  error: (message: string, duration?: number) => void;\n  info: (message: string, duration?: number) => void;\n  warning: (message: string, duration?: number) => void;\n}\n\nconst ToastContext = createContext<ToastContextType | undefined>(undefined);\n\nexport function ToastProvider({ children }: { children: ReactNode }) {\n  const [toasts, setToasts] = useState<Toast[]>([]);\n\n  const addToast = useCallback((type: ToastType, message: string, duration = 4000) => {\n    const id = Math.random().toString(36).substring(7);\n    setToasts(prev => [...prev, { id, type, message, duration }]);\n\n    if (duration > 0) {\n      setTimeout(() => {\n        setToasts(prev => prev.filter(t => t.id !== id));\n      }, duration);\n    }\n  }, []);\n\n  const removeToast = useCallback((id: string) => {\n    setToasts(prev => prev.filter(t => t.id !== id));\n  }, []);\n\n  // Convenience methods\n  const success = useCallback((message: string, duration?: number) => {\n    addToast('success', message, duration);\n  }, [addToast]);\n\n  const error = useCallback((message: string, duration?: number) => {\n    addToast('error', message, duration);\n  }, [addToast]);\n\n  const info = useCallback((message: string, duration?: number) => {\n    addToast('info', message, duration);\n  }, [addToast]);\n\n  const warning = useCallback((message: string, duration?: number) => {\n    addToast('warning', message, duration);\n  }, [addToast]);\n\n  return (\n    <ToastContext.Provider value={{ toasts, addToast, removeToast, success, error, info, warning }}>\n      {children}\n      <ToastContainer toasts={toasts} removeToast={removeToast} />\n    </ToastContext.Provider>\n  );\n}\n\nexport function useToast() {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within ToastProvider');\n  }\n  return context;\n}\n\n// Toast icons mapping\nconst toastIcons: Record<ToastType, string> = {\n  success: 'fa-check-circle',\n  error: 'fa-exclamation-circle',\n  info: 'fa-info-circle',\n  warning: 'fa-exclamation-triangle',\n};\n\n// Toast colors mapping\nconst toastColors: Record<ToastType, { bg: string; border: string; text: string }> = {\n  success: {\n    bg: 'bg-emerald-500/20',\n    border: 'border-emerald-500/30',\n    text: 'text-emerald-400',\n  },\n  error: {\n    bg: 'bg-red-500/20',\n    border: 'border-red-500/30',\n    text: 'text-red-400',\n  },\n  info: {\n    bg: 'bg-blue-500/20',\n    border: 'border-blue-500/30',\n    text: 'text-blue-400',\n  },\n  warning: {\n    bg: 'bg-amber-500/20',\n    border: 'border-amber-500/30',\n    text: 'text-amber-400',\n  },\n};\n\n// Toast Container Component\nfunction ToastContainer({\n  toasts,\n  removeToast,\n}: {\n  toasts: Toast[];\n  removeToast: (id: string) => void;\n}) {\n  if (toasts.length === 0) return null;\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50 space-y-2 max-w-md\">\n      {toasts.map(toast => {\n        const colors = toastColors[toast.type];\n        const icon = toastIcons[toast.type];\n\n        return (\n          <div\n            key={toast.id}\n            className={`\n              flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border backdrop-blur-sm\n              animate-in slide-in-from-right-full duration-300\n              ${colors.bg} ${colors.border} ${colors.text}\n            `}\n            role=\"alert\"\n          >\n            <i className={`fas ${icon} flex-shrink-0`}></i>\n            <span className=\"text-sm flex-1\">{toast.message}</span>\n            <button\n              onClick={() => removeToast(toast.id)}\n              className=\"ml-2 text-slate-400 hover:text-white transition-colors flex-shrink-0\"\n              aria-label=\"Dismiss\"\n            >\n              <i className=\"fas fa-times text-xs\"></i>\n            </button>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default ToastProvider;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3587, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/components/ui/ConfirmDialog.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useCallback, ReactNode, useEffect } from 'react';\n\ninterface ConfirmOptions {\n  title: string;\n  message: string;\n  confirmText?: string;\n  cancelText?: string;\n  destructive?: boolean;\n  icon?: string;\n}\n\ninterface ConfirmContextType {\n  confirm: (options: ConfirmOptions) => Promise<boolean>;\n}\n\nconst ConfirmContext = createContext<ConfirmContextType | undefined>(undefined);\n\nexport function ConfirmProvider({ children }: { children: ReactNode }) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [options, setOptions] = useState<ConfirmOptions | null>(null);\n  const [resolvePromise, setResolvePromise] = useState<((value: boolean) => void) | null>(null);\n\n  const confirm = useCallback((opts: ConfirmOptions): Promise<boolean> => {\n    setOptions(opts);\n    setIsOpen(true);\n    return new Promise(resolve => {\n      setResolvePromise(() => resolve);\n    });\n  }, []);\n\n  const handleConfirm = useCallback(() => {\n    resolvePromise?.(true);\n    setIsOpen(false);\n    setOptions(null);\n  }, [resolvePromise]);\n\n  const handleCancel = useCallback(() => {\n    resolvePromise?.(false);\n    setIsOpen(false);\n    setOptions(null);\n  }, [resolvePromise]);\n\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isOpen) {\n        handleCancel();\n      }\n    };\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, handleCancel]);\n\n  // Prevent body scroll when dialog is open\n  useEffect(() => {\n    if (isOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [isOpen]);\n\n  return (\n    <ConfirmContext.Provider value={{ confirm }}>\n      {children}\n      {isOpen && options && (\n        <div\n          className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\n          onClick={handleCancel}\n        >\n          <div\n            className=\"bg-slate-900 border border-slate-700 rounded-xl p-6 max-w-md w-full shadow-2xl animate-in zoom-in-95 duration-200\"\n            onClick={e => e.stopPropagation()}\n          >\n            {/* Icon */}\n            {options.icon && (\n              <div className={`w-12 h-12 rounded-full flex items-center justify-center mb-4 ${\n                options.destructive ? 'bg-red-500/20' : 'bg-blue-500/20'\n              }`}>\n                <i className={`fas ${options.icon} text-xl ${\n                  options.destructive ? 'text-red-400' : 'text-blue-400'\n                }`}></i>\n              </div>\n            )}\n\n            {/* Title */}\n            <h3 className=\"text-lg font-semibold text-white mb-2\">{options.title}</h3>\n\n            {/* Message */}\n            <p className=\"text-slate-400 mb-6\">{options.message}</p>\n\n            {/* Actions */}\n            <div className=\"flex gap-3 justify-end\">\n              <button\n                onClick={handleCancel}\n                className=\"px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg transition-colors\"\n              >\n                {options.cancelText || 'Cancel'}\n              </button>\n              <button\n                onClick={handleConfirm}\n                className={`px-4 py-2 rounded-lg transition-colors font-medium ${\n                  options.destructive\n                    ? 'bg-red-600 hover:bg-red-500 text-white'\n                    : 'bg-emerald-600 hover:bg-emerald-500 text-white'\n                }`}\n              >\n                {options.confirmText || 'Confirm'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </ConfirmContext.Provider>\n  );\n}\n\nexport function useConfirm() {\n  const context = useContext(ConfirmContext);\n  if (!context) {\n    throw new Error('useConfirm must be used within ConfirmProvider');\n  }\n  return context.confirm;\n}\n\nexport default ConfirmProvider;\n"],"names":[],"mappings":";;;;;;;;;AAEA;;;AAFA;;AAiBA,MAAM,+BAAiB,IAAA,8KAAa,EAAiC;AAE9D,SAAS,gBAAgB,EAAE,QAAQ,EAA2B;;IACnE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAwB;IAC9D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAoC;IAExF,MAAM,UAAU,IAAA,4KAAW;gDAAC,CAAC;YAC3B,WAAW;YACX,UAAU;YACV,OAAO,IAAI;wDAAQ,CAAA;oBACjB;gEAAkB,IAAM;;gBAC1B;;QACF;+CAAG,EAAE;IAEL,MAAM,gBAAgB,IAAA,4KAAW;sDAAC;YAChC,iBAAiB;YACjB,UAAU;YACV,WAAW;QACb;qDAAG;QAAC;KAAe;IAEnB,MAAM,eAAe,IAAA,4KAAW;qDAAC;YAC/B,iBAAiB;YACjB,UAAU;YACV,WAAW;QACb;oDAAG;QAAC;KAAe;IAEnB,oBAAoB;IACpB,IAAA,0KAAS;qCAAC;YACR,MAAM;0DAAe,CAAC;oBACpB,IAAI,EAAE,GAAG,KAAK,YAAY,QAAQ;wBAChC;oBACF;gBACF;;YACA,SAAS,gBAAgB,CAAC,WAAW;YACrC;6CAAO,IAAM,SAAS,mBAAmB,CAAC,WAAW;;QACvD;oCAAG;QAAC;QAAQ;KAAa;IAEzB,0CAA0C;IAC1C,IAAA,0KAAS;qCAAC;YACR,IAAI,QAAQ;gBACV,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;YACjC,OAAO;gBACL,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;YACjC;YACA;6CAAO;oBACL,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;gBACjC;;QACF;oCAAG;QAAC;KAAO;IAEX,qBACE,6LAAC,eAAe,QAAQ;QAAC,OAAO;YAAE;QAAQ;;YACvC;YACA,UAAU,yBACT,6LAAC;gBACC,WAAU;gBACV,SAAS;0BAET,cAAA,6LAAC;oBACC,WAAU;oBACV,SAAS,CAAA,IAAK,EAAE,eAAe;;wBAG9B,QAAQ,IAAI,kBACX,6LAAC;4BAAI,WAAW,CAAC,6DAA6D,EAC5E,QAAQ,WAAW,GAAG,kBAAkB,kBACxC;sCACA,cAAA,6LAAC;gCAAE,WAAW,CAAC,IAAI,EAAE,QAAQ,IAAI,CAAC,SAAS,EACzC,QAAQ,WAAW,GAAG,iBAAiB,iBACvC;;;;;;;;;;;sCAKN,6LAAC;4BAAG,WAAU;sCAAyC,QAAQ,KAAK;;;;;;sCAGpE,6LAAC;4BAAE,WAAU;sCAAuB,QAAQ,OAAO;;;;;;sCAGnD,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,SAAS;oCACT,WAAU;8CAET,QAAQ,UAAU,IAAI;;;;;;8CAEzB,6LAAC;oCACC,SAAS;oCACT,WAAW,CAAC,mDAAmD,EAC7D,QAAQ,WAAW,GACf,2CACA,kDACJ;8CAED,QAAQ,WAAW,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQxC;GArGgB;KAAA;AAuGT,SAAS;;IACd,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,QAAQ,OAAO;AACxB;IANgB;uCAQD"}},
    {"offset": {"line": 3783, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/1TB%20SSD/inventory-app/components/Providers.tsx"],"sourcesContent":["'use client';\n\nimport { ReactNode } from 'react';\nimport { AuthProvider } from '@/context/AuthContext';\nimport { OrganizationProvider } from '@/context/OrganizationContext';\nimport { AppProvider } from '@/context/AppContext';\nimport { DateRangeProvider } from '@/context/DateRangeContext';\nimport { ToastProvider } from '@/components/ui/Toast';\nimport { ConfirmProvider } from '@/components/ui/ConfirmDialog';\n\ninterface ProvidersProps {\n  children: ReactNode;\n}\n\nexport function Providers({ children }: ProvidersProps) {\n  return (\n    <AuthProvider>\n      <OrganizationProvider>\n        <DateRangeProvider>\n          <AppProvider>\n            <ToastProvider>\n              <ConfirmProvider>\n                {children}\n              </ConfirmProvider>\n            </ToastProvider>\n          </AppProvider>\n        </DateRangeProvider>\n      </OrganizationProvider>\n    </AuthProvider>\n  );\n}\n\nexport default Providers;\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;AAcO,SAAS,UAAU,EAAE,QAAQ,EAAkB;IACpD,qBACE,6LAAC,0IAAY;kBACX,cAAA,6LAAC,0JAAoB;sBACnB,cAAA,6LAAC,oJAAiB;0BAChB,cAAA,6LAAC,wIAAW;8BACV,cAAA,6LAAC,8IAAa;kCACZ,cAAA,6LAAC,wJAAe;sCACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjB;KAhBgB;uCAkBD"}}]
}