(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52008,e=>{"use strict";let s=(0,e.i(75254).default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);e.s(["Layers",()=>s],52008)},63207,e=>{"use strict";function s(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function t(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function a(e){return new Intl.NumberFormat("en-US").format(e)}function r(e,s=!0){return s?`${e>=0?"+":""}${e.toFixed(1)}%`:`${e.toFixed(1)}%`}function l(e){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function i(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}e.s(["formatCurrency",()=>s,"formatCurrencyPrecise",()=>t,"formatDate",()=>l,"formatDateTime",()=>i,"formatNumber",()=>a,"formatPercent",()=>r])},76525,e=>{"use strict";var s=e.i(43476),t=e.i(22016);let a={primary:"bg-emerald-600 hover:bg-emerald-500 text-white border-transparent",secondary:"bg-slate-800 hover:bg-slate-700 text-slate-300 border-slate-700",ghost:"bg-transparent hover:bg-slate-800 text-slate-400 hover:text-white border-transparent",danger:"bg-red-600 hover:bg-red-500 text-white border-transparent"},r={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-base"};function l({variant:e="primary",size:l="md",icon:i,iconPosition:n="left",children:c,className:d="",disabled:o,href:m,...x}){let h=`inline-flex items-center justify-center gap-2 font-medium rounded-lg border transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${a[e]} ${r[l]} ${d}`,u=(0,s.jsxs)(s.Fragment,{children:[i&&"left"===n&&(0,s.jsx)("i",{className:i}),c,i&&"right"===n&&(0,s.jsx)("i",{className:i})]});return m?(0,s.jsx)(t.default,{href:m,className:h,children:u}):(0,s.jsx)("button",{className:h,disabled:o,...x,children:u})}e.s(["Button",()=>l])},55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},46040,e=>{"use strict";var s=e.i(43476),t=e.i(71645);let a={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};function r({open:e,onClose:r,title:l,subtitle:i,children:n,footer:c,size:d="md",className:o=""}){return((0,t.useEffect)(()=>{let s=s=>{"Escape"===s.key&&e&&r()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[e,r]),(0,t.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),e)?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:r}),(0,s.jsxs)("div",{className:`relative bg-slate-900 border border-slate-700 rounded-2xl w-full ${a[d]} m-4 shadow-2xl ${o}`,children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-slate-700 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white",children:l}),i&&(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-0.5",children:i})]}),(0,s.jsx)("button",{onClick:r,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,s.jsx)("i",{className:"fas fa-times"})})]}),(0,s.jsx)("div",{className:"p-6 max-h-[calc(100vh-16rem)] overflow-y-auto",children:n}),c&&(0,s.jsx)("div",{className:"px-6 py-4 border-t border-slate-700 flex items-center justify-end gap-3",children:c})]})]}):null}e.s(["Modal",()=>r])},64635,48616,e=>{"use strict";var s=e.i(43476),t=e.i(63207);function a({icon:e,iconColor:a,value:r,label:l,format:i="number",onClick:n,isActive:c=!1,borderColor:d}){let o={blue:{border:"border-blue-500/30",bg:"bg-blue-500/10",hover:"hover:bg-blue-500/10",iconBg:"bg-blue-500/20",ring:"ring-blue-500/30"},emerald:{border:"border-emerald-500/30",bg:"bg-emerald-500/10",hover:"hover:bg-emerald-500/10",iconBg:"bg-emerald-500/20",ring:"ring-emerald-500/30"},amber:{border:"border-amber-500/30",bg:"bg-amber-500/10",hover:"hover:bg-amber-500/10",iconBg:"bg-amber-500/20",ring:"ring-amber-500/30"},red:{border:"border-red-500/30",bg:"bg-red-500/10",hover:"hover:bg-red-500/10",iconBg:"bg-red-500/20",ring:"ring-red-500/30"},purple:{border:"border-purple-500/30",bg:"bg-purple-500/10",hover:"hover:bg-purple-500/10",iconBg:"bg-purple-500/20",ring:"ring-purple-500/30"},slate:{border:"border-slate-700/50",bg:"bg-slate-700/30",hover:"hover:bg-slate-700/30",iconBg:"bg-slate-700/50",ring:"ring-slate-500/30"}},m=o[a]||o.slate,x="currency"===i?(0,t.formatCurrency)("number"==typeof r?r:0):"number"===i?(0,t.formatNumber)("number"==typeof r?r:0):r,h="slate"===a||"white"===a?"text-white":`text-${a}-400`;return(0,s.jsx)("div",{onClick:n,className:`bg-slate-800/50 backdrop-blur border rounded-xl p-4 transition-colors ${n?"cursor-pointer":""} ${m.hover} ${c?`${m.border.replace("/30","/50")} ${m.bg} ring-2 ${m.ring}`:d||m.border}`,children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:`w-10 h-10 rounded-lg ${m.iconBg} flex items-center justify-center`,children:(0,s.jsx)("i",{className:`fas ${e} text-${a}-400`})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:`text-2xl font-bold ${h}`,children:x}),(0,s.jsx)("div",{className:"text-xs text-slate-400",children:l})]})]})})}function r({children:e,columns:t=4}){return(0,s.jsx)("div",{className:`grid ${{4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",7:"grid-cols-7"}[t]} gap-4`,children:e})}function l({current:e,total:t,completed:a=!1}){let r=t>0?e/t*100:0;return(0,s.jsxs)("div",{className:"w-32",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs mb-1",children:[(0,s.jsxs)("span",{className:"text-slate-400",children:[e,"/",t]}),(0,s.jsxs)("span",{className:"text-slate-500",children:[Math.round(r),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,s.jsx)("div",{className:`rounded-full h-2 transition-all ${a?"bg-emerald-500":"bg-blue-500"}`,style:{width:`${r}%`}})})]})}function i({value:e,onChange:t,options:a,placeholder:r}){return(0,s.jsxs)("select",{value:e,onChange:e=>t(e.target.value),className:"bg-slate-800/50 border border-slate-700 rounded-lg px-3 py-2.5 text-slate-200 focus:outline-none focus:border-emerald-500",children:[r&&(0,s.jsx)("option",{value:"",children:r}),a.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))]})}function n({value:e,onChange:t,placeholder:a="Search..."}){return(0,s.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,s.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),(0,s.jsx)("input",{type:"text",placeholder:a,value:e,onChange:e=>t(e.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg pl-10 pr-4 py-2.5 text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500/50"})]})}function c({onClick:e}){return(0,s.jsxs)("button",{onClick:e,className:"px-3 py-2.5 text-slate-400 hover:text-slate-200 transition-colors flex items-center gap-2",children:[(0,s.jsx)("i",{className:"fas fa-times text-sm"}),"Clear"]})}function d({children:e}){return(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-4",children:e})}function o({title:e,subtitle:t,icon:a,backHref:r,actions:l}){return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[r&&(0,s.jsx)("a",{href:r,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:(0,s.jsx)("i",{className:"fas fa-arrow-left"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[a,e]}),t&&(0,s.jsx)("p",{className:"text-sm text-slate-400",children:t})]})]}),l]})}e.s(["ClickableStatCard",()=>a,"InventoryStatsGrid",()=>r,"ProgressBar",()=>l],64635),e.s(["ClearFiltersButton",()=>c,"FilterBar",()=>d,"FilterSelect",()=>i,"PageHeader",()=>o,"SearchInput",()=>n],48616)},59216,e=>{"use strict";var s=e.i(43476);function t({status:e,config:t,animated:a=!1}){let r=t[e];if(!r)return null;let l={slate:"bg-slate-500/10 text-slate-400 border-slate-500/20",blue:"bg-blue-500/10 text-blue-400 border-blue-500/20",emerald:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20",amber:"bg-amber-500/10 text-amber-400 border-amber-500/20",red:"bg-red-500/10 text-red-400 border-red-500/20",purple:"bg-purple-500/10 text-purple-400 border-purple-500/20",orange:"bg-orange-500/10 text-orange-400 border-orange-500/20",cyan:"bg-cyan-500/10 text-cyan-400 border-cyan-500/20"};return(0,s.jsxs)("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium rounded-full border ${l[r.color]||l.slate}`,children:[(0,s.jsx)("i",{className:`fas ${r.icon} ${a?"fa-spin":""} text-[10px]`}),r.label]})}function a({type:e,config:t}){let a=t[e];return a?(0,s.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded border ${{purple:"bg-purple-500/10 text-purple-400 border-purple-500/20",blue:"bg-blue-500/10 text-blue-400 border-blue-500/20",amber:"bg-amber-500/10 text-amber-400 border-amber-500/20"}[a.color]||""}`,children:a.label}):null}function r({status:e,compact:t=!1}){let a={in_stock:{text:"In Stock",color:"text-emerald-400",bg:"bg-emerald-500/10",icon:"âœ“"},low_stock:{text:"Low Stock",color:"text-amber-400",bg:"bg-amber-500/10",icon:"â†“"},out_of_stock:{text:"Out of Stock",color:"text-red-400",bg:"bg-red-500/10",icon:"âœ—"}}[e];return t?(0,s.jsxs)("span",{className:`text-xs ${a.color}`,children:[a.icon," ",a.text]}):(0,s.jsx)("span",{className:`text-xs px-2 py-1 rounded ${a.bg} ${a.color}`,children:a.text})}let l={nutrients:{gradient:"from-emerald-500/20 to-emerald-600/20",border:"border-emerald-500/20",text:"text-emerald-400",icon:"fa-flask",label:"Nutrients"},supplements:{gradient:"from-purple-500/20 to-purple-600/20",border:"border-purple-500/20",text:"text-purple-400",icon:"fa-seedling",label:"Supplements"},ph_adjusters:{gradient:"from-blue-500/20 to-blue-600/20",border:"border-blue-500/20",text:"text-blue-400",icon:"fa-vial",label:"pH Adjusters"},bundles:{gradient:"from-amber-500/20 to-amber-600/20",border:"border-amber-500/20",text:"text-amber-400",icon:"fa-boxes-stacked",label:"Bundles"}};function i(e){return l[e]||l.nutrients}function n({category:e,size:t="md"}){let a=i(e),r={sm:{container:"w-8 h-8",icon:"text-sm"},md:{container:"w-12 h-12",icon:""},lg:{container:"w-16 h-16",icon:"text-2xl"}};return(0,s.jsx)("div",{className:`${r[t].container} bg-gradient-to-br ${a.gradient} rounded-lg flex items-center justify-center border ${a.border}`,children:(0,s.jsx)("i",{className:`fas ${a.icon} ${a.text} ${r[t].icon}`})})}e.s(["CategoryIcon",()=>n,"StatusBadge",()=>t,"StockStatus",()=>r,"TypeBadge",()=>a,"categoryStyles",0,l,"countTypeConfig",0,{full:{label:"Full Count",color:"purple"},cycle:{label:"Cycle Count",color:"blue"},spot:{label:"Spot Check",color:"amber"}},"getCategoryStyle",()=>i,"stockCountStatusConfig",0,{draft:{color:"slate",icon:"fa-file",label:"Draft"},in_progress:{color:"blue",icon:"fa-spinner",label:"In Progress"},completed:{color:"emerald",icon:"fa-check-circle",label:"Completed"},cancelled:{color:"red",icon:"fa-times-circle",label:"Cancelled"}},"transferStatusConfig",0,{draft:{color:"slate",icon:"fa-edit",label:"Draft"},pending:{color:"amber",icon:"fa-clock",label:"Pending"},in_transit:{color:"blue",icon:"fa-truck",label:"In Transit"},received:{color:"emerald",icon:"fa-check",label:"Received"},cancelled:{color:"red",icon:"fa-times",label:"Cancelled"}}])},40554,e=>{"use strict";var s=e.i(43476);function t({icon:e,title:t,description:a,showFilterHint:r,action:l}){return(0,s.jsxs)("div",{className:"p-8 text-center text-slate-500",children:[(0,s.jsx)("i",{className:`fas ${e} text-4xl mb-4 text-slate-600`}),(0,s.jsx)("p",{className:"font-medium text-white mb-2",children:t}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:a}),r&&(0,s.jsx)("p",{className:"text-sm mt-2",children:"Try adjusting your filters"}),l&&(0,s.jsx)("div",{className:"mt-4",children:l})]})}function a({currentPage:e,totalPages:t,totalItems:a,itemsPerPage:r,itemLabel:l="items",onPageChange:i}){if(t<=1)return null;let n=Math.min(e*r,a);return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-t border-slate-700/50",children:[(0,s.jsxs)("div",{className:"text-sm text-slate-400",children:["Showing ",(e-1)*r+1," to ",n," of ",a," ",l]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>i(Math.max(1,e-1)),disabled:1===e,className:"px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-slate-300 transition-colors",children:(0,s.jsx)("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(5,t)},(a,r)=>{let l;return l=t<=5||e<=3?r+1:e>=t-2?t-4+r:e-2+r,(0,s.jsx)("button",{onClick:()=>i(l),className:`px-3 py-1.5 rounded-lg transition-colors ${e===l?"bg-emerald-600 text-white":"bg-slate-700/50 hover:bg-slate-600/50 text-slate-300"}`,children:l},l)}),(0,s.jsx)("button",{onClick:()=>i(Math.min(t,e+1)),disabled:e===t,className:"px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-slate-300 transition-colors",children:(0,s.jsx)("i",{className:"fas fa-chevron-right"})})]})]})}function r({children:e}){return(0,s.jsx)("div",{className:"bg-slate-800/50 backdrop-blur border border-slate-700/50 rounded-xl overflow-hidden",children:e})}function l({icon:e,onClick:t,color:a="slate",title:r,disabled:l}){return(0,s.jsx)("button",{onClick:t,disabled:l,title:r,className:`p-2 rounded-lg transition-colors ${{slate:"text-slate-400 hover:bg-slate-600/50",blue:"text-blue-400 hover:bg-blue-500/20",emerald:"text-emerald-400 hover:bg-emerald-500/20",amber:"text-amber-400 hover:bg-amber-500/20",red:"text-red-400 hover:bg-red-500/20"}[a]} ${l?"opacity-50 cursor-not-allowed":""}`,children:(0,s.jsx)("i",{className:`fas ${e}`})})}function i({icon:e,label:t,onClick:a,variant:r="primary"}){return(0,s.jsxs)("button",{onClick:a,className:`px-4 py-2 rounded-lg transition-colors flex items-center gap-2 ${{primary:"bg-emerald-600 hover:bg-emerald-500 text-white",secondary:"bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300"}[r]}`,children:[(0,s.jsx)("i",{className:`fas ${e} text-sm`}),t]})}e.s(["ActionButton",()=>l,"EmptyState",()=>t,"Pagination",()=>a,"PrimaryActionButton",()=>i,"TableWrapper",()=>r])},91340,e=>{"use strict";e.i(59216),e.i(40554),e.i(64635),e.i(48616),e.s([])},58903,e=>{"use strict";var s=e.i(43476);let t=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var a=e.i(25936);function r({children:e,permission:r,permissions:l,requireAll:i=!1,fallback:n=null,showLock:c=!1,lockMessage:d="You don't have permission to view this"}){let{can:o,canAny:m,canAll:x}=(0,a.usePermissions)();return(r?o(r):!l||(i?x(l):m(l)))?(0,s.jsx)(s.Fragment,{children:e}):c?(0,s.jsx)("div",{className:"flex items-center justify-center p-8 bg-slate-800/30 rounded-xl border border-slate-700/50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,s.jsx)(t,{className:"h-5 w-5 text-slate-500"})}),(0,s.jsx)("p",{className:"text-slate-400 text-sm",children:d})]})}):(0,s.jsx)(s.Fragment,{children:n})}function l({children:e,fallback:t}){let{isAdmin:r}=(0,a.usePermissions)();return r?(0,s.jsx)(s.Fragment,{children:e}):(0,s.jsx)(s.Fragment,{children:t})}e.s(["AdminOnly",()=>l,"PermissionGate",()=>r],58903)},89470,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(22016);e.i(36180);var l=e.i(98925),i=e.i(76009),n=e.i(77524),c=e.i(73146),d=e.i(25936),o=e.i(58903);function m({children:e,permission:t,type:a="cost",placeholder:r="â€¢â€¢â€¢â€¢â€¢",placeholderClassName:l=""}){let{can:i,canViewCosts:n,canViewFinancials:c,canViewRevenue:o}=(0,d.usePermissions)(),m=!1;if(t)m=i(t);else switch(a){case"cost":default:m=n;break;case"revenue":m=o;break;case"profit":case"margin":case"financial":m=c}return m?(0,s.jsx)(s.Fragment,{children:e}):(0,s.jsx)("span",{className:`text-slate-500 select-none ${l}`,title:"You don't have permission to view this",children:r})}function x({children:e,placeholder:t}){return(0,s.jsx)(m,{type:"cost",placeholder:t,children:e})}function h({children:e,placeholder:t}){return(0,s.jsx)(m,{type:"margin",placeholder:t,children:e})}var u=e.i(80809),b=e.i(29618),p=e.i(76525),f=e.i(44927),g=e.i(90300),j=e.i(63207);e.i(91340);var v=e.i(59216);e.i(61086);var N=e.i(27215),y=e.i(97815);function w({productId:e,images:a=[],onImagesChange:r,maxImages:c=10}){let{user:d}=(0,y.useAuth)(),{organization:o}=(0,n.useOrganization)(),{success:m,error:x}=(0,u.useToast)(),h=(0,t.useRef)(null),[b,f]=(0,t.useState)(!1),[g,j]=(0,t.useState)(0),[v,w]=(0,t.useState)(!1),k=async s=>{if(!s||0===s.length||!o?.id||!d)return;if(a.length+s.length>c)return void x(`Maximum ${c} images allowed`);f(!0),j(0);let t=[];try{for(let r=0;r<s.length;r++){let l=s[r];if(!l.type.startsWith("image/")){x(`${l.name} is not an image`);continue}if(l.size>5242880){x(`${l.name} is too large (max 5MB)`);continue}let n=Date.now(),c=l.name.replace(/[^a-zA-Z0-9.-]/g,"_"),m=`${n}_${c}`,h=`organizations/${o.id}/products/${e}/images/${m}`,u=(0,N.ref)(i.storage,h);await (0,N.uploadBytes)(u,l);let b=await (0,N.getDownloadURL)(u),p={id:`img_${n}_${r}`,url:b,thumbnailUrl:b,filename:m,size:l.size,isPrimary:0===a.length&&0===r,uploadedAt:new Date().toISOString(),uploadedBy:d.uid};t.push(p),j((r+1)/s.length*100)}if(t.length>0){let s=[...a,...t],n=(0,l.doc)(i.db,"organizations",o.id,"products",e);await (0,l.updateDoc)(n,{images:s,thumbnail:s.find(e=>e.isPrimary)?.thumbnailUrl||s[0]?.thumbnailUrl||null}),r?.(s),m(`${t.length} image${t.length>1?"s":""} uploaded`)}}catch(e){console.error("Upload error:",e),x("Failed to upload images")}finally{f(!1),j(0)}},C=async s=>{if(o?.id&&confirm("Delete this image?"))try{let t=`organizations/${o.id}/products/${e}/images/${s.filename}`,n=(0,N.ref)(i.storage,t);try{await (0,N.deleteObject)(n)}catch(e){console.warn("Could not delete from storage:",e)}let c=a.filter(e=>e.id!==s.id);s.isPrimary&&c.length>0&&(c[0].isPrimary=!0);let d=(0,l.doc)(i.db,"organizations",o.id,"products",e);await (0,l.updateDoc)(d,{images:c,thumbnail:c.find(e=>e.isPrimary)?.thumbnailUrl||null}),r?.(c),m("Image deleted")}catch(e){console.error("Delete error:",e),x("Failed to delete image")}},$=async s=>{if(o?.id&&!s.isPrimary)try{let t=a.map(e=>({...e,isPrimary:e.id===s.id})),n=(0,l.doc)(i.db,"organizations",o.id,"products",e);await (0,l.updateDoc)(n,{images:t,thumbnail:s.thumbnailUrl}),r?.(t),m("Primary image updated")}catch(e){console.error("Error setting primary:",e),x("Failed to update primary image")}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:`border-2 border-dashed rounded-xl p-6 text-center transition-colors ${v?"border-emerald-500 bg-emerald-500/10":"border-slate-700 hover:border-slate-600"} ${b?"opacity-50 pointer-events-none":""}`,onDrop:e=>{e.preventDefault(),w(!1),k(e.dataTransfer.files)},onDragOver:e=>{e.preventDefault(),w(!0)},onDragLeave:()=>w(!1),children:[b?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("i",{className:"fas fa-spinner fa-spin text-2xl text-emerald-400"}),(0,s.jsxs)("p",{className:"text-slate-400",children:["Uploading... ",Math.round(g),"%"]}),(0,s.jsx)("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden max-w-xs mx-auto",children:(0,s.jsx)("div",{className:"h-full bg-emerald-500 transition-all",style:{width:`${g}%`}})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"fas fa-cloud-upload-alt text-3xl text-slate-500 mb-3"}),(0,s.jsx)("p",{className:"text-white mb-1",children:"Drag and drop images here"}),(0,s.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"or"}),(0,s.jsxs)(p.Button,{variant:"secondary",size:"sm",onClick:()=>h.current?.click(),children:[(0,s.jsx)("i",{className:"fas fa-folder-open mr-2"}),"Browse Files"]}),(0,s.jsxs)("p",{className:"text-slate-500 text-xs mt-3",children:["JPG, PNG, WebP - Max 5MB - Up to ",c," images"]})]}),(0,s.jsx)("input",{ref:h,type:"file",accept:"image/*",multiple:!0,onChange:e=>k(e.target.files),className:"hidden"})]}),a.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:a.map(e=>(0,s.jsxs)("div",{className:`relative group rounded-lg overflow-hidden border-2 aspect-square ${e.isPrimary?"border-emerald-500":"border-slate-700"}`,children:[(0,s.jsx)("img",{src:e.thumbnailUrl||e.url,alt:"Product",className:"w-full h-full object-cover"}),e.isPrimary&&(0,s.jsx)("div",{className:"absolute top-2 left-2 px-2 py-0.5 bg-emerald-500 text-white text-xs rounded",children:"Primary"}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[!e.isPrimary&&(0,s.jsx)("button",{onClick:()=>$(e),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:"Set as primary",children:(0,s.jsx)("i",{className:"fas fa-star text-white"})}),(0,s.jsx)("button",{onClick:()=>window.open(e.url,"_blank"),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors",title:"View full size",children:(0,s.jsx)("i",{className:"fas fa-expand text-white"})}),(0,s.jsx)("button",{onClick:()=>C(e),className:"p-2 bg-red-500/50 hover:bg-red-500/70 rounded-lg transition-colors",title:"Delete",children:(0,s.jsx)("i",{className:"fas fa-trash text-white"})})]})]},e.id))}),0===a.length&&!b&&(0,s.jsx)("p",{className:"text-center text-slate-500 text-sm py-4",children:"No images uploaded yet"})]})}let k={USD:"$",CAD:"C$",EUR:"â‚¬",GBP:"Â£",MXN:"MX$",AUD:"A$"},C={CA:"ðŸ‡¨ðŸ‡¦",US:"ðŸ‡ºðŸ‡¸",CN:"ðŸ‡¨ðŸ‡³",MX:"ðŸ‡²ðŸ‡½",DE:"ðŸ‡©ðŸ‡ª",GB:"ðŸ‡¬ðŸ‡§"};function $(){let e=(0,a.useParams)(),m=(0,a.useRouter)(),N=e.id,{organization:y}=(0,n.useOrganization)(),{state:$,dispatch:P}=(0,c.useApp)(),{canViewCosts:S,canEditProducts:D}=(0,d.usePermissions)(),{success:U,error:B}=(0,u.useToast)(),A=(0,b.useConfirm)(),[F,z]=(0,t.useState)([]),[M,T]=(0,t.useState)("overview"),[I,O]=(0,t.useState)(!1),[E,_]=(0,t.useState)(!1),R=$.products.find(e=>e.id===N);(0,t.useEffect)(()=>{y?.id&&(async()=>{try{let e=(0,l.doc)(i.db,"organizations",y.id),s=await (0,l.getDoc)(e);s.exists()&&z(s.data().customPriceFields||[])}catch(e){console.error("Error loading custom price fields:",e)}})()},[y?.id]);let L=(0,t.useMemo)(()=>R?$.locations.map(e=>{let s=$.inventory.find(s=>s.productId===R.id&&s.locationId===e.id);return{locationId:e.id,locationName:e.name,locationType:e.type,quantity:s?.quantity||0}}):[],[R,$.locations,$.inventory]),G=L.reduce((e,s)=>e+s.quantity,0),q=!!R&&G<=R.reorderPoint,V=0===G,H=async()=>{!R||await A({title:"Delete Product",message:`Are you sure you want to delete "${R.name}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",destructive:!0})&&(P({type:"DELETE_PRODUCT",payload:R.id}),U(`Product "${R.name}" deleted successfully`),m.push("/inventory"))},W=(e,s)=>0===e?0:(e-s)/e*100;if(!R)return(0,s.jsx)("main",{className:"flex-1 overflow-auto flex items-center justify-center p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("i",{className:"fas fa-box-open text-2xl text-slate-500"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Product Not Found"}),(0,s.jsx)("p",{className:"text-slate-400 mb-4",children:"This product doesn't exist or was deleted."}),(0,s.jsx)(r.default,{href:"/inventory",children:(0,s.jsxs)(p.Button,{variant:"secondary",children:[(0,s.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back to Inventory"]})})]})});let K=V?{label:"Out of Stock",color:"red"}:q?{label:"Low Stock",color:"amber"}:{label:"In Stock",color:"emerald"};(0,v.getCategoryStyle)(R.category);let Q=R.cost?.rolling||0,X=R.prices?.msrp||0,Y=R.customPrices,J=(0,t.useMemo)(()=>Y?F.reduce((e,s)=>{let t=s.currency;e[t]||(e[t]=[]);let a=Y[s.key];return a&&e[t].push({field:s,value:a.value}),e},{}):{},[F,Y]),Z=[{channel:"MSRP",price:R.prices?.msrp||0,cogs:Q,margin:W(R.prices?.msrp||0,Q)},{channel:"Shopify",icon:"fab fa-shopify",iconColor:"text-green-400",price:R.prices?.shopify||0,cogs:Q,margin:W(R.prices?.shopify||0,Q)},{channel:"Amazon",icon:"fab fa-amazon",iconColor:"text-orange-400",price:R.prices?.amazon||0,cogs:Q,margin:W(R.prices?.amazon||0,Q)},{channel:"Wholesale",icon:"fas fa-store",iconColor:"text-blue-400",price:R.prices?.wholesale||0,cogs:Q,margin:W(R.prices?.wholesale||0,Q)},{channel:"Distributor",icon:"fas fa-truck",iconColor:"text-purple-400",price:R.prices?.distributor||0,cogs:Q,margin:W(R.prices?.distributor||0,Q)}];return(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("button",{onClick:()=>m.push("/inventory"),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors mt-1",children:(0,s.jsx)("i",{className:"fas fa-arrow-left"})}),(0,s.jsx)("div",{className:"w-20 h-20 bg-slate-800 rounded-xl flex items-center justify-center border border-slate-700",children:(0,s.jsx)(v.CategoryIcon,{category:R.category,size:"lg"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:R.name}),(0,s.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs bg-${K.color}-500/20 text-${K.color}-400`,children:K.label})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,s.jsxs)("span",{className:"text-slate-400",children:["SKU: ",(0,s.jsx)("span",{className:"text-white font-mono",children:R.sku})]}),R.barcode&&(0,s.jsxs)("span",{className:"text-slate-400",children:["UPC: ",(0,s.jsx)("span",{className:"text-white font-mono",children:R.barcode})]}),(0,s.jsxs)("span",{className:"text-slate-400",children:["Category: ",(0,s.jsx)("span",{className:"text-white capitalize",children:R.category?.replace("_"," ")})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.PermissionGate,{permission:"products.edit",children:(0,s.jsxs)(p.Button,{variant:"secondary",onClick:()=>O(!0),children:[(0,s.jsx)("i",{className:"fas fa-pencil mr-2"}),"Edit"]})}),(0,s.jsx)(o.PermissionGate,{permission:"products.delete",children:(0,s.jsxs)(p.Button,{variant:"ghost",onClick:H,children:[(0,s.jsx)("i",{className:"fas fa-trash mr-2 text-red-400"}),"Delete"]})})]})]}),(0,s.jsx)("div",{className:"border-b border-slate-700",children:(0,s.jsx)("div",{className:"flex gap-6",children:[{key:"overview",label:"Overview",icon:"fa-chart-line"},{key:"images",label:"Images",icon:"fa-images"},{key:"pricing",label:"Pricing",icon:"fa-tags"},{key:"supplier",label:"Supplier",icon:"fa-truck-loading"},{key:"inventory",label:"Inventory",icon:"fa-warehouse"},{key:"history",label:"History",icon:"fa-clock-rotate-left"}].map(e=>(0,s.jsxs)("button",{onClick:()=>T(e.key),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${M===e.key?"border-emerald-500 text-emerald-400":"border-transparent text-slate-400 hover:text-white"}`,children:[(0,s.jsx)("i",{className:`fas ${e.icon}`}),e.label]},e.key))})}),"overview"===M&&(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"col-span-2 space-y-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-3",children:"Description"}),(0,s.jsx)("p",{className:"text-slate-300",children:R.description||"No description provided."})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Physical Attributes"}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Weight"}),(0,s.jsx)("div",{className:"text-white font-medium",children:R.weight?`${R.weight.value} ${R.weight.unit||"oz"}`:"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Length"}),(0,s.jsx)("div",{className:"text-white font-medium",children:R.dimensions?.length?`${R.dimensions.length}"`:"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Width"}),(0,s.jsx)("div",{className:"text-white font-medium",children:R.dimensions?.width?`${R.dimensions.width}"`:"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Height"}),(0,s.jsx)("div",{className:"text-white font-medium",children:R.dimensions?.height?`${R.dimensions.height}"`:"-"})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Customs & Compliance"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"HS Code"}),(0,s.jsx)("div",{className:"text-white font-mono",children:R.hsCode||"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Country of Origin"}),(0,s.jsx)("div",{className:"text-white",children:R.countryOfOrigin?(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[C[R.countryOfOrigin]||""," ",R.countryOfOrigin]}):"-"})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Units of Measure"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Base Unit"}),(0,s.jsx)("div",{className:"text-white",children:R.uom||"Each"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Purchase Unit"}),(0,s.jsx)("div",{className:"text-white",children:R.purchasingUom||"Case"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Units per Case"}),(0,s.jsx)("div",{className:"text-white",children:R.casePackQty||"-"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:`bg-slate-800/50 border rounded-xl p-5 ${q?"border-amber-500/30":"border-slate-700"}`,children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Stock Summary"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Total Stock"}),(0,s.jsx)("span",{className:`font-semibold ${V?"text-red-400":q?"text-amber-400":"text-white"}`,children:(0,j.formatNumber)(G)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Reorder Point"}),(0,s.jsx)("span",{className:"text-white",children:(0,j.formatNumber)(R.reorderPoint)})]})]}),(0,s.jsx)("button",{onClick:()=>T("inventory"),className:"w-full mt-4 text-sm text-emerald-400 hover:text-emerald-300",children:"View inventory details â†’"})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Pricing"}),(0,s.jsxs)("div",{className:"space-y-3",children:[S&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Cost"}),(0,s.jsx)(x,{children:(0,s.jsx)("span",{className:"text-white font-semibold",children:(0,j.formatCurrency)(Q)})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Retail (MSRP)"}),(0,s.jsx)("span",{className:"text-white font-semibold",children:(0,j.formatCurrency)(X)})]}),S&&Q>0&&X>0&&(0,s.jsxs)("div",{className:"flex justify-between pt-2 border-t border-slate-700",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Margin"}),(0,s.jsx)(h,{children:(0,s.jsxs)("span",{className:"text-emerald-400 font-semibold",children:[W(X,Q).toFixed(1),"%"]})})]})]}),(0,s.jsx)("button",{onClick:()=>T("pricing"),className:"w-full mt-4 text-sm text-emerald-400 hover:text-emerald-300",children:"View all prices â†’"})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Identifiers"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"SKU"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-white font-mono bg-slate-900/50 px-3 py-2 rounded-lg flex-1",children:R.sku}),(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(R.sku),U("SKU copied to clipboard")},className:"p-2 text-slate-400 hover:text-white",children:(0,s.jsx)("i",{className:"fas fa-copy"})})]})]}),R.barcode&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Barcode / UPC"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-white font-mono bg-slate-900/50 px-3 py-2 rounded-lg flex-1",children:R.barcode}),(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(R.barcode||""),U("Barcode copied to clipboard")},className:"p-2 text-slate-400 hover:text-white",children:(0,s.jsx)("i",{className:"fas fa-copy"})})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Quick Actions"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.PermissionGate,{permission:"inventory.adjust_stock",children:(0,s.jsxs)("button",{onClick:()=>_(!0),className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg text-sm flex items-center gap-2 transition-colors",children:[(0,s.jsx)("i",{className:"fas fa-plus-minus w-5 text-center"}),"Adjust Stock"]})}),(0,s.jsxs)("button",{className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg text-sm flex items-center gap-2 transition-colors",children:[(0,s.jsx)("i",{className:"fas fa-file-invoice w-5 text-center"}),"Create Purchase Order"]}),(0,s.jsxs)("button",{className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-slate-300 rounded-lg text-sm flex items-center gap-2 transition-colors",children:[(0,s.jsx)("i",{className:"fas fa-exchange-alt w-5 text-center"}),"Transfer Stock"]})]})]})]})]}),"images"===M&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:"Product Images"}),(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Upload images for pick lists, packing slips, and product identification"})]}),(0,s.jsxs)("span",{className:"text-sm text-slate-500",children:[R.images?.length||0," / 10 images"]})]}),(0,s.jsx)(w,{productId:R.id,images:R.images||[],onImagesChange:()=>{}})]}),(0,s.jsx)("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("i",{className:"fas fa-info-circle text-blue-400 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"text-blue-300 font-medium",children:"Where images are used"}),(0,s.jsxs)("ul",{className:"text-slate-400 mt-2 space-y-1",children:[(0,s.jsxs)("li",{children:["- ",(0,s.jsx)("strong",{className:"text-slate-300",children:"Pick Lists"})," - Help warehouse staff identify products"]}),(0,s.jsxs)("li",{children:["- ",(0,s.jsx)("strong",{className:"text-slate-300",children:"Packing Slips"})," - Show customers what's in their order"]}),(0,s.jsxs)("li",{children:["- ",(0,s.jsx)("strong",{className:"text-slate-300",children:"Product Catalog"})," - Display in inventory listings"]})]})]})]})})]}),"pricing"===M&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Standard Channel Pricing"}),(0,s.jsx)("div",{className:"space-y-3",children:Z.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50 last:border-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon&&(0,s.jsx)("i",{className:`${e.icon} ${e.iconColor}`}),(0,s.jsx)("span",{className:e.icon?"text-white":"text-slate-400",children:e.channel})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:"text-white font-medium",children:(0,j.formatCurrency)(e.price)}),S&&e.price>0&&(0,s.jsx)(h,{children:(0,s.jsxs)("span",{className:`text-xs px-2 py-0.5 rounded-full ${e.margin>=50?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"}`,children:[e.margin.toFixed(1),"%"]})})]})]},t))}),S&&(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Cost (COGS)"}),(0,s.jsx)(x,{children:(0,s.jsx)("span",{className:"text-white font-semibold",children:(0,j.formatCurrency)(Q)})})]})})]}),Object.entries(J).length>0?Object.entries(J).map(([e,t])=>(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-lg text-emerald-400",children:k[e]||"$"}),e," Custom Pricing"]}),(0,s.jsx)("div",{className:"space-y-3",children:t.map(({field:t,value:a})=>(0,s.jsxs)("div",{className:"flex justify-between py-2 border-b border-slate-700/50 last:border-0",children:[(0,s.jsx)("span",{className:"text-slate-400",children:t.name}),(0,s.jsxs)("span",{className:"text-white font-medium",children:[k[e],a.toFixed(2)]})]},t.key))})]},e)):(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Custom Pricing"}),(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,s.jsx)("i",{className:"fas fa-tags text-slate-500"})}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mb-3",children:"No custom prices set for this product."}),(0,s.jsx)(r.default,{href:"/settings/products",className:"text-emerald-400 text-sm hover:text-emerald-300",children:"Configure price fields â†’"})]})]})]}),"supplier"===M&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Supplier Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Supplier / Vendor"}),(0,s.jsx)("div",{className:"text-white font-medium text-lg",children:R.supplier||"No supplier assigned"})]}),R.supplierSku&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Vendor Product Code"}),(0,s.jsx)("div",{className:"text-white font-mono",children:R.supplierSku})]}),S&&R.supplierPrice&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Vendor Price"}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"text-white font-medium",children:(0,j.formatCurrency)(R.supplierPrice)})})]})]})]}),(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Purchasing Details"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Purchase Unit"}),(0,s.jsx)("div",{className:"text-white",children:R.purchasingUom||"Case"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Units per Case"}),(0,s.jsx)("div",{className:"text-white font-medium",children:R.casePackQty||"-"})]}),S&&R.casePackQty&&Q>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Cost per Case"}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"text-white font-medium",children:(0,j.formatCurrency)(Q*R.casePackQty)})})]})]})]})]}),"inventory"===M&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-5 py-4 border-b border-slate-700 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-white font-semibold",children:"Stock by Location"}),(0,s.jsx)(o.PermissionGate,{permission:"inventory.adjust_stock",children:(0,s.jsxs)(p.Button,{variant:"secondary",size:"sm",onClick:()=>_(!0),children:[(0,s.jsx)("i",{className:"fas fa-plus-minus mr-2"}),"Adjust Stock"]})})]}),(0,s.jsxs)("div",{className:"p-5 space-y-3",children:[L.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 border border-slate-700 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-slate-700/50 flex items-center justify-center",children:(0,s.jsx)("i",{className:`fas ${"fba"===e.locationType?"fa-amazon":"fa-warehouse"} text-slate-400`})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-white",children:e.locationName}),(0,s.jsx)("div",{className:"text-xs text-slate-500 capitalize",children:e.locationType})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:`text-xl font-bold ${e.quantity>0?"text-white":"text-slate-500"}`,children:(0,j.formatNumber)(e.quantity)}),(0,s.jsx)("div",{className:"text-xs text-slate-400",children:"units"})]})]},e.locationId)),(0,s.jsxs)("div",{className:"pt-4 mt-4 border-t border-slate-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Total Available"}),(0,s.jsx)("span",{className:`text-2xl font-bold ${V?"text-red-400":q?"text-amber-400":"text-white"}`,children:(0,j.formatNumber)(G)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Reorder Point"}),(0,s.jsxs)("span",{className:"text-white",children:[(0,j.formatNumber)(R.reorderPoint)," units"]})]}),q&&!V&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-amber-400 text-sm",children:[(0,s.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,s.jsx)("span",{children:"Stock is below reorder point"})]})})]})]})]}),S&&(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Inventory Value"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"At Cost"}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"text-xl font-bold text-white",children:(0,j.formatCurrency)(G*Q)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"At Retail (MSRP)"}),(0,s.jsx)("div",{className:"text-xl font-bold text-white",children:(0,j.formatCurrency)(G*X)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 mb-1",children:"Potential Profit"}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{className:"text-xl font-bold text-emerald-400",children:(0,j.formatCurrency)(G*(X-Q))})})]})]})]})]}),"history"===M&&(0,s.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-5",children:[(0,s.jsx)("h3",{className:"text-white font-semibold mb-4",children:"Activity History"}),(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,s.jsx)("i",{className:"fas fa-clock-rotate-left text-slate-500"})}),(0,s.jsx)("p",{className:"text-slate-400 mb-2",children:"Stock movements and changes will be shown here."}),(0,s.jsx)("p",{className:"text-slate-500 text-sm",children:"Coming soon"})]})]}),(0,s.jsx)(f.AddProductModal,{isOpen:I,onClose:()=>O(!1),editProduct:R}),(0,s.jsx)(g.AdjustStockModal,{isOpen:E,onClose:()=>_(!1),product:R})]})}e.s(["default",()=>$],89470)}]);